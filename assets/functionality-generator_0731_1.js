!function(){"use strict";function t(t,e="success",n=!1){const o=document.createElement("div");o.textContent=t,o.style.cssText=`\n        position: fixed;\n        ${n?"top: 50%; left: 50%; transform: translate(-50%, -50%);":"bottom: 20px; right: 20px;"}\n        background: ${"error"===e?"#D9534F":"warning"===e?"rgb(87, 102, 92)":"#333"};\n        color: white;\n        padding: 15px 20px;\n        border-radius: 5px;\n        font-size: 16px;\n        font-weight: bold;\n        text-align: center;\n        z-index: 9999;\n        opacity: 1;\n        transition: opacity 0.5s ease-in-out;\n    `,document.body.appendChild(o),setTimeout((()=>{o.style.opacity="0",setTimeout((()=>o.remove()),500)}),2e3)}class e extends HTMLElement{constructor(){super(),this.sectionId=this.getAttribute("section_id"),this.productGroup=this.getAttribute("product_group"),this.registryKey=`${this.sectionId}__${this.productGroup}`}initPricingConfig(t){t?this.pricingConfig=t:console.error("WWAI-ERROR ‚ùå Pricing Config is missing or invalid.")}initFlowConfig(e){if(!e||!e.destination)return console.error("WWAI-ERROR ‚ùå Flow Config is missing or invalid."),void t("‚ö†Ô∏è Error: Flow Config is not set!","error",!0);this.flowConfig=e}initUXConfig(t){t?this.uxConfig=t:console.error("WWAI-ERROR ‚ùå UI Config is missing or invalid.")}}const n={PRODUCT_GROUP:{ADD_TO_CART:"product-custom-add-to-cart-button-selector",CAROUSEL:"product-custom-carousel-media-selector",COLLECTION_OPTIONS_OVERLAY:"product-custom-collection-options-overlay-selector",PRICE:"product-custom-price-selector",SUBMIT_INTERCEPTOR:"product-custom-submit-interceptor",TITLE:"product-custom-title-selector",GRID_SMART_INTERACTION:"product-grid-smart-interaction-button-selector",PRODUCT_MEDIA_GALLERY_FOR_GRIDS:"product-media-gallery-for-grids",PURCHASE_TYPE:"product-purchase-type-selector",SUBSCRIPTION_FREQUENCY:"product-subscription-frequency-selector",VARIANT_CUSTOM_LABEL:"product-variant-custom-labeled-text-selector",VARIANT:"product-variant-selector",VARIANT_TRIGGER:"product-variant-trigger",VARIANT_PURCHASE_TYPE_COMBO:"product-variant-purchase-type-combo-selector",VARIANT_SELECTOR_WITH_SETS:"product-variant-selector-with-sets",SUBSCRIPTION_FREQUENCY_STATIC:"product-static-subscription-frequency-selector",PRICE_STATIC:"product-static-price-selector"},OTHER:{PRODUCT_GRID_HEIGHT_EQUALIZER:"product-grid-height-equalizer-selector"}},o=[{name:"id",label:"Variant ID"},{name:"selling_plan",label:"Selling Plan"},{name:"quantity",label:"Quantity"},{name:"bundle_payload",label:"Bundle Payload"}],i={ADD_TO_CART_TEXT:"data-wwai-add-to-cart-text",SOLD_OUT_TEXT:"data-wwai-sold-out-text"};class r extends e{constructor(){super(),this.button=null,this.addToCartText=null,this.soldOutText=null,this.variantIdInput=null,this.sellingPlanInput=null,this.quantityInput=null,this.bundleInput=null}connectedCallback(){this.form=this.querySelector("form"),this.form?(o.forEach((({name:t})=>{let e=this.form.querySelector(`input[name="${t}"]`);e||(e=document.createElement("input"),e.type="hidden",e.name=t,e.value="quantity"===t?"1":"",this.form.appendChild(e)),"id"===t&&(this.variantIdInput=e),"selling_plan"===t&&(this.sellingPlanInput=e),"quantity"===t&&(this.quantityInput=e),"bundle_payload"===t&&(this.bundleInput=e)})),this.button=this.form.querySelector('button[type="submit"]')||null,this.addToCartText=this.button?.querySelector(`[${i.ADD_TO_CART_TEXT}]`)||null,this.soldOutText=this.button?.querySelector(`[${i.SOLD_OUT_TEXT}]`)||null,this.button||console.error("WWAI-ERROR ‚ùå No submit button found inside the form.")):console.error("WWAI-ERROR ‚ùå No form found inside <product-custom-add-to-cart-button>")}updateAddToCartForm(t){t?(t.variantId&&this.variantIdInput&&(this.variantIdInput.value=t.variantId,this.variantIdInput.dataset.title=t.variantName),t.sellingPlanId&&this.sellingPlanInput?(this.sellingPlanInput.value=t.sellingPlanId,this.sellingPlanInput.dataset.option_name=t.sellingPlanName):(this.sellingPlanInput.value="",this.sellingPlanInput.dataset.option_name=""),void 0!==t.available&&(this.button.disabled=!t.available,this.button.style.opacity=t.available?"1":"0.5",this.addToCartText&&this.soldOutText&&(this.addToCartText.style.display=t.available?"":"none",this.soldOutText.style.display=t.available?"none":""))):console.error("WWAI-ERROR ‚ùå No payload provided to updateAddToCartForm")}updateAddToCartFormWithBundlePayload(t){t.add_to_cart_payload&&this.bundleInput&&(this.bundleInput.value=JSON.stringify(t.add_to_cart_payload),this.bundleInput.dataset.title=t.title)}updateSellingPlan(t,e=""){this.sellingPlanInput?(console.log(`üîÑ Updating Selling Plan: ${t} (${e})`),this.sellingPlanInput.value=t,this.sellingPlanInput.dataset.option_name=e):console.warn("‚ö†Ô∏è Selling Plan input not found. Update aborted.")}}customElements.define(n.PRODUCT_GROUP.ADD_TO_CART,r);const s="carousel-slider",a=["clearSlides","createCustomCarouselSlide","gotoSlide"];class l extends e{constructor(){super(),this.currentMedia=null,this.carouselElement=null,this.use_custom_uploaded_images="true"===this.getAttribute("data-wwai-use-custom-uploaded-images")}connectedCallback(){this.carouselElement=this.querySelector(s),this.carouselElement||console.error(`WWAI-ERROR ‚ùå Missing <${s}> inside <product-custom-carousel-media-selector>.`)}updateCarouselMedia(t,e=0){if(this.use_custom_uploaded_images)return void this.carouselElement.gotoSlide(e);if(!Array.isArray(t)||0===t.length)return void console.warn("‚ö†Ô∏è No media provided to update the carousel.");if(this.isSameMedia(t))return console.log("üîÑ Media is unchanged, skipping update."),void this.carouselElement.gotoSlide(e);this.currentMedia=t,this.carouselElement.clearSlides();const n=this.carouselElement.querySelector("main-slider"),o=this.carouselElement.querySelector("thumb-slider");t.forEach(((t,e)=>{if("image"===t.media_type){if(n){const e=this.carouselElement.createCustomCarouselSlide(t,!1);n.appendChild(e)}if(o){const e=this.carouselElement.createCustomCarouselSlide(t,!0);o.appendChild(e)}}})),this.carouselElement.refresh(e),this.carouselElement.gotoSlide(e)}isSameMedia(t){return!!this.currentMedia&&(this.currentMedia.length===t.length&&this.currentMedia.every(((e,n)=>e.id===t[n].id)))}}customElements.define(n.PRODUCT_GROUP.CAROUSEL,l);const c="data-wwai-product-price-label",d={BEFORE:"data-wwai-product-before-price",AFTER:"data-wwai-product-after-price",DISCOUNT:"data-wwai-discount-percentage",SAVINGS:"data-wwai-discount-savings"},u="data-wwai-price-before-wrapper",p="data-wwai-price-after-wrapper",g="data-wwai-discount-percentage-wrapper",f="data-wwai-discount-savings-wrapper";class h extends e{connectedCallback(){this.pricingConfig=null,this.availableLabels=new Set,this.querySelectorAll("[data-wwai-product-price-label]").forEach((t=>{this.availableLabels.add(t.getAttribute("data-wwai-product-price-label"))}))}findWrapper(t,e,n=3){let o=t.parentElement;for(let t=0;t<n&&o;t++){if(o.hasAttribute(e))return o;o=o.parentElement}return null}updatePrices({price:t,compareAtPrice:e,discount_percent:n,savings:o=null},i){let r=!0,s=!0;this.pricingConfig&&null!=this.pricingConfig.roundDiscount&&(r=this.pricingConfig.roundDiscount),this.pricingConfig&&null!=this.pricingConfig.addOffSuffixToDiscount&&(s=this.pricingConfig.addOffSuffixToDiscount);const a=this.querySelectorAll(`[${c}="${i}"]`);if(!a.length)return void console.error(`WWAI-ERROR ‚ùå No elements found with ${c}="${i}" inside <product-custom-price-selector> (section: ${this.sectionId}, group: ${this.productGroup}).\nFound labels: ${Array.from(this.availableLabels).join(", ")}`);const l=t!=e,p=Number(n);a.forEach((i=>{i.hasAttribute(d.BEFORE)&&(i.textContent=l?e:"",i.setAttribute("data-wwai-slash-pricing-before-tag",l?"true":"false")),i.hasAttribute(d.AFTER)&&(i.textContent=t,i.setAttribute("data-wwai-slash-pricing-after-tag",l?"true":"false"));const a=this.findWrapper(i,u);a&&(a.style.display=l?"":"none");const c=this.findWrapper(i,g);if(c&&(c.style.display=l?"":"none"),o){i.hasAttribute(d.SAVINGS)&&(i.textContent=o);const t=this.findWrapper(i,f);t&&(t.style.display=l?"":"none")}if(i.hasAttribute(d.DISCOUNT)){if(isNaN(p))return void console.error("WWAI-ERROR ‚ùå Invalid discount_percent received:",n);let t=`${r?Math.round(p):p}%${s?" OFF":""}`;const e=i.textContent.trim();l?e.includes("(")?i.textContent=e.replace(/\(\d+(\.\d+)?%\)/,`(${t})`):i.textContent=t:i.textContent=""}}))}}function b(t,e){!function(){if(document.getElementById("wwai-overlay-styles"))return;const t=document.createElement("style");t.id="wwai-overlay-styles",t.innerText="\n    /* White overlay */\n    .overlay-spinner {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background-color: rgba(255, 255, 255, 0.7);\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      z-index: 10;\n    }\n\n    /* Positioning wrapper */\n    product-media-gallery-for-grids {\n      position: relative;\n    }\n  \n    @keyframes spin {\n      to {\n        transform: rotate(360deg);\n      }\n    }\n  ",document.head.appendChild(t)}();const n=document.querySelector(`product-media-gallery-for-grids[section_id="${t}"][product_group="${e}"]`);if(!n)return void console.error("WWAI-ERROR ‚ùå product-media-gallery-for-grids not found for",t,e);if(n.querySelector(`.overlay-spinner[data-overlay-id="${t}__${e}"]`))return;const o=document.createElement("div");o.className="overlay-spinner",o.setAttribute("data-overlay-id",`${t}__${e}`),o.innerHTML='\n    <div style="\n      width: 40px;\n      height: 40px;\n      border: 4px solid rgba(0, 0, 0, 0.1);\n      border-top-color: #333;\n      border-radius: 50%;\n      animation: spin 0.8s linear infinite;\n      display: block;\n    "></div>\n  ',n.appendChild(o)}function m(t,e,n){switch(n){case"none":break;case"media-gallery":b(t,e);break;case"add-to-cart-submit-button":!function(t,e){const n=document.querySelectorAll(`product-custom-submit-interceptor[section_id="${t}"][product_group="${e}"]`);n&&0!==n.length?(n.forEach((t=>{t.submitButton?.classList.add("loading")})),console.log(`‚úÖ Loading state added to ${n.length} submit interceptors for [${t} / ${e}]`)):console.error("WWAI-ERROR ‚ùå product-custom-submit-interceptor not found for",t,e)}(t,e);break;default:console.warn(`‚ö†Ô∏è Unknown overlay_type "${n}" passed to addLoadingOverlay`)}}function w(t,e,n,o=!1){switch(n){case"none":break;case"media-gallery":!function(t,e,n=!1){const o=document.querySelector(`.overlay-spinner[data-overlay-id="${t}__${e}"]`);o?(o.remove(),console.log(`‚úÖ Overlay removed for ${t} / ${e}`)):n||console.warn(`‚ö†Ô∏è No overlay found for ${t} / ${e}`)}(t,e,o);break;case"add-to-cart-submit-button":!function(t,e,n=!1){const o=document.querySelectorAll(`product-custom-submit-interceptor[section_id="${t}"][product_group="${e}"]`);o&&0!==o.length?(o.forEach((t=>{t.submitButton?.classList.remove("loading")})),console.log(`‚úÖ Loading state removed from ${o.length} submit interceptors for [${t} / ${e}]`)):n||console.error("WWAI-ERROR ‚ùå product-custom-submit-interceptor not found for",t,e)}(t,e,o);break;default:console.warn(`‚ö†Ô∏è Unknown overlay_type "${n}" passed to removeLoadingOverlay`)}}function _(){const t=document.querySelectorAll("product-variant-selector"),e=new Set;t.forEach((t=>{const n=t.getAttribute("section_id"),o=t.getAttribute("product_group"),i=`${n}::${o}`;e.has(i)||(e.add(i),w(n,o,"media-gallery",!0),w(n,o,"add-to-cart-submit-button",!0))}))}function y(t,e=400,n={}){!function({backgroundColor:t="#E8DDFA",textColor:e="#000000",borderColor:n="transparent",fontFamily:o="sans-serif"}={}){if(document.getElementById("wwai-notification-styles"))return;const i=`\n      .wwai-temporary-notification {\n        position: fixed;\n        bottom: 20px;\n        right: 20px;\n        background-color: ${t};\n        color: ${e};\n        border: 1px solid ${n};\n        font-family: ${o};\n        padding: 10px 20px;\n        border-radius: 5px;\n        font-size: 14px;\n        z-index: 10000;\n        opacity: 0.95;\n        transition: opacity 0.3s ease-in-out;\n        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.15);\n        max-width: 300px;\n      }\n  \n      .wwai-temporary-notification.fade-out {\n        opacity: 0;\n      }\n    `,r=document.createElement("style");r.type="text/css",r.id="wwai-notification-styles",r.innerText=i,document.head.appendChild(r)}(n);const o=document.createElement("div");o.className="wwai-temporary-notification",o.innerText=t,document.body.appendChild(o),setTimeout((()=>{o.classList.add("fade-out"),setTimeout((()=>{o.remove()}),500)}),e)}async function v(e,n,o,i){if(o){return void t((t=>`üõí Product added to cart (mock mode) ‚Äî ${t} redirect enabled.\n\n${i||""}`)("side-cart"),"success",!0)}let r=!1;switch(e){case"littlewords":r=function(){const t=document.querySelector("cart-drawer");return!(!t||"function"!=typeof t.show||(window.isCartRefreshed=!0,document.documentElement.dispatchEvent(new CustomEvent("cart:refresh",{bubbles:!0})),t.show(),0))}();break;case"rco":r=!!window.VueMinicart?.$store&&(window.VueMinicart.$store.dispatch("refreshCart"),window.VueMinicart.$store.commit("toggleCart",!0),document.body.classList.add("noscroll"),!0);break;case"nwkw":r=await(s=n,fetch("/?sections=cart-drawer,cart-icon-bubble").then((t=>{if(!t.ok)throw new Error("Failed to fetch cart sections");return t.json()})).then((t=>{const e=document.querySelector("cart-drawer");if(!e||"function"!=typeof e.renderContents)return!1;e.renderContents({sections:t});const n=e.querySelector("#CartDrawer-CartItems");return n&&n.innerHTML.trim()&&e.classList.remove("is-empty"),setTimeout((()=>{e.classList.contains("active")||e.classList.add("active")}),100),publish(PUB_SUB_EVENTS.cartUpdate,{source:"product-form",productVariantId:`virtual-${Math.random().toString(36).slice(2,10)}`,cartData:s}),!0})).catch((t=>(console.error("WWAI-ERROR [SideCart] Failed to open drawer:",t),!1))));break;case"kitsch":r=await(window.dispatchEvent(new Event("toggle-cart-drawer")),window.dispatchEvent(new Event("update-cart")),console.log("‚úÖ Cart drawer refreshed and opened."),!0);break;case"puracy":r=await async function(){try{const t=document.querySelector("cart-drawer");if(!t)return!1;t&&!t.open&&(t.open=!0,t.classList.add("active"));const e=window.themeVariables?.routes?.cartUrl||"/cart",n="drawer"===window.themeVariables?.settings?.cartType,[o,i]=await Promise.all([fetch(`${e}.js`).then((t=>t.json())),fetch(`${e}?sections=mini-cart`).then((t=>t.json()))]),r={...o,sections:i};document.documentElement.dispatchEvent(new CustomEvent("cart:updated",{bubbles:!0,detail:{cart:r}}));const s=n&&!document.querySelector(".drawer");return document.documentElement.dispatchEvent(new CustomEvent("cart:refresh",{bubbles:!0,detail:{cart:r,openMiniCart:s}})),!0}catch(t){return console.error("‚ùå Failed to refresh cart:",t),!1}}();break;case"drmtlgy":r=await async function(){return window.dispatchEvent(new CustomEvent("cart-updated")),window.dispatchEvent(new CustomEvent("toggle-cart",{detail:{open:!0}})),!0}();break;default:console.warn(`[SideCart] Unknown or missing brandName: "${e}". Redirecting to /cart.`)}var s;if(!r){if("rco"==e)return;window.location.href="/cart"}}function C(t={}){const e=[],n={loader:t.loader??"none",showSuccessNotification:t.showSuccessNotification??!0,showErrorNotification:t.showErrorNotification??!0,successNotificationMessage:t.successNotificationMessage??"üéâ Item(s) added to cart!",errorNotificationMessage:t.errorNotificationMessage??"‚ùå Something went wrong.",destination:t.destination??"cart",sideCartLabel:t.sideCartLabel??null,notificationOptions:t.notificationOptions??{},clearCartBeforeAddingItems:t.clearCartBeforeAddingItems??!1,additionalItemsToAdd:t.additionalItemsToAdd??[]};return null==t.loader||["media-gallery","add-to-cart-submit-button","none"].includes(t.loader)||e.push(`Invalid loader value: "${t.loader}"`),null!=t.showSuccessNotification&&"boolean"!=typeof t.showSuccessNotification&&e.push("showSuccessNotification must be a boolean"),null!=t.showErrorNotification&&"boolean"!=typeof t.showErrorNotification&&e.push("showErrorNotification must be a boolean"),null==t.destination||["cart","checkout","side-cart"].includes(t.destination)||e.push(`Invalid destination value: "${t.destination}"`),"side-cart"===n.destination&&"string"!=typeof n.sideCartLabel&&e.push('sideCartLabel must be defined as a string when destination is "side-cart"'),{isValid:0===e.length,errors:e,config:n}}function A(t,e){const n=document.querySelector(`product-custom-collection-options-overlay-selector[section_id="${t}"][product_group="${e}"]`);n&&n.closeOverlay()}async function O(e,n,o,i,r=!1,s=null){const{debugString:a,cleanedItems:l}=function(t){let e=`üõí Total Items to Add: ${t.length}\n`;const n=t.map(((t,n)=>{const o=t._debug||{};e+=`‚Ä¢ ${o.readableString||`Item ${n+1}`} - Variant ID: ${o.variantId||"N/A"} - Qty: ${o.quantity||"N/A"} - Selling Plan: ${o.sellingPlan||"None"}\n`;const{_debug:i,...r}=t;return r}));return{debugString:e,cleanedItems:n}}(e);console.log("üîç Cart add debug string:",a);const c=performance.now();let d=c;const{isValid:u,errors:p,config:g}=C(n);if(!u)return void console.error("WWAI-ERROR ‚ùå Invalid flowConfig:",p);console.log(`‚è±Ô∏è Step 1 - Config validation: ${(performance.now()-d).toFixed(2)}ms`),d=performance.now();const{loader:f,showSuccessNotification:h,showErrorNotification:b,successNotificationMessage:_,errorNotificationMessage:O,destination:I,sideCartLabel:E,notificationOptions:R,clearCartBeforeAddingItems:T,additionalItemsToAdd:S}=g;m(o,i,f),console.log(`‚è±Ô∏è Step 2 - Loading overlay: ${(performance.now()-d).toFixed(2)}ms`),d=performance.now();try{let e=null;if(r){const t=performance.now();await new Promise((t=>setTimeout(t,600))),console.log(`‚è±Ô∏è Step 3c - Mock delay: ${(performance.now()-t).toFixed(2)}ms`)}else{if("checkout"===I&&T){const t=performance.now();await async function(){try{const t=await fetch("/cart/clear.js",{method:"POST",headers:{"Content-Type":"application/json"}});if(!t.ok){const e=await t.json();return void console.error("WWAI-ERROR ‚ùå Failed to clear cart:",e)}console.log("üßπ Cart cleared successfully")}catch(t){console.error("WWAI-ERROR ‚ùå Error while clearing cart:",t)}}(),console.log(`‚è±Ô∏è Step 3a - Clear cart: ${(performance.now()-t).toFixed(2)}ms`)}const t=performance.now();e=await function(t,e){const n=performance.now();console.log("üõí Starting addItemsToCart operation...");const o=[...e,...t],i=performance.now();console.log(`‚è±Ô∏è Step 1 - Prepare items array: ${(i-n).toFixed(2)}ms`);const r=performance.now();return fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:o})}).then((t=>{const e=performance.now();if(console.log(`‚è±Ô∏è Step 2 - Network request: ${(e-r).toFixed(2)}ms`),!t.ok)throw new Error("Add to cart failed");const o=performance.now();return t.json().then((t=>{const e=performance.now();return console.log(`‚è±Ô∏è Step 3 - Parse response: ${(e-o).toFixed(2)}ms`),console.log(`‚è±Ô∏è Total addItemsToCart time: ${(e-n).toFixed(2)}ms`),t}))}))}(l,S),console.log(`‚è±Ô∏è Step 3b - Add items to cart: ${(performance.now()-t).toFixed(2)}ms`)}console.log(`‚è±Ô∏è Step 3 - Cart operation total: ${(performance.now()-d).toFixed(2)}ms`),d=performance.now();const n=performance.now();!function(t,e,n={}){t&&y(e,2e3,n)}(h,_,R),console.log(`‚è±Ô∏è Step 4 - Success notification: ${(performance.now()-n).toFixed(2)}ms`),d=performance.now();const o=performance.now();await async function(e,n,o,i,r){const s=t=>`üõí Product added to cart (mock mode) ‚Äî ${t} redirect enabled.\n\n${r||""}`;"checkout"===e?o?t(s("checkout"),"success",!0):window.location.href="/checkout":"cart"===e?o?t(s("cart"),"success",!0):window.location.href="/cart":"side-cart"===e?await v(n,i,o,r):console.warn(`‚ö†Ô∏è Unknown destination "${e}"`)}(I,E,r,e,a),console.log(`‚è±Ô∏è Step 5 - Post-add journey: ${(performance.now()-o).toFixed(2)}ms`),d=performance.now()}catch(t){console.error("WWAI-ERROR ‚ùå Failed to add to cart:",t),function(t,e,n={}){t&&y(e,2e3,n)}(b,O||t.message,R)}finally{const t=performance.now();w(o,i,f),A(o,i),"function"==typeof s&&s("addedToCart"),console.log(`‚è±Ô∏è Step 6 - Cleanup: ${(performance.now()-t).toFixed(2)}ms`),console.log(`‚è±Ô∏è Total add to cart time: ${(performance.now()-c).toFixed(2)}ms`)}}function I(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function E(){return window.__WWAI__||{}}customElements.define(n.PRODUCT_GROUP.PRICE,h);class R extends e{constructor(){super(),this.formElement=null,this.submitButton=null,this.variantInput=null,this.sellingPlanInput=null,this.quantityInput=null,this.deployMode=null,this.flowConfig=null,this.handlers={}}connectedCallback(){const t=E().deployMode;this.deployMode=t,this.formElement=this.querySelector("form"),this.submitButton=this.formElement?.querySelector('button[type="submit"]'),this.variantInput=this.formElement?.querySelector('input[name="id"]'),this.sellingPlanInput=this.formElement?.querySelector('input[name="selling_plan"]'),this.bundleInput=this.formElement?.querySelector('input[name="bundle_payload"]'),this.quantityInput=this.formElement?.querySelector('input[name="quantity"]'),this.formElement&&this.submitButton?this.formElement.addEventListener("submit",(t=>this.handleSubmit(t))):console.error("WWAI-ERROR ‚ùå Missing form or submit button inside <product-custom-submit-interceptor>")}registerHandler(t,e){console.log("registerHandler with type: ",t),this.handlers[t]||(this.handlers[t]=[]),this.handlers[t].push(e)}triggerHandler(t){this.handlers&&this.handlers[t]&&(this.handlers[t]||[]).forEach((t=>t()))}itemsToAdd(){const t=this.variantInput?.value,e=Number(this.quantityInput?.value)||1,n=this.sellingPlanInput?.value||null,o=this.bundleInput?.value||null,i=this.variantInput?.dataset.title||"Unknown Product",r=this.sellingPlanInput?.dataset.option_name||"One-time purchase",s=this.quantityInput?.value||"1";if(o){return JSON.parse(o).map((t=>({...t,_debug:{source:"bundle",variantId:t.id,quantity:t.quantity,sellingPlan:t.selling_plan||null,bundlePayload:!0,readableString:null}})))}if(!t)return console.error("WWAI-ERROR ‚ùå No variant selected. Cannot proceed."),[];const a={id:t,quantity:e};return n&&(a.selling_plan=n),a._debug={source:"single",variantId:t,quantity:e,sellingPlan:n,bundlePayload:!1,readableString:`${i} - ${r} (Qty: ${s})`},[a]}validateFlowReady(){return this.deployMode?!!this.flowConfig||(t("‚ö†Ô∏è Error: Flow Config is not initialized!","error",!0),!1):(t("‚ö†Ô∏è Error: `deploy_mode` is not set!","error",!0),!1)}handleSubmit(e){if(!this.validateFlowReady())return void e.preventDefault();e.preventDefault();const n=this.itemsToAdd();0!==n.length?"local"===this.deployMode?(console.log("Running in Local Mode"),this.handleLocalMode(n)):"sandbox"===this.deployMode?(console.log("Running in Sandbox Mode"),this.handleSandboxMode(e)):this.proceedWithSubmission(e,this.flowConfig,n):t("‚ö†Ô∏è No items found for submission.","warning",!0)}handleLocalMode(e){console.info("[LOCAL] Simulated add-to-cart for items:",e);const n=this.variantInput?.dataset.title||"Unknown Product",o=this.sellingPlanInput?.dataset.option_name||"One-time purchase",i=this.quantityInput?.value||"1";t(`üõçÔ∏è Simulated add-to-cart for ${e.length} items. ${n} - ${o} (Qty: ${i})`),setTimeout((()=>{this.proceedWithSubmission(event,this.flowConfig,this.itemsToAdd())}),2e3)}handleSandboxMode(e){if(e.preventDefault(),this.sellingPlanInput?.value){const n=this.sellingPlanInput.value;console.warn(`[SANDBOX] Clearing selling_plan_id: ${n}`),t(`Removing Selling Plan: ${n}`,"warning",!0),setTimeout((()=>{this.sellingPlanInput.value="",console.log(`Selling plan removed: ${n}`),this.proceedWithSubmission(e,this.flowConfig,this.itemsToAdd())}),2e3)}else this.proceedWithSubmission(e,this.flowConfig,this.itemsToAdd())}async proceedWithSubmission(t,e,n){t&&t.preventDefault();let o="local"===this.deployMode;await O(n,e,this.sectionId,this.productGroup,o,(t=>this.triggerHandler(t)))}}customElements.define(n.PRODUCT_GROUP.SUBMIT_INTERCEPTOR,R);const T="data-wwai-purchase-type-option",S={ONETIME:"onetime",SUBSCRIPTION:"subscription"},P=`input[type="radio"][${T}]`,x=[{selector:n.PRODUCT_GROUP.PURCHASE_TYPE,required:!1,max:1,name:"Purchase Type Selector"},{selector:n.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY,required:!1,max:1,name:"Subscription Frequency Selector"},{selector:n.PRODUCT_GROUP.ADD_TO_CART,required:!1,max:2,name:"Add to Cart Button"},{selector:n.PRODUCT_GROUP.SUBMIT_INTERCEPTOR,required:!1,max:2,name:"Submit Interceptor"},{selector:n.PRODUCT_GROUP.PRODUCT_MEDIA_GALLERY_FOR_GRIDS,required:!1,max:1,name:"Media Gallery for Grids"},{selector:n.PRODUCT_GROUP.CAROUSEL,required:!1,max:1,name:"Carousel Media"}],$=[{groupName:"Variant Selector",conditions:[[n.PRODUCT_GROUP.VARIANT],[n.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO]],message:`Either [${n.PRODUCT_GROUP.VARIANT}] or [${n.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO}] must be present.`,enabled:!0},{groupName:"Price Selector",conditions:[[n.PRODUCT_GROUP.PRICE],[n.PRODUCT_GROUP.PRICE_STATIC]],message:`Either [${n.PRODUCT_GROUP.PRICE}] or [${n.PRODUCT_GROUP.PRICE_STATIC}] must be present.`,enabled:!0},{groupName:"Add to Cart Config",conditions:[[n.PRODUCT_GROUP.ADD_TO_CART,n.PRODUCT_GROUP.SUBMIT_INTERCEPTOR],[n.PRODUCT_GROUP.GRID_SMART_INTERACTION]],message:`Either both [${n.PRODUCT_GROUP.ADD_TO_CART} and ${n.PRODUCT_GROUP.SUBMIT_INTERCEPTOR}] or [${n.PRODUCT_GROUP.GRID_ICON_SMART_ADD_TO_CART}] must be present.`,enabled:!0},{groupName:"Media Display Config",conditions:[[n.PRODUCT_GROUP.CAROUSEL],[n.PRODUCT_GROUP.PRODUCT_MEDIA_GALLERY_FOR_GRIDS]],message:`Either [${n.PRODUCT_GROUP.CAROUSEL}] or [${n.PRODUCT_GROUP.PRODUCT_MEDIA_GALLERY_FOR_GRIDS}] must be present.`,enabled:!0}];const D=new class{constructor(t,e){this.requiredRules=t,this.conditionalRules=e}getAllRules(){return{required:this.requiredRules,conditional:this.conditionalRules.filter((t=>t.enabled))}}disableConditionalAssertion(t){const e=this.conditionalRules.find((e=>e.groupName===t));e?(e.enabled=!1,console.log(`Validation: Disabled conditional assertion "${t}"`)):console.warn(`Validation: Conditional assertion "${t}" not found.`)}enableConditionalAssertion(t){const e=this.conditionalRules.find((e=>e.groupName===t));e?(e.enabled=!0,console.log(`Validation: Enabled conditional assertion "${t}"`)):console.warn(`Validation: Conditional assertion "${t}" not found.`)}}([...x],[...$]);const U={},N=Object.values(n.PRODUCT_GROUP);function W(){Object.keys(U).forEach((t=>delete U[t])),N.forEach((t=>{document.querySelectorAll(t).forEach((e=>{const n=e.getAttribute("section_id")?.trim(),o=e.getAttribute("product_group")?.trim();if(!n||!o)return void console.error(`WWAI-ERROR ‚ùå Skipping <${e.tagName.toLowerCase()}> ‚Äî Missing ${n?"":"`section_id`"}${n||o?"":" and "}${o?"":"`product_group`"}.`,e);const i=`${n}__${o}`;U[i]=U[i]||{sectionId:n,productGroup:o,elements:{}},U[i].elements[t]=U[i].elements[t]||[],U[i].elements[t].push(e)}))}));const t={};for(const e of Object.keys(U)){const{sectionId:n,productGroup:o}=U[e];t[n]=t[n]||new Set,t[n].add(o)}const e={};for(const[n,o]of Object.entries(t))e[n]=Array.from(o);return console.group("[WWAI] üß± Product Group Registry"),console.table(e),console.groupEnd(),function(t){console.group("[WWAI] üß™ Validating Product Group Registry"),Object.entries(t).forEach((([t,e])=>{const{sectionId:n,productGroup:o,elements:i}=e,{required:r,conditional:s}=D.getAllRules(),a=[];r.forEach((({selector:t,required:e,exact:n,min:o,max:r})=>{const s=(i[t]||[]).length;e&&0===s&&a.push(`Missing required selector: ${t}`),void 0!==n&&s!==n&&a.push(`Selector "${t}" must have exactly ${n}, found ${s}`),void 0!==o&&s<o&&a.push(`Selector "${t}" must have at least ${o}, found ${s}`),void 0!==r&&s>r&&a.push(`Selector "${t}" must have at most ${r}, found ${s}`)})),s.forEach((({groupName:t,conditions:e,message:n})=>{e.some((t=>t.every((t=>(i[t]||[]).length>0))))||a.push(`‚ùå [${t}]: ${n}`)})),a.length>0&&(console.group(`‚ùå [${t}] (${n} / ${o})`),a.forEach((t=>console.warn(t))),console.groupEnd())})),console.groupEnd()}(U),U}function L(t,e,n){const o=U[`${t}__${e}`];return o&&o.elements&&o.elements[n]?o.elements[n]:[]}function G(t,e,n){const o=L(t,e,n);return 0===o.length?(console.warn(`‚ö†Ô∏è No element found for selector="${n}" in group [${t} / ${e}]`),null):o.length>1?(console.error(`WWAI-ERROR ‚ùå Expected only one element for selector="${n}" but found ${o.length} in group [${t} / ${e}]`),null):o[0]}function k(t,e,n){const o=G(t,e,n);if(!o)throw new Error(`‚ùå No unique element found for selector="${n}" in [${t} / ${e}]`);if(!o.scope)throw new Error(`‚ùå Unique element for selector="${n}" in [${t} / ${e}] does not have a .scope property`);return o.scope}function M(t,e){const n=U[`${t}__${e}`];return n&&n.elements?Object.keys(n.elements):[]}function q(t,e,n){e&&t.updatePrices({price:e.price,compareAtPrice:e.compareAtPrice,discount_percent:e.discount_percent},n)}function j({sectionId:t,productGroup:e,priceObj:o,type:i}){L(t,e,n.PRODUCT_GROUP.PRICE).forEach((t=>{"function"==typeof t.updatePrices?o?q(t,o,i):console.warn(`‚ö†Ô∏è priceObj data is missing for type '${i}'.`):console.warn("‚ö†Ô∏è Skipping price selector: missing updatePrices method",t)}))}function B({sectionId:t,productGroup:e,sellingPlanId:o,sellingPlanName:i}){const r=G(t,e,n.PRODUCT_GROUP.ADD_TO_CART);r&&(r&&"function"==typeof r.updateSellingPlan?r.updateSellingPlan(o,i):console.error("WWAI-ERROR ‚ùå Could not find <product-custom-add-to-cart-button-selector> or missing .updateSellingPlan()"))}function V({sectionId:t,productGroup:e,purchaseType:o,pricesDict:i}){o===S.ONETIME?function({sectionId:t,productGroup:e,pricesDict:n}){console.log("üõí One-Time Purchase Selected ‚Üí Clearing Selling Plan ID"),B({sectionId:t,productGroup:e,sellingPlanId:"",sellingPlanName:""}),j({sectionId:t,productGroup:e,priceObj:n.oneTimePrice,type:"onetime_or_subscription"})}({sectionId:t,productGroup:e,pricesDict:i}):o===S.SUBSCRIPTION?function({sectionId:t,productGroup:e}){const o=G(t,e,n.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY);if(!o)return void console.warn(`‚ö†Ô∏è No subscription frequency selector found for [${t} / ${e}]`);const i=o.getCurrentSelectedPlan();i?(console.log("‚úÖ Current Subscription Plan Found:",i),B({sectionId:t,productGroup:e,sellingPlanId:i.selling_plan_id,sellingPlanName:i.option_name}),j({sectionId:t,productGroup:e,priceObj:{price:i.after_price,compareAtPrice:i.before_price,discount_percent:i.discount_percent},type:"onetime_or_subscription"})):console.warn(`‚ö†Ô∏è No subscription plan selected for [${t} / ${e}]`)}({sectionId:t,productGroup:e}):console.warn(`‚ö†Ô∏è Unsupported purchase type '${o}' for [${t} / ${e}]`)}class H extends e{constructor(){super(),this.subscriptionInput=null,this.onetimeInput=null,this.pricesDict=null}connectedCallback(){if(!this.sectionId||!this.productGroup)return void console.warn(`‚ö†Ô∏è <product-purchase-type-selector> missing attributes ‚Äî sectionId: ${this.sectionId}, productGroup: ${this.productGroup}`);this.querySelectorAll(`input[type="radio"][${T}]`).forEach((t=>{const e=t.getAttribute(T);e===S.SUBSCRIPTION?this.subscriptionInput=t:e===S.ONETIME&&(this.onetimeInput=t)})),this.subscriptionInput&&this.onetimeInput?this.subscriptionInput.name===this.onetimeInput.name?(this.ensureAutocompleteOff(),this.subscriptionInput.addEventListener("change",(()=>{this.subscriptionInput.checked&&(this.onetimeInput.checked=!1,this.handlePurchaseTypeChange(S.SUBSCRIPTION))})),this.onetimeInput.addEventListener("change",(()=>{this.onetimeInput.checked&&(this.subscriptionInput.checked=!1,this.handlePurchaseTypeChange(S.ONETIME))}))):console.error("WWAI-ERROR ‚ùå Purchase type radios must have the same name"):console.error("WWAI-ERROR ‚ùå Missing both purchase type radio inputs")}cachePrices(t){this.pricesDict=t}getSelectedPurchaseType(){return this.subscriptionInput?.checked?{purchaseType:S.SUBSCRIPTION}:(this.onetimeInput,{purchaseType:S.ONETIME})}setPurchaseType(t){t===S.SUBSCRIPTION?(this.subscriptionInput.checked=!0,this.onetimeInput.checked=!1):(this.subscriptionInput.checked=!1,this.onetimeInput.checked=!0)}handlePurchaseTypeChange(t){console.log(`üîÑ Purchase type changed to: ${t}`),V({sectionId:this.sectionId,productGroup:this.productGroup,purchaseType:t,pricesDict:this.pricesDict})}ensureAutocompleteOff(){[this.subscriptionInput,this.onetimeInput].forEach((t=>{t.hasAttribute("autocomplete")||t.setAttribute("autocomplete","off")}))}}customElements.define(n.PRODUCT_GROUP.PURCHASE_TYPE,H);const F="data-wwai-subscription-frequency-select",z=`[${F}]`,Y="data-wwai-product-variant-option-type",J="data-wwai-product-label",X="data-wwai-product-variant-label",Q="data-wwai-product-variant-label-level",Z="data-wwai-variant-label-text-slot",K="product",tt="product_variant";function et({sectionId:t,productGroup:e,oneTimePrice:o,subscriptionPrice:i,purchaseType:r}){const s=L(t,e,n.PRODUCT_GROUP.PRICE);let a=function(t,e){return!!G(t,e,n.PRODUCT_GROUP.PURCHASE_TYPE)}(t,e);s.length?s.forEach((t=>{"function"==typeof t.updatePrices?(q(t,o,"one_time"),q(t,i,"subscription"),a&&(r==S.ONETIME?q(t,o,"onetime_or_subscription"):q(t,i,"onetime_or_subscription"))):console.warn("‚ö†Ô∏è Skipping price selector: missing updatePrices method",t)})):console.warn(`‚ö†Ô∏è No price selectors found for section="${t}", productGroup="${e}"`)}function nt({sectionId:t,productGroup:e,oneTimePrice:o,subscriptionPrice:i,purchaseType:r,onlySetPurchaseType:s=!1}){const a=G(t,e,n.PRODUCT_GROUP.PURCHASE_TYPE);a&&(s||(void 0===o&&void 0===i?console.error(`WWAI-ERROR ‚ùå setPurchaseTypeForGroup: Both oneTimePrice and subscriptionPrice are undefined for [${t} / ${e}]`):void 0===o&&void 0===i||"function"==typeof a.cachePrices&&a.cachePrices({oneTimePrice:o,subscriptionPrice:i})),void 0===r?console.error(`WWAI-ERROR ‚ùå setPurchaseTypeForGroup: purchaseType is undefined for [${t} / ${e}]`):"function"==typeof a.setPurchaseType?(a.setPurchaseType(r),console.log(`‚úÖ Default purchase type set for [${t} / ${e}] ‚Üí ${r}`)):console.error("WWAI-ERROR ‚ùå <product-purchase-type-selector> is missing .setPurchaseType()"))}function ot({sectionId:t,productGroup:e,media:o=[],moveToIndex:i=0}){const r=G(t,e,n.PRODUCT_GROUP.CAROUSEL);r&&("function"==typeof r.updateCarouselMedia?r.updateCarouselMedia(o,i):console.error("WWAI-ERROR ‚ùå <product-custom-carousel-media-selector> is missing .updateCarouselMedia()"))}class it extends e{constructor(){super(),this.sellingPlans=[],this.selectElement=null}getElementName(){return"subscription frequency selector"}connectedCallback(){const t=this.querySelectorAll(z);0!==t.length?(t.length>1&&console.warn("‚ö†Ô∏è Multiple <select> elements found for subscription frequency. Only the first one will be used."),this.selectElement=t[0],this.selectElement.addEventListener("change",(t=>{this.handleSubscriptionPlanChange(this.getCurrentSelectedPlan())}))):console.error(`WWAI-ERROR ‚ùå No <select> element found with selector ${z}`)}handleSubscriptionPlanChange(t){!function(t,e,n){if(!t||!e||!n)return void console.error("WWAI-ERROR ‚ùå Invalid parameters provided to updateSubscriptionPlanForGroup.");const o={price:t.after_price,compareAtPrice:t.before_price,discount_percent:t.discount_percent};nt({sectionId:e,productGroup:n,oneTimePrice:void 0,subscriptionPrice:void 0,purchaseType:S.SUBSCRIPTION,onlySetPurchaseType:!0}),["subscription","onetime_or_subscription"].forEach((t=>{j({sectionId:e,productGroup:n,priceObj:o,type:t})})),B({sectionId:e,productGroup:n,sellingPlanId:t.selling_plan_id,sellingPlanName:t.option_name}),console.log(`‚úÖ Subscription plan successfully updated for [${e} / ${n}]`)}(t,this.sectionId,this.productGroup)}updateSubscriptionOptions(t){Array.isArray(t)?(this.selectElement.innerHTML="",t.forEach((t=>{const e=document.createElement("option");e.value=t.selling_plan_id,e.textContent=t.option_name,e.dataset.beforePrice=t.before_price,e.dataset.afterPrice=t.after_price,e.dataset.discountPercent=t.discount_percent,this.selectElement.appendChild(e)})),console.log("‚úÖ Subscription options updated:",JSON.stringify(t,null,2))):console.error("WWAI-ERROR ‚ùå Invalid subscription options received.")}getSelectedPlanId(){return this.selectElement.value||null}getCurrentSelectedPlan(){const t=this.selectElement.options[this.selectElement.selectedIndex];return t?{option_name:t.textContent.trim(),selling_plan_id:t.value.trim(),before_price:t.dataset.beforePrice?.trim(),after_price:t.dataset.afterPrice?.trim(),discount_percent:t.dataset.discountPercent?.trim()}:(console.warn("‚ö†Ô∏è No plan currently selected."),null)}}customElements.define(n.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY,it);const rt="data-wwai-variant-custom-label-text",st="data-wwai-variant-custom-label-value",at=`[${rt}]`;class lt extends e{connectedCallback(){}updateCustomLabels(t){if("object"!=typeof t||!t)return void console.error("WWAI-ERROR ‚ùå Invalid label data received:",t);const e=this.querySelectorAll(`[${rt}]`);e.length?e.forEach((e=>{const n=e.getAttribute(st),o=t[n];o?(e.textContent=o,console.log(`‚úÖ Updated label for ${n}:`,o)):console.warn(`‚ö†Ô∏è No label found for type: ${n} in labelData`)})):console.warn(`‚ö†Ô∏è No elements found with ${rt} inside <product-variant-custom-labeled-text> (section: ${this.sectionId}, group: ${this.productGroup})`)}}function ct(t){t&&0!==t.length&&t.forEach((t=>{t.hasAttribute("autocomplete")||t.setAttribute("autocomplete","off")}))}function dt(t){return[...t].filter((t=>t.checked))}function ut(t){return t.find((t=>t.getAttribute(Y)===K))?.getAttribute(J)}function pt(t,e,n){let o=!1;return t.forEach((t=>{const n=t.getAttribute(J)?.trim(),i=n===e.trim();t.checked=i,i&&(o=!0)})),o||console.warn(`‚ùå No radio input matched product label: "${e}" in <product-variant-selector> [${n}].`),o}function gt(t,e){const n={};return t.forEach((t=>{const o=t.getAttribute(J)?.trim(),i=t.getAttribute(Q)||"option1",r=t.getAttribute(X)?.trim();o===e.trim()&&(n[i]||(n[i]=new Set),n[i].add(r))})),n}function ft(t,e,n){let o=!0;return Object.entries(e).forEach((([e,i])=>{i.size>1&&!(e in n)&&(console.warn(`‚ùå Missing required variant option for "${e}" (multiple options exist) in product "${t}"`),o=!1)})),o}function ht(t,e,n){let o=!0;return Object.entries(n).forEach((([n,i])=>{let r=!1;const s=i.trim();t.forEach((t=>{const o=t.getAttribute(J)?.trim(),i=t.getAttribute(Q)||"option1",a=t.getAttribute(X)?.trim();o===e.trim()&&i===n?(t.checked=a===s,a===s&&(r=!0)):o!==e.trim()&&(t.checked=!1)})),r||(console.warn(`‚ö†Ô∏è No match for [${n} = "${s}"] in product "${e.trim()}"`),o=!1)})),o}function bt(t){const e=t?t.inputs:null;if(!e||0===e.length)return console.error(`WWAI-ERROR [buildProductHierarchyFromSelector] ‚ùå No inputs found on selector: ${t}`),null;const n=new Set,o={};e.forEach((t=>{const e=t.getAttribute(Y),i=t.getAttribute(J);if(i&&(n.add(i),o[i]||(o[i]={}),"product_variant"===e)){const e=t.getAttribute(X),n=t.getAttribute(Q)||"option1";o[i][n]||(o[i][n]=new Set),o[i][n].add(e)}}));const i={productLabels:[...n],variants:{}};return Object.entries(o).forEach((([t,e])=>{i.variants[t]={},Object.entries(e).forEach((([e,n])=>{i.variants[t][e]=[...n]}))})),i}function mt({rootElement:t,variantRadios:e,inputs:n,sectionId:o,productGroup:i,uxConfig:r={}}){if(!r)return void console.warn("‚ö†Ô∏è No variant UX config provided.");const{hideSingleLengthVariants:s,onlyShowVariantsWithLabelContains:a}=r;if(!e||!e.length)return void console.warn(`‚ö†Ô∏è No variant radios found in <product-variant-selector> [${o}].`);const l=ut(dt(n)),c=bt(t);s&&(console.log(`üîß Hiding single-length variants for [${i}, ${o}]`),function(t,e,n,o){if(!o)return;console.log(`üõ†Ô∏è Hiding single size variants for product: ${e}`);const i=n.variants[e];Object.entries(i).forEach((([e,n])=>{if(1===n.length){console.log(`üîç Single variant detected at ${e}: ${n[0]}`);const o=n[0].trim();t.forEach((t=>{const n=t.getAttribute(Q)||"option1",i=t.getAttribute(X)?.trim();if(n===e&&i===o){console.log(`üôà Hiding input for ${e} = ${o}`),t.parentElement.style.display="none",t.checked=!0;let n=t.parentElement,i=!1;for(let t=0;t<5&&n;t++){if(n.hasAttribute("data-wwai-product-variant-option-wrapper")){console.log("üéØ Found wrapper, setting display to none"),n.style.display="none",i=!0;break}n=n.parentElement}i||console.log(`‚ö†Ô∏è No wrapper found for ${o}`)}}))}}))}(e,l,c,s)),a&&(console.log(`üîß Showing only variants matching "${a}" for [${i}, ${o}]`),function(t,e){if(!e)return;const n=e.trim().toLowerCase();t.forEach((t=>{const e=t.getAttribute("data-wwai-product-variant-label-key")?.trim().toLowerCase();if(e&&e.includes(n)){"none"===t.parentElement.style.display&&(t.parentElement.style.display="");let e=t.parentElement;for(let t=0;t<5&&e;t++){if(e.hasAttribute("data-wwai-product-variant-option-wrapper")){"none"===e.style.display&&(console.log("‚Ü™Ô∏è Display was 'none', reverting back to original"),e.style.display="");break}e=e.parentElement}}else{t.parentElement.style.display="none";let e=t.parentElement;for(let t=0;t<5&&e;t++){if(e.hasAttribute("data-wwai-product-variant-option-wrapper")){e.style.display="none";break}e=e.parentElement}}}))}(e,a))}function wt(t){if("number"!=typeof t||isNaN(t))return"";const e="number"==typeof E().CURRENCY_FACTOR?E().CURRENCY_FACTOR:.01,n=E().CURRENCY||"USD",o=t*e;return new Intl.NumberFormat(void 0,{style:"currency",currency:n}).format(o)}function _t(){return window.__WWAI__SECTION_PRODUCT_DATA__&&window.__WWAI__SECTION_PRODUCT_DATA__.all_sections?window.__WWAI__SECTION_PRODUCT_DATA__.all_sections:(console.warn("‚ö†Ô∏è No data found for section: all_sections."),null)}function yt(t,e){if(e.startsWith("wwai_virtual_bundle__"))return{};const n=_t();if(!n||!n.storeData||!n.storeData.productGroups)return console.warn("‚ö†Ô∏è Invalid globalSectionData."),null;const o=n.storeData.productGroups[t];return o&&o[e]?o[e]:(console.warn(`‚ö†Ô∏è Product "${e}" not found in product group "${t}".`),null)}function vt(...t){return t.filter((t=>null!=t)).map((t=>t.trim()))}function Ct(t,e){const n=vt(t.option1,t.option2,t.option3);return e.length===n.length&&e.every(((t,e)=>t===n[e]))}function At(t,e){let n=(o=t,i=e,Array.isArray(window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__)&&window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__.length>0?function(t,e,n){for(const o of t){const t=o.split(":").map((t=>t.trim()));if(t[0]===e&&t[1]===n)return t[2]}return null}(window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__,o,i):null);var o,i;if(window.WWAI_VIRTUAL_BUNDLE_CONFIG&&window.WWAI_VIRTUAL_BUNDLE_CONFIG.hasOwnProperty(n)){const e=window.WWAI_VIRTUAL_BUNDLE_CONFIG[n],o=function(t,e,n){const o=`wwai_bundle - ${e.map((t=>t?.title||"Unknown")).join(" + ")}`;let i=0,r=0,s=!0;const a=[];return e.forEach(((t,e)=>{const o=n[e]?.quantity||1,l=null!=t.compare_at_price?t.compare_at_price:t.price;i+=t.price*o,r+=l*o,t.available||(s=!1),a.push({id:t.id,quantity:o})})),{id:`wwai_bundle_${t}`,title:o,available:s,price:i,compare_at_price:r,add_to_cart_payload:a}}(t,e.map((t=>Ot(t.handle,t.handle,...t.variantOptions))),e);return o}return null}function Ot(t,e,n,o=null,i=null){const r=yt(t,e);if(!r)return null;if(e.startsWith("wwai_virtual_bundle__")){let n=At(t,e);return console.log("Resolved virtual bundle:",t,e,n),n}const s=r.variants||[],a=vt(n,o,i);if(1===a.length&&"__wwai_first__"===a[0])return window.customProductEventLoggingEnabled&&console.log("Returning first variant due to __wwai_first__ directive."),s[0];for(let t of s)if(Ct(t,a))return t;return 1===s.length?s[0]:(console.warn(`‚ö†Ô∏è No matching variant found for options [${a.join(", ")}] in product "${e}" under group "${t}".`),null)}function It(t,e,n=null){const o=function(t,e){const n=_t();if(!n||!n.storeData||!n.storeData.variantSellingPlans)return console.warn("‚ö†Ô∏è Invalid globalSectionData or missing variantSellingPlans."),null;const o=`${t}__${e}`;return n.storeData.variantSellingPlans[o]||(console.warn(`‚ö†Ô∏è No selling plan found for productGroup="${t}" and productLabel="${e}"`),null)}(t,e);if(!o)return console.warn(`‚ùå Cannot build subscription mapping ‚Äî selling plan data missing for ${t} / ${e}`),null;const{variants:i,selling_plan_groups:r}=o;return Array.isArray(i)&&Array.isArray(r)?function(t,e,n=null){let o={};return t.forEach((t=>{const i=t.id,r=t.title,s=t.price;let a=[];const l=Array.isArray(t.selling_plan_allocations)&&t.selling_plan_allocations.length>0;(t.selling_plan_allocations||[]).forEach((t=>{const o=t.selling_plan_id,i=t.price_adjustments||[];let r=s,l=null;i.forEach((t=>{1===t.position?r=t.price:2===t.position&&(l=t.price)})),null===l&&(l=r),e.forEach((t=>{t.selling_plans.forEach((t=>{if(t.id===o){let e=t.name;n&&e.startsWith(n)&&(e=e.substring(n.length).trim()),a.push({selling_plan_id:o,delivery_option:e,base_price:s,first_order_price:r,subsequent_order_price:l})}}))}))})),o[`${i}, ${r}`]={variant_id:i,variant_title:r,has_subscription:l,selling_plans:a}})),o}(i,r,n):(console.warn("‚ùå Invalid variants or selling_plan_groups format."),null)}function Et(t,e,n,o){if(!(t&&e&&n&&o))return console.warn("‚ùå Invalid product group, product label, variant object, or config."),null;const i=It(t,e,o.uxConfig.variantOptionRemovePrefix),r=null==E().useMockSubscription?(console.warn("‚ö†Ô∏è Missing or invalid 'useMockSubscription' in window object."),null):E().useMockSubscription,s=function(t,e,n,o=!1){if(!t||"object"!=typeof t)return null;for(const i of Object.keys(t)){const[r,s]=i.split(", ").map((t=>t.trim()));if(o?s===n:r===String(e))return t[i]}return null}(i,n.id,n.title,r);return s}function Rt(t,e){const n={};return new Set([...Object.keys(e||{}),...Object.keys(t||{})]).forEach((o=>{const i=t?.[o],r=e?.[o];null!=i?n[o]=i:null!=r&&(n[o]=r)})),n}function Tt(t,e,n=null){const o=n||E().WWAI_PRODUCT_GROUP_CONFIG;if(!o||"object"!=typeof o)return console.error("WWAI-ERROR ‚ùå getWWAIConfig().WWAI_PRODUCT_GROUP_CONFIG is missing or invalid."),null;t.includes("__")?t=t.split("__")[1]:t.includes("--")&&(t=t.split("--")[1]);const i=o[t];if(!i)return console.warn(`‚ùå No config found for sectionId "${t}"`),null;const r=i[e];if(!r)return console.warn(`‚ùå No product group config found for "${e}" in section "${t}"`),null;const s=i.defaults||{};return{pricingConfig:Rt(r.pricingConfig,s.pricingConfig),uxConfig:Rt(r.uxConfig,s.uxConfig),flowConfig:Rt(r.flowConfig,s.flowConfig),variantDispatchConfig:r.variantDispatchConfig||{}}}function St(t,e,n,o){console.log(`üîÑ Resolving Product Data for: [${e}] - ${n}`);const i=Tt(t,e),r=function(t,e,n,o={}){if(n.startsWith("wwai_virtual_bundle"))return{};const i=E().WWAI_PRODUCT_VARIANT_OVERRIDES;if(!i)return console.error("WWAI-ERROR ‚ùå WWAI_PRODUCT_VARIANT_OVERRIDES not found on window."),null;let r=t;if(r.includes("__")?r=r.split("__")[1]:r.includes("--")&&(r=r.split("--")[1]),!i[r]||!i[r][e])return console.warn(`‚ùå Section "${r}" or product group "${e}" not found in overrides.`),null;const s=i[r][e][n];if(!s)return console.warn(`‚ùå Product label "${n}" not found in overrides under group "${e}".`),null;const a=[o.option1,o.option2,o.option3].filter(Boolean).map((t=>t.trim())).join(" | ");return s[a]||(console.warn(`‚ùå Variant key "${a}" not found under product "${n}".`),null)}(t,e,n,o),{product:s,variant:a}=function(t,e,n={}){console.group("[resolveVariantFromWindowProduct]"),console.log("Product Group:",t),console.log("Product Label:",e),console.log("Variant Options:",n),console.groupEnd();const o=n.option1||null,i=n.option2||null,r=n.option3||null,s=yt(t,e);return s?{product:s,variant:Ot(t,e,o,i,r)}:{product:null,variant:null}}(e,n,o);return s&&a?{config:i,variant_config:r,product_object:s,variant_object:a}:(console.error(`WWAI-ERROR ‚ùå Failed to resolve product or variant data for ${n}`),{config:i,variant_config:r,product_object:null,variant_object:null})}customElements.define(n.PRODUCT_GROUP.VARIANT_CUSTOM_LABEL,lt);const{PRICE:Pt,VARIANT_CUSTOM_LABEL:xt,CAROUSEL:$t,PURCHASE_TYPE:Dt,SUBSCRIPTION_FREQUENCY:Ut,ADD_TO_CART:Nt,GRID_SMART_INTERACTION:Wt,TITLE:Lt}=n.PRODUCT_GROUP;function Gt({productObject:t,variantObject:e,variantConfig:n,productGroup:o,productLabel:i,config:r,purchaseType:s=null}){const a=function(t,e,n={}){if(!e||"number"!=typeof e.price)return console.error("WWAI-ERROR ‚ùå Invalid variant provided."),{price:"$0.00",compareAtPrice:"$0.00",discount_percent:"0.00"};let o=n?.discountPercent??0;null!=n?.productLabelDiscountMapping&&null!=n?.productLabelDiscountMapping[t]&&n?.productLabelDiscountMapping[t]?.discountPercent&&(o=n?.productLabelDiscountMapping[t]?.discountPercent);let i=e.price,r=e.compare_at_price||null;o>0&&(r=Math.max(e.price,e.compare_at_price||0),i=e.price-e.price*o/100),r||(r=e.price);const s=r>0?(r-i)/r*100:0,a=parseInt(s,10),l=a===s?a:s.toFixed(2);let c=r-i;return c<0&&(c=0),{price:wt(i),compareAtPrice:wt(r),discount_percent:l,savings:wt(c)}}(i,e,r.pricingConfig),l=function(t,e){if(!t||!Array.isArray(t.media))return console.warn("‚ö†Ô∏è Invalid product or media array."),[];if(!e||!e.customMediaLabel)return t.media;const n=e.customMediaLabel,o=E().WWAI_LABELED_IMAGES?.[n];return Array.isArray(o)&&0!==o.length?o:(console.warn(`‚ö†Ô∏è No labeled media found for label "${n}". Falling back to product media.`),t.media)}(t,n),c=function(t,e,n){const o=t?.redirectToMediaIndex;if("number"==typeof o&&o>=0)return o;{console.log("No index found, falling back to product media");const t=n?.featured_media?.preview_image?.src;if(!t)return void console.log("Featured media src not found in variant object.");const o=(e?.media||[]).filter((t=>t?.src)).findIndex((e=>e.src===t));return console.log("Index found, returning index",o),-1!==o?o:void console.log("No matching media found in product.")}}(n,t,e),d=function(t,e,n,o){const i=Et(t,e,n,o);if(!i)return console.warn("Selling plan info not found. Returning."),[];const r=o?.variant_option_remove_prefix||"";let s=null;null!=o?.pricingConfig?.productLabelDiscountMapping&&(s=o?.pricingConfig?.productLabelDiscountMapping[e]?.subscriptionDiscountPercent??null);const a=null!=s?s:o?.pricingConfig?.subscriptionDiscountPercent??0;return i.selling_plans.map((t=>{const e=t.base_price;let n=t.first_order_price;a>0&&(n=Math.round(n*(1-a/100)));const o=e>0?(e-n)/e*100:0;let i=t.delivery_option||"";r&&i.startsWith(r)&&(i=i.substring(r.length).trim());let s=e-n;return s<0&&(s=0),{option_name:i,selling_plan_id:String(t.selling_plan_id),before_price:wt(e),after_price:wt(n),savings:wt(s),discount_percent:o.toFixed(2)}}))}(o,i,e,r),u=function(t,e,n){const o=e?.pricingConfig?.defaultSubscriptionOption??null,i=e?.pricingConfig?.useVariantCompareAtPriceForSubscription??!0;if(!Array.isArray(t)||0===t.length)return console.warn("‚ö†Ô∏è No valid selling plan info provided."),{sellingPlanName:null,sellingPlanId:null,sellingPlanPriceObject:null};const r=o&&t.find((t=>t.option_name===o))||t[0],s=r.option_name,a=r.selling_plan_id,l=r.after_price;let c=r.before_price;return i&&n.compare_at_price&&(c=wt(n.compare_at_price)),{sellingPlanName:s,sellingPlanId:a,sellingPlanPriceObject:{price:l,compareAtPrice:c,discount_percent:r.discount_percent,savings:r.savings}}}(d,r,e);let p=null!=s?s:r.uxConfig.defaultPurchaseType;const g=function({variantObject:t,sellingPlanId:e,sellingPlanName:n,productObject:o,defaultPurchaseType:i}){if(!t||!o)return console.warn("‚ùå Invalid variant object or product object."),null;const r=i===S.SUBSCRIPTION,s=!1!==t.available;return{variantId:t.id,variantName:`${o.title} - ${t.title}`,productHandle:o.handle,available:s,sellingPlanId:r?e:null,sellingPlanName:r?n:null}}({variantObject:e,sellingPlanId:u.sellingPlanId,sellingPlanName:u.sellingPlanName,productObject:t,defaultPurchaseType:p});return{oneTimePrice:a,media:l,mediaIndex:c,sellingPlans:d,sellingPlanDetails:u,addToCartPayload:g}}function kt({sectionId:t,productGroup:e,productLabel:o,variantOptions:i,productObject:r,variantObject:s,variantConfig:a,config:l}){const c=Gt({productObject:r,variantObject:s,variantConfig:a,productGroup:e,productLabel:o,config:l}),d=M(t,e),u=t=>d.includes(t);!function({sectionId:t,productGroup:e,productLabel:o,variantOptions:i}){const r=G(t,e,n.PRODUCT_GROUP.VARIANT);if(!r)return;if("function"!=typeof r.setSelectedProductAndOptions)return void console.error("WWAI-ERROR ‚ùå <product-variant-selector> is missing setSelectedProductAndOptions()");r.setSelectedProductAndOptions(o,i)?console.log(`‚úÖ Default variant set for [${t} / ${e}] ‚Üí ${o}`,i):console.warn(`‚ö†Ô∏è Failed to set default product/options for section="${t}", group="${e}"`)}({sectionId:t,productGroup:e,productLabel:o,variantOptions:i}),function({sectionId:t,productGroup:e,labelText:o}){const i=G(t,e,n.PRODUCT_GROUP.VARIANT);if(!i)return;const r=i.querySelector(`[${Z}]`);r?(r.textContent=o,console.log(`‚úÖ Variant label text updated for [${t} / ${e}] ‚Üí ${o}`)):console.warn(`‚ö†Ô∏è No element found with ${Z} in [${t} / ${e}]`)}({sectionId:t,productGroup:e,labelText:s.title||""}),u(xt)&&function({sectionId:t,productGroup:e,labelData:o={}}){const i=G(t,e,n.PRODUCT_GROUP.VARIANT_CUSTOM_LABEL);i&&("function"==typeof i.updateCustomLabels?(i.updateCustomLabels(o),console.log(`‚úÖ Custom labels updated for [${t} / ${e}] ‚Üí`,o)):console.error("WWAI-ERROR ‚ùå <product-variant-custom-labeled-text-selector> is missing .updateCustomLabels()"))}({sectionId:t,productGroup:e,labelData:a?.customLabelText||{}}),u(Pt)&&et({sectionId:t,productGroup:e,oneTimePrice:c.oneTimePrice,subscriptionPrice:c.sellingPlanDetails.sellingPlanPriceObject,purchaseType:l.uxConfig.defaultPurchaseType}),u($t)&&ot({sectionId:t,productGroup:e,media:c.media,moveToIndex:c.mediaIndex}),u(Dt)&&nt({sectionId:t,productGroup:e,oneTimePrice:c.oneTimePrice,subscriptionPrice:c.sellingPlanDetails.sellingPlanPriceObject,purchaseType:l.uxConfig.defaultPurchaseType,onlySetPurchaseType:!1}),u(Ut)&&function({sectionId:t,productGroup:e,subscriptionOptions:o}){const i=G(t,e,n.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY);i&&("function"==typeof i.updateSubscriptionOptions?(console.log("subscriptionOptions:",o),i.updateSubscriptionOptions(o),console.log(`‚úÖ Default subscription frequency set for [${t} / ${e}] ‚Üí Selling Plan Length: ${o.length}`)):console.error("WWAI-ERROR ‚ùå <product-subscription-frequency-selector> is missing .updateSubscriptionOptions()"))}({sectionId:t,productGroup:e,subscriptionOptions:c.sellingPlans}),u(Nt)&&function({sectionId:t,productGroup:e,addToCartPayload:o}){const i=G(t,e,n.PRODUCT_GROUP.ADD_TO_CART);i&&(i&&"function"==typeof i.updateAddToCartForm?i.updateAddToCartForm(o):console.error("WWAI-ERROR ‚ùå Could not find <product-custom-add-to-cart-button-selector> or missing .updateAddToCartForm()"))}({sectionId:t,productGroup:e,addToCartPayload:c.addToCartPayload}),u(Wt)&&(console.log("üîÑ Updating Grid Smart Interaction Availability:",t,e,c.addToCartPayload),function(t,e,o){const i=L(t,e,n.PRODUCT_GROUP.GRID_SMART_INTERACTION),r=!0===o?.available;i.forEach(((t,e)=>{"function"==typeof t.updateAvailability?(t.updateAvailability(r,"Out of stock"),console.log(`üîÑ Grid Smart Interaction Button [${e}] availability set to: ${r}`)):console.warn(`‚ö†Ô∏è Grid Smart Interaction Button [${e}] is missing .updateAvailability()`)}))}(t,e,c.addToCartPayload)),u(Lt)&&function({sectionId:t,productGroup:e,title:o}){const i=G(t,e,n.PRODUCT_GROUP.TITLE);i&&("function"==typeof i.updateTitle?(i.updateTitle(o),console.log(`‚úÖ Title updated for [${t} / ${e}] ‚Üí ${o}`)):console.error("WWAI-ERROR ‚ùå <product-custom-title-selector> is missing .updateTitle()"))}({sectionId:t,productGroup:e,title:r.title})}class Mt extends e{constructor(){super(),this.scope=this.getAttribute("wwai-scope")||null,this.product_helper_handle=this.getAttribute("product-helper-handle")||null,this.handlers={},this.uxConfig=null,this.inputs=null}connectedCallback(){this.initInputs(),this.bindEvents(),this.ensureAutocompleteOff()}getProductRadios(){return this.querySelectorAll(`input[type="radio"][${Y}="${K}"]`)}getVariantRadios(){return this.querySelectorAll(`input[type="radio"][${Y}="${tt}"]`)}initInputs(){this.inputs=this.querySelectorAll('input[type="radio"]')}ensureAutocompleteOff(){ct(this.inputs)}applyVariantUXConfig(){this.uxConfig&&this.uxConfig.variantUXConfig&&mt({rootElement:this,variantRadios:this.getVariantRadios(),inputs:this.inputs,sectionId:this.sectionId,productGroup:this.productGroup,uxConfig:this.uxConfig.variantUXConfig})}initUXConfig(t){super.initUXConfig(t),this.applyVariantUXConfig()}handleVariantUpdate(){clearTimeout(this._debounceTimeout),this._debounceTimeout=setTimeout((()=>{const{productLabel:t,variantOptions:e}=this.getSelectedVariant();if(!t||!e)return;const n={productLabel:t,variantOptions:e};console.group("[WWAI] üîÑ Variant Change Detected"),console.log("üõí Product Label:",t),console.log("üéØ Variant Options:",e),console.groupEnd(),console.log("üîÅ Trigger handler on change or re-click"),this.triggerHandler("variantChange",n),this.uxConfig&&this.uxConfig.variantUXConfig&&!1===this.uxConfig.variantUXConfig.refreshUxOnVariantChange?console.log("üîÑ Refresh UX on variant change is disabled. Skipping reinitialization."):function(t,e,n,o){console.log(`üîÑ Reinitializing Product Group on Variant Change: [${e}] - ${n}`);const{config:i,variant_config:r,product_object:s,variant_object:a}=St(t,e,n,o);s&&a?(kt({sectionId:t,productGroup:e,productLabel:n,variantOptions:o,productObject:s,variantObject:a,variantConfig:r,config:i}),console.log(`‚úÖ Reinitialized Product Group: ${e} for Variant ${n}`)):console.error(`WWAI-ERROR ‚ùå Unable to reinitialize product group for ${e}`)}(this.sectionId,this.productGroup,t,e)}),0)}bindEvents(){const t=this.handleVariantUpdate.bind(this);this.inputs.forEach((e=>{e.addEventListener("change",t),e.addEventListener("click",t)}))}registerHandler(t,e){t&&"function"==typeof e?(this.handlers[t]=this.handlers[t]||[],this.handlers[t].push(e),console.log(`‚úÖ Handler registered for type: ${t}`,e)):console.warn("‚ö†Ô∏è Invalid handler registration:",{type:t,callback:e})}triggerHandler(t,e){const n=this.handlers?.[t]||[];n.length&&(console.log(`‚ñ∂Ô∏è Running ${n.length} handler(s) for type: ${t}`,n),n.forEach((n=>{try{n(e)}catch(e){console.error(`WWAI-ERROR ‚ùå Error in handler for type "${t}":`,e)}})))}getSelectedVariant(){const t=dt(this.inputs),e=ut(t);if(!e)return console.warn(`‚ö†Ô∏è No selected product found in <product-variant-selector> [${this.sectionId}].`),null;const n=function(t,e){const n={},o={};return t.forEach((t=>{if(t.getAttribute(Y)===tt&&t.getAttribute(J)===e){const i=t.getAttribute(Q)||"option1",r=t.getAttribute(X);o[i]?console.warn(`‚ùå Multiple variant options selected for "${i}" in product "${e}"`):(n[i]=r,o[i]=!0)}})),0===Object.keys(n).length?(console.warn(`‚ùå No variant options found for product "${e}", Returning default option "__wwai_first__"`),{option1:"__wwai_first__"}):n}(t,e);return{productLabel:e,variantOptions:n}}setSelectedProductAndOptions(t,e={}){const n=this.getProductRadios();if(!n.length)return console.warn(`‚ö†Ô∏è No product radio inputs found in <product-variant-selector> [${this.sectionId}].`),!1;if(!pt(n,t,this.sectionId))return!1;const o=this.getVariantRadios(),i=ft(t,gt(o,t),e);this.applyVariantUXConfig();const r=ht(o,t,e);return window.customProductEventLoggingEnabled&&console.log(`‚úÖ Set product: "${t}", selected options:`,e),i&&r}}customElements.define(n.PRODUCT_GROUP.VARIANT,Mt);class qt extends e{constructor(){super()}connectedCallback(){}}function jt(t,e){const n=document.querySelector(`product-variant-selector[section_id="${t}"][product_group="${e}"]`);return n||(console.error(`WWAI-ERROR ‚ùå No <product-variant-selector> found for section: ${t}, group: ${e}`),null)}function Bt(t,e,n){const{config:o,variant_config:i,product_object:r,variant_object:s}=St(e,n,t.productLabel,t.variantOptions);if(!s||!r)return console.error("WWAI-ERROR ‚ùå Variant or Product Object not found during resolution."),null;const a=r.title||"Unknown Product",l=s.title||"One-time purchase";return[{id:s.id,quantity:1,_debug:{source:"manual",variantId:s.id,quantity:1,sellingPlan:null,bundlePayload:!1,readableString:`${a} - ${l} (Qty: 1)`}}]}function Vt(t,e,n,o,i=!1){if(!t||"string"!=typeof t)return void console.error("WWAI-ERROR ‚ùå Invalid path specified for redirect.");const{isValid:r,errors:s,config:a}=C(e);r?(m(n,o,a.loader),A(n,o),function(t,e=!1,n=!1){t&&"string"==typeof t?!0!==n?e?window.open(t,"_blank"):window.location.href=t:y(`You'll be redirected to: ${t}`,3e3):console.error("WWAI-ERROR ‚ùå Invalid path specified for redirect.")}(t,!1,i),i&&(console.log("üîÑ Removing loading overlay:",n,o,a.loader),setTimeout((()=>{w(n,o,a.loader)}),1e3))):console.error("WWAI-ERROR ‚ùå Invalid flowConfig:",s)}function Ht(t,e,n,o){const{config:i,variant_config:r,product_object:s,variant_object:a}=St(e,n,t.productLabel,t.variantOptions),{optionMapping:l,reversedMapping:c}=function(t,e){if(!t||!e)return console.error("WWAI-ERROR ‚ùå Product or Variant object is missing."),null;const n=t.options,o={option1:e.option1,option2:e.option2,option3:e.option3},i={},r={};return n.forEach(((t,e)=>{const n=o[`option${e+1}`];n&&(i[t]=n,r[n]=t)})),{optionMapping:i,reversedMapping:r}}(s,a);return a&&s?function(t,e,n,o){if(!t||!e||!n)return console.error("WWAI-ERROR ‚ùå One or more required objects are missing."),null;if(1!=o.length)return console.error("WWAI-ERROR ‚ùå Expected labelKeyToKeepList to have length 1."),null;const i=t.handle,r=e.id,s=o[0];if(!i||!r)return console.error("WWAI-ERROR ‚ùå Product handle or variant ID is missing."),null;let a=`/products/${i}?variant=${r}`;return Object.entries(n).forEach((([t,e])=>{if(e.replace(/\s+/g,"-").toLowerCase().includes(s.toLowerCase())){const e=t;a+=`&${s.toLowerCase()}=${e}`}})),a}(s,a,c,o):(console.error("WWAI-ERROR ‚ùå Variant or Product Object not found during resolution."),null)}function Ft(t,e,n){console.log("üü© [Direct Add Handler]"),console.log("Section ID:",t),console.log("Product Group:",e),function(t,e,n){const o=Bt(jt(t,e).getSelectedVariant(),t,e);console.log(`üåê Triggering add to cart for Section ID: ${t} and Product Group: ${e}`),O(o,n,t,e,"local"===E().deployMode,null)}(t,e,n)}function zt(t,e,n){console.log("üîÅ [Redirect Handler]"),console.log("Section ID:",t),console.log("Product Group:",e),function(t,e,n){const o=`/products/${jt(t,e).getSelectedVariant().productLabel}`;console.log("üõ†Ô∏è Redirecting to url:",o),Vt(o,n,t,e,"local"===E().deployMode)}(t,e,n)}function Yt(t,e,n,o){console.log("üîÅ [Custom Redirect Handler]"),console.log("Section ID:",t),console.log("Product Group:",e),function(t,e,n,o){const i=o;console.log("üõ†Ô∏è Redirecting to url:",i),Vt(i,n,t,e,"local"===E().deployMode)}(t,e,n,o.custom_url)}function Jt(t,e,n,o,i){console.log("üü¶ [Overlay Handler]"),console.log("Section ID:",t),console.log("Product Group:",e),console.log("Post-Selection Action:",o,i);const r=function(t,e){const n=document.querySelector(`product-custom-collection-options-overlay-selector[section_id="${t}"][product_group="${e}"]`);return n||(console.error(`WWAI-ERROR ‚ùå No <product-custom-collection-options-overlay-selector> found for section: ${t}, group: ${e}`),null)}(t,e);if(!r)throw console.error(`WWAI-ERROR ‚ùå Cannot open overlay ‚Äî no matching element found for sectionId=${t}, productGroup=${e}`),new Error("Overlay not found. Cannot proceed with interaction.");console.log("‚úÖ Found overlay, opening now..."),r.openOverlay();let s=null;if("redirect"===o){console.log("‚è≠ Will redirect after selection.");s=function(t,e,n,o){if(t&&e)return console.log(`üåê Triggering redirect for Section ID: ${t} and Product Group: ${e}`),i=>{if(!i)return console.error("WWAI-ERROR ‚ùå Selected variant is not provided."),null;const r=Ht(i,t,e,o);console.log("üõ†Ô∏è Redirecting to url:",r);const s=E().deployMode;Vt(r,n,t,e,"local"===s)};console.error("WWAI-ERROR ‚ùå Missing sectionId or productGroup.")}(t,e,n,i.redirect_variant_options)}else"add-to-cart"===o?(console.log("‚úÖ Add to cart after selection."),s=function(t,e,n){if(t&&e)return o=>{if(!o)return console.error("WWAI-ERROR ‚ùå Selected variant is not provided."),null;const i=Bt(o,t,e);console.log(`üåê Triggering add to cart for Section ID: ${t} and Product Group: ${e}`);const r=E().deployMode;O(i,n,t,e,"local"===r,null)};console.error("WWAI-ERROR ‚ùå Missing sectionId or productGroup.")}(t,e,n)):"na"===o?console.log("‚úÖ No post-selection action required."):console.warn("‚ö†Ô∏è Unknown postSelectionAction:",o);if(s){window.__WWAI_HANDLER_REGISTRY=window.__WWAI_HANDLER_REGISTRY||{};const n=`${t}_${e}_variantChange`;if(!window.__WWAI_HANDLER_REGISTRY[n]){const o=jt(t,e);o?(o.registerHandler("variantChange",s),window.__WWAI_HANDLER_REGISTRY[n]=!0,console.log(`üîÅ Registered variantChange handler for key: ${n}`)):console.warn(`‚ö†Ô∏è Cannot register handler ‚Äî variant selector not found for sectionId=${t}, productGroup=${e}`)}}}function Xt(t,e,n,o){if(t){if(console.log("setting availability state",e,n),e)return t.disabled=!1,t.removeAttribute("data-tooltip"),void t.classList.remove("wwai-out-of-stock");o&&(!function(t,e="Out of stock"){const n=t.parentElement;if(n&&n.classList.contains("tooltip-wrapper"))return void n.setAttribute("data-tooltip",e);const o=document.createElement("div");o.classList.add("tooltip-wrapper"),o.setAttribute("data-tooltip",e),n.replaceChild(o,t),o.appendChild(t)}(t,n),t.disabled=!0,t.classList.add("wwai-out-of-stock"))}else console.log("No button found when setting availability state")}customElements.define(n.PRODUCT_GROUP.PRODUCT_MEDIA_GALLERY_FOR_GRIDS,qt);class Qt extends e{constructor(){super(),this.button=null,this.flowConfig=null,this.uxConfig=null,this.isAvailable=!0}handleSmartIntentClick(){if(!this.uxConfig||!this.uxConfig.preAddToCartFlowConfig)return void console.warn("‚ùå Missing preAddToCartFlowConfig in uxConfig inside ProductGridSmartInteractionButtonSelector");if(!this.flowConfig)return void console.warn("‚ùå Missing flowConfig inside ProductGridSmartInteractionButtonSelector");const t=this.uxConfig.preAddToCartFlowConfig,e=t.journeyType,n=t.postSelectionAction,o=t?.postSelectionActionParams||{};if("custom-redirect"!==e&&this.handleSingleVariantDirectAdd())return Ft(this.sectionId,this.productGroup,this.flowConfig),void console.log("‚úÖ Single variant product detected, proceeding with direct add for [${this.sectionId} / ${this.productGroup}]");switch(e){case"direct-add":Ft(this.sectionId,this.productGroup,this.flowConfig);break;case"redirect":zt(this.sectionId,this.productGroup,this.flowConfig);break;case"overlay":Jt(this.sectionId,this.productGroup,this.flowConfig,n,o);break;case"custom-redirect":Yt(this.sectionId,this.productGroup,this.flowConfig,o);break;default:console.warn(`‚ùå Unknown journeyType "${e}" for product group ${this.productGroup}`)}}handleSingleVariantDirectAdd(){const t=G(this.sectionId,this.productGroup,n.PRODUCT_GROUP.VARIANT);if(!t)return void console.warn(`‚ùå No variant selector found for [${this.sectionId} / ${this.productGroup}]`);const{productLabel:e,variantOptions:o}=t.getSelectedVariant(),i=yt(this.productGroup,e),r=G(this.sectionId,this.productGroup,n.PRODUCT_GROUP.COLLECTION_OPTIONS_OVERLAY);if(r){const t=r.querySelector(n.PRODUCT_GROUP.VARIANT),e=r.querySelector(n.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY);if(console.log("variantSelectorInside:",t),console.log("subscriptionSelectorInside:",e),t&&!e&&(console.log(`‚úÖ Found variant selector inside smart interaction button for [${this.sectionId} / ${this.productGroup}]`),i&&i.variants&&1===i.variants.length))return console.log(`‚úÖ Single variant product detected, proceeding with direct add for [${this.sectionId} / ${this.productGroup}]`),!0}return!1}connectedCallback(){!function(){if(document.getElementById("wwai-smart-button-styles"))return;const t=document.createElement("style");t.id="wwai-smart-button-styles",t.textContent="\n        product-grid-smart-interaction-button-selector button.wwai-out-of-stock {\n        opacity: 0.5;\n        cursor: not-allowed;\n        pointer-events: none;\n        }\n\n        product-grid-smart-interaction-button-selector .tooltip-wrapper {\n        position: relative;\n        display: inline-block;\n        }\n\n        product-grid-smart-interaction-button-selector .tooltip-wrapper::after {\n        content: attr(data-tooltip);\n        position: absolute;\n        top: -30px;\n        left: 0;\n        background-color: #333;\n        color: #fff;\n        font-size: 12px;\n        padding: 4px 8px;\n        border-radius: 4px;\n        white-space: nowrap;\n        display: none;\n        z-index: 1000;\n        }\n\n        product-grid-smart-interaction-button-selector .tooltip-wrapper:hover::after {\n        display: block;\n        }\n    ",document.head.appendChild(t)}(),this.button=this.querySelector("button"),this.button?this.button.addEventListener("click",(t=>{console.log("product-grid-smart-interaction-button-selector clicked."),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),this.handleSmartIntentClick()})):console.error("WWAI-ERROR ‚ùå No button found inside <product-grid-icon-smart-add-to-cart-button-selector>")}initUXConfig(t){super.initUXConfig(t),this.updateAvailabilityView()}updateAvailability(t,e="Out of stock"){this.isAvailable=t,this.tooltipText=e,this.updateAvailabilityView()}updateAvailabilityView(){const t=this.uxConfig?.preAddToCartFlowConfig?.journeyType;let e="direct-add"===t;"custom-redirect"!=t&&(e=e||this.handleSingleVariantDirectAdd()),Xt(this.button,this.isAvailable,this.tooltipText,e)}}customElements.define(n.PRODUCT_GROUP.GRID_SMART_INTERACTION,Qt);class Zt extends e{constructor(){super(),this.overlayBody=null,this.closeButton=null}connectedCallback(){this.overlayBody=this.querySelector("[data-wwai-collection-options-overlay-visible]"),this.overlayBody?(this.closeButton=this.querySelector("[data-wwai-collection-options-overlay-close-btn]"),this.closeButton&&this.closeButton.addEventListener("click",(()=>{this.closeOverlay()}))):console.error("WWAI-ERROR ‚ùå No overlay body found with [data-wwai-collection-options-overlay-visible]")}openOverlay(){this.setContainerVisibility(!0)}closeOverlay(){this.setContainerVisibility(!1)}setContainerVisibility(t=!0){if(!this.overlayBody)return;t?this.overlayBody.classList.add("active"):this.overlayBody.classList.remove("active");document.querySelectorAll("product-custom-collection-options-overlay-selector").forEach((t=>{if(t!==this){const e=t.querySelector("[data-wwai-collection-options-overlay-visible]");e&&e.classList.remove("active")}}))}}customElements.define(n.PRODUCT_GROUP.COLLECTION_OPTIONS_OVERLAY,Zt);class Kt extends HTMLElement{constructor(){super(),this.sectionId=this.getAttribute("section_id"),this.expectedCards=parseInt(this.getAttribute("data-expected-cards"))||0,this.equalizationReady=!1,this.expectedRoles=this.discoverRoles()}connectedCallback(){console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ connectedCallback triggered`),this.checkIfCardsAreReady("init"),this.initMutationObserver(),this.initIntersectionObserver(),this.initResizeListeners(),this.initResizeObserver(),this.initCleanupHandler()}checkIfCardsAreReady(t="manual"){const e=this.querySelectorAll("[data-wwai-container-card]"),n=Array.from(e).filter((t=>{const e=t.querySelectorAll("[data-wwai-container-card-role]");return!(e.length<this.expectedRoles.length)&&Array.from(e).some((t=>""!==t.innerHTML.trim()))}));console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] üïµÔ∏è ${t} check: found ${e.length} cards, ${n.length} with roles, expecting ${this.expectedCards}`),e.length>=this.expectedCards&&n.length>=this.expectedCards&&this.expectedCards>0?(console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] üü¢ Cards ready, triggering equalize via: ${t}`),this.equalizationReady=!0,this.equalize(t),this.mutationObserver&&this.mutationObserver.disconnect()):console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚è≥ Waiting for cards... (${t})`)}initMutationObserver(){console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] üß¨ initMutationObserver set up`),this.mutationObserver=new MutationObserver((()=>{console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ mutationObserver triggered`),this.checkIfCardsAreReady("mutation-observer")})),this.mutationObserver.observe(this,{childList:!0,subtree:!0})}initIntersectionObserver(){this.intersectionObserver=new IntersectionObserver((t=>{console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ intersectionObserver triggered`),t.some((t=>t.isIntersecting))&&this.equalizationReady&&(console.info(`[${this.sectionId}] üì° Section entered viewport, re-running equalize`),this.equalize("intersection"))}),{threshold:.1}),this.intersectionObserver.observe(this)}initResizeListeners(){window.addEventListener("resize",(()=>{console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ resizeListener triggered`),this.equalizationReady&&this.debouncedEqualize("resize")})),window.addEventListener("orientationchange",(()=>{console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ orientationchangeListener triggered`),this.equalizationReady&&this.equalize("orientationchange")}))}initResizeObserver(){this.resizeObserver=new ResizeObserver((()=>{console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ resizeObserver triggered`),this.equalizationReady&&this.equalize("resize-observer")})),this.resizeObserver.observe(this)}initCleanupHandler(){this.disconnectedCallback=()=>{console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ disconnectedCallback triggered`),window.removeEventListener("resize",this.debouncedEqualize),window.removeEventListener("orientationchange",this.equalize),this.resizeObserver.disconnect(),this.mutationObserver.disconnect()}}debouncedEqualize(t="resize"){clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout((()=>this.equalize(t)),300)}getCards(){return this.querySelectorAll("[data-wwai-container-card]")}discoverRoles(){const t=this.querySelector("[data-wwai-container-card]");return t?Array.from(t.querySelectorAll("[data-wwai-container-card-role]")).map((t=>t.getAttribute("data-wwai-container-card-role"))).filter((t=>!!t)):[]}validateCards(t){this.getCards().forEach((e=>{t.forEach((t=>{e.querySelector(`[data-wwai-container-card-role="${t}"]`)||(E().heightEqualizeLogging&&console.log(`"[${this.sectionId}]"‚ùå Missing role "${t}" in card with label:`,e.dataset.wwaiContainerCardLabel),E().heightEqualizeLogging&&console.log(e))}))}))}generateEqualizedHeightMap(){const t=this.getCards(),e=this.discoverRoles(),n={},o=new Map;t.forEach((t=>{e.forEach((e=>{const n=t.querySelector(`[data-wwai-container-card-role="${e}"]`);if(n){const t=n.offsetHeight;o.set(n,t),n.style.minHeight=""}}))})),t.forEach((t=>{const e=Math.round(t.getBoundingClientRect().top);n[e]||(n[e]=[]),n[e].push(t)}));const i=Object.keys(n).map(Number).sort(((t,e)=>t-e)),r=[];return i.forEach(((t,i)=>{const s=n[t],a={};e.forEach((t=>{let e=0;s.forEach((n=>{const i=n.querySelector(`[data-wwai-container-card-role="${t}"]`);if(i){let n=i.offsetHeight;n<5&&o.has(i)&&(n=o.get(i),E().heightEqualizeLogging&&console.log(`[${this.sectionId}] ‚ö†Ô∏è Using fallback height for role "${t}" due to suspect value: ${n}px`)),n>5&&(e=Math.max(e,n+1))}})),a[t]=e})),r.push({rowIndex:i,heights:a})})),{section_id:this.sectionId,roles:e,rowCount:r.length,rows:r}}fillMissingHeights(t){const e=t.roles;let n={};return t.rows.forEach((t=>{e.forEach((e=>{const o=t.heights[e];o&&0!==o?n[e]=t.heights[e]:t.heights[e]=n[e]||0}))})),t}applyHeightMap(t){const e=this.getCards(),n=t.roles;t=this.fillMissingHeights(t);const o={};e.forEach((t=>{const e=Math.round(t.getBoundingClientRect().top);o[e]||(o[e]=[]),o[e].push(t)}));const i=Object.keys(o).map(Number).sort(((t,e)=>t-e)).map((t=>o[t]));t.rows.forEach(((t,e)=>{const o=i[e];o&&n.forEach((e=>{const n=t.heights[e];o.forEach((t=>{const o=t.querySelector(`[data-wwai-container-card-role="${e}"]`);o&&(o.style.minHeight=`${n}px`)}))}))}))}equalize(t="unknown"){console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ equalize triggered with height map by: ${t}`),E().heightEqualizeLogging&&console.log(`[${this.sectionId}] ‚ö° Equalize triggered with height map by: ${t}`);const e=this.getCards(),n=this.discoverRoles();if(!e.length||!n.length)return;this.validateCards(n);const o=this.generateEqualizedHeightMap();this.applyHeightMap(o)}}customElements.define(n.OTHER.PRODUCT_GRID_HEIGHT_EQUALIZER,Kt),window.generateAllEqualizedHeightMapsForDevice=function(){const t=document.querySelectorAll("product-grid-height-equalizer-selector"),e={};t.forEach((t=>{if("function"==typeof t.generateEqualizedHeightMap){const n=t.generateEqualizedHeightMap(),o=n.section_id||"",i=o.split("__")[1]||o;e[i]={...n,section_id:i}}}));const n=window.innerWidth<768,o=n?"CACHED_HEIGHTS_MOBILE":"CACHED_HEIGHTS_DESKTOP";window[o]=e;const i=`<script>\nwindow.${o} = ${JSON.stringify(e,null,2)};\n<\/script>`;return console.log(`‚úÖ Cached height mappings generated for ${n?"mobile":"desktop"}.\nCopy-paste this into your config:`),console.log(i),e},window.applyCachedHeightsOnLoad=function(){const t=window.innerWidth<768,e=t?window.CACHED_HEIGHTS_MOBILE:window.CACHED_HEIGHTS_DESKTOP;if(!e)return void console.warn(`[Equalizer] No cached heights found for ${t?"mobile":"desktop"}. Skipping initial height application.`);document.querySelectorAll("product-grid-height-equalizer-selector").forEach((t=>{const n=t.sectionId,o=n.includes("__")?n.split("__")[1]:n.split("--")[1]||n,i=e[o];i&&"function"==typeof t.applyHeightMap&&(t.applyHeightMap(i),E().heightEqualizeLogging&&console.log(`[${o}] üöÄ Applied cached height map from config.`))}))};class te extends e{constructor(){super()}connectedCallback(){}updateTitle(t){this.querySelectorAll("[data-wwai-product-variant-title]").forEach((e=>{e.textContent=t}))}}customElements.define(n.PRODUCT_GROUP.TITLE,te);const ee="data-wwai-product-label",ne="data-wwai-product-variant-option1-label",oe="data-wwai-product-variant-option2-label",ie="data-wwai-product-variant-option3-label";class re extends HTMLElement{constructor(){super(),this.sectionId=this.getAttribute("section_id"),this.productGroup=this.getAttribute("product_group")}connectedCallback(){this.attachLinkListeners()}triggerVariantChange(t,e){const o=G(this.sectionId,this.productGroup,n.PRODUCT_GROUP.VARIANT);o?(o.setSelectedProductAndOptions(t,e),o.handleVariantUpdate()):console.warn("‚ö†Ô∏è No variant selector found for section/group:",this.sectionId,this.productGroup)}attachLinkListeners(){Array.from(this.querySelectorAll("a")).filter((t=>{const e=t.hasAttribute(ee),n=t.hasAttribute(ne),o=t.hasAttribute(oe),i=t.hasAttribute(ie);return e&&(n||o||i)})).forEach((t=>{t.addEventListener("click",(e=>{e.preventDefault();const n=t.getAttribute(ee),o=t.getAttribute(ne),i=t.getAttribute(oe),r=t.getAttribute(ie),s={};null!==o&&(s.option1=o),null!==i&&(s.option2=i),null!==r&&(s.option3=r),console.log("üîÅ Triggering variant change:",{productLabel:n,options:s}),this.triggerVariantChange(n,s)}))}))}}customElements.define(n.PRODUCT_GROUP.VARIANT_TRIGGER,re);const se="data-wwai-product-variant-option-type",ae="data-wwai-product-label",le="data-wwai-purchase-type",ce="product",de="product_variant",ue={SUBSCRIPTION:"subscription",ONE_TIME:"one_time"},pe="combo_change";function ge(t,e,o){if(!o(n.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY_STATIC))return;L(t,e,n.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY_STATIC).forEach((n=>{!function(t,e,n){const o=t.productLabel,i=t.variantOptions,{config:r,variant_config:s,product_object:a,variant_object:l}=St(e,n,o,i);if(null==l)throw new Error("WWAI-ERROR ‚ùå Variant object is undefined for "+o+" "+i);const c=Gt({productObject:a,variantObject:l,variantConfig:s,productGroup:n,productLabel:o,config:r,purchaseType:ue.SUBSCRIPTION});t.updateSubscriptionOptionsForStaticUse(c.sellingPlans)}(n,t,e)}))}function fe(t,e,n){const o=t.productLabel,i=t.variantOptions,r=t.priceLabel,{config:s,variant_config:a,product_object:l,variant_object:c}=St(e,n,o,i);if(null==c)throw new Error("WWAI-ERROR ‚ùå Variant object is undefined for "+o+" "+i);!function(t,e,n,o,i){const r=e.oneTimePrice,s=e.sellingPlanDetails.sellingPlanPriceObject;if("onetime"==n)t.updatePrice(r);else{if("subscription"!=n)throw new Error("WWAI-ERROR ‚ùå Invalid price label:"+n+" for sectionId:"+o+" productGroup:"+i);t.updatePrice(s)}}(t,Gt({productObject:l,variantObject:c,variantConfig:a,productGroup:n,productLabel:o,config:s,purchaseType:ue.SUBSCRIPTION}),r,e,n)}function he({sectionId:t,productGroup:e}){const o=M(t,e),i=t=>o.includes(t);i(n.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO)?(ge(t,e,i),function(t,e,o){if(!o(n.PRODUCT_GROUP.PRICE_STATIC))return;L(t,e,n.PRODUCT_GROUP.PRICE_STATIC).forEach((n=>{fe(n,t,e)}))}(t,e,i)):console.error("WWAI-ERROR ‚ùå Variant purchase type combo selector not found for sectionId:",t,"productGroup:",e)}function be({sectionId:t,productGroup:e,productLabel:o,variantOptions:i,productObject:r,variantObject:s,variantConfig:a,config:l,purchaseType:c=null,setVariantAndSubscriptionSelection:d=!0}){const u=M(t,e);!function(t,e,o){if(!o.includes(n.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO))throw console.error("WWAI-ERROR ‚ùå Variant purchase type combo selector not found for sectionId:",t,"productGroup:",e),new Error("WWAI-ERROR ‚ùå Variant purchase type combo selector not found")}(t,e,u),function(t,e,o){let i=[n.PRODUCT_GROUP.ADD_TO_CART_BUTTON,n.PRODUCT_GROUP.SUBMIT_INTERCEPTOR,n.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY_STATIC,n.PRODUCT_GROUP.PRICE_STATIC].filter((t=>!o.includes(t)));if(i=i.filter((t=>void 0!==t)),i.length>0)throw new Error("WWAI-ERROR ‚ùå Unsupported Selectors for sectionId:"+t+" productGroup:"+e+" selectors_not_in_allowed_list:"+i.join(", "))}(t,e,u);const p=function(t,e,n,o){if(null!=t){if(!Object.values(ue).includes(t))throw new Error("WWAI-ERROR ‚ùå Invalid purchase type:"+t+" for sectionId:"+n+" productGroup:"+o);return t}if(e&&e.variantDispatchConfig&&e.variantDispatchConfig.purchaseType){const t=e.variantDispatchConfig.purchaseType;if(!Object.values(ue).includes(t))throw new Error("WWAI-ERROR ‚ùå Invalid purchase type:"+t+" for sectionId:"+n+" productGroup:"+o);return t}return ue.ONE_TIME}(c,l,t,e);d&&function({sectionId:t,productGroup:e,productLabel:o,variantOptions:i,purchaseType:r}){const s=G(t,e,n.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO);if(!s)return;if("function"!=typeof s.setSelectedCombo)return void console.error("WWAI-ERROR ‚ùå <product-variant-purchase-type-combo-selector> is missing setSelectedCombo()");s.setSelectedCombo({productLabel:o,variantOptions:i,purchaseType:r})?console.log(`‚úÖ Default variant set for [${t} / ${e}] ‚Üí ${o}`,i):console.warn(`‚ö†Ô∏è Failed to set default product/options for section="${t}", group="${e}"`)}({sectionId:t,productGroup:e,productLabel:o,variantOptions:i,purchaseType:p});const g=Gt({productObject:r,variantObject:s,variantConfig:a,productGroup:e,productLabel:o,config:l,purchaseType:c});!function({sectionId:t,productGroup:e,addToCartPayload:o}){const i=L(t,e,n.PRODUCT_GROUP.ADD_TO_CART);i&&0!==i.length?i.forEach(((t,e)=>{t&&"function"==typeof t.updateAddToCartForm?t.updateAddToCartForm(o):console.error(`WWAI-ERROR ‚ùå AddToCart selector at index ${e} is missing .updateAddToCartForm()`)})):console.warn(`WWAI ‚ö†Ô∏è No <product-custom-add-to-cart-button-selector> found for [${t} / ${e}]`)}({sectionId:t,productGroup:e,addToCartPayload:g.addToCartPayload});var f;f=n.PRODUCT_GROUP.CAROUSEL,u.includes(f)&&ot({sectionId:t,productGroup:e,media:g.media,moveToIndex:g.mediaIndex})}class me extends e{constructor(){super(),this.inputs=[],this.handlers={},this.scope=this.getAttribute("wwai-scope")||null,this.product_helper_handle=this.getAttribute("product-helper-handle")||null,this.debounceTimer=null}connectedCallback(){this.initInputs(),this.bindEvents(),this.ensureAutocompleteOff()}initInputs(){this.inputs=this.querySelectorAll('input[type="radio"]')}bindEvents(){const t=this.debouncedComboSelection.bind(this);this.inputs.forEach((e=>{e.addEventListener("change",t),e.addEventListener("click",t)}))}ensureAutocompleteOff(){ct(this.inputs)}debouncedComboSelection(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout((()=>{this.handleComboSelection()}),10)}handleComboSelection(){console.log("üîç Combo Selection Triggered");const t=this.getSelectedCombo();this.setSelectedCombo(t),function(t,e,n,o,i){const{config:r,variant_config:s,product_object:a,variant_object:l}=St(t,e,n,o);a&&l?be({sectionId:t,productGroup:e,productLabel:n,variantOptions:o,productObject:a,variantObject:l,variantConfig:s,config:r,purchaseType:i,setVariantAndSubscriptionSelection:!1}):console.error(`WWAI-ERROR ‚ùå Unable to reinitialize product group for ${e}`)}(this.sectionId,this.productGroup,t.productLabel,t.variantOptions,t.purchaseType),this.triggerHandler(pe,t)}registerHandler(t,e){t&&"function"==typeof e&&(this.handlers[t]=this.handlers[t]||[],this.handlers[t].push(e))}triggerHandler(t,e){(this.handlers?.[t]||[]).forEach((n=>{try{n(e)}catch(e){console.error(`WWAI ‚ùå Error in handler for type "${t}":`,e)}}))}getProductRadiosForPurchaseType(t){return[...this.inputs].filter((e=>e.getAttribute(se)===ce&&e.getAttribute(le)===t))}getVariantRadiosForPurchaseType(t){return[...this.inputs].filter((e=>e.getAttribute(se)===de&&e.getAttribute(le)===t))}getSelectedCombo(){const t=[...this.inputs].find((t=>t.checked&&t.getAttribute(se)===ce));if(!t)return null;const e=t.getAttribute(ae),n=t.getAttribute(le),o=[...this.inputs].filter((t=>t.getAttribute(se)===de&&t.getAttribute(ae)===e&&t.getAttribute(le)===n)),i={};return o.forEach((t=>{const e=t.getAttribute("data-wwai-product-variant-label-level"),n=t.getAttribute("data-wwai-product-variant-label");e&&n&&(i[e]=n)})),{productLabel:e,variantOptions:i,purchaseType:n}}setSelectedCombo({productLabel:t,variantOptions:e,purchaseType:n}){const o=this.getProductRadiosForPurchaseType(n),i=this.getVariantRadiosForPurchaseType(n);if(!o.length)return console.warn(`‚ö†Ô∏è No product radio inputs found in <product-variant-purchase-type-combo-selector> [${this.sectionId}].`),!1;if(!pt(o,t,this.sectionId))return console.warn(`‚ö†Ô∏è Required product not found in <product-variant-purchase-type-combo-selector> [${this.sectionId}].`),!1;const r=ft(t,gt(i,t),e);if(!r)return console.warn(`‚ö†Ô∏è Required variant levels not present in <product-variant-purchase-type-combo-selector> [${this.sectionId}].`),!1;const s=ht(i,t,e),a=n==ue.SUBSCRIPTION?ue.ONE_TIME:ue.SUBSCRIPTION,l=this.getProductRadiosForPurchaseType(a),c=this.getVariantRadiosForPurchaseType(a);return l.forEach((t=>{t.checked=!1})),c.forEach((t=>{t.checked=!1})),r&&s}}customElements.define(n.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO,me);const we="data-wwai-variant-set-tab",_e="data-wwai-product-label",ye="data-wwai-product-variant-option-type",ve="product",Ce="product_variant",Ae="variant_change";class Oe extends e{constructor(){super(),this.allInputs=[],this.setTabs=[],this.activeSet=null,this.handlers={},this.debounceTimer=null}connectedCallback(){this.init()}init(){this.allInputs=[...this.querySelectorAll(`input[type="radio"]:not([${we}])`)],this.setTabs=[...this.querySelectorAll(`[${we}]`)],this.bindSetTabs(),this.activateSet(this.setTabs[1]?.getAttribute(we))}bindSetTabs(){this.setTabs.forEach((t=>{const e=t.getAttribute(we);t.addEventListener("click",(()=>{this.activateSet(e)}))}))}activateSet(t){this.activeSet=t,this.setTabs.forEach((e=>{e.checked=e.getAttribute(we)===t})),console.log("üîç Activating Set:",t),console.log("üîç Active Set:",this.activeSet),console.log("üîç Set Tabs:",this.setTabs),console.log("üîç Set Tabs Checked:",this.setTabs.map((t=>t.checked))),this.bindInputEvents()}bindInputEvents(){console.log("üîç Binding Input Events"),console.log("üîç All Inputs:",this.allInputs),this.allInputs.forEach((t=>{t.removeEventListener("change",this.handleVariantChangeBound),t.removeEventListener("click",this.handleVariantChangeBound)})),this.handleVariantChangeBound=this.handleVariantChange.bind(this);this.getActiveInputs().forEach((t=>{t.addEventListener("change",this.handleVariantChangeBound),t.addEventListener("click",this.handleVariantChangeBound)}))}getActiveInputs(){return this.allInputs.filter((t=>t.getAttribute("data-wwai-variant-set")===this.activeSet))}handleVariantChange(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout((()=>{const t=[...this.getActiveInputs()].find((t=>t.checked&&t.getAttribute(ye)===ve));if(console.log("üîç Product Input:",t),!t)return null;const e=t.getAttribute(_e),n=[...this.getActiveInputs()].find((t=>t.getAttribute(ye)===Ce&&t.getAttribute(_e)===e&&t.checked)),o=n?.getAttribute("data-wwai-product-variant-label")||null,i=n?.getAttribute("data-wwai-product-variant-label-level")||null,r={productLabel:e,variantLabel:o,variantLabelLevel:i,setName:this.activeSet};console.group("[WWAI] üß† Variant Change Triggered"),console.log("üîç Product Label:",r.productLabel),console.log("üè∑Ô∏è Variant Label:",r.variantLabel),console.log("üî¢ Variant Level:",r.variantLabelLevel),console.log("üî¢ Set Name:",r.setName),console.groupEnd(),this.triggerHandler(Ae,r)}),10)}registerHandler(t,e){t&&"function"==typeof e&&(this.handlers[t]=this.handlers[t]||[],this.handlers[t].push(e))}triggerHandler(t,e){(this.handlers?.[t]||[]).forEach((n=>{try{n(e)}catch(e){console.error(`WWAI ‚ùå Handler error for type "${t}"`,e)}}))}}customElements.define(n.PRODUCT_GROUP.VARIANT_SELECTOR_WITH_SETS,Oe);class Ie extends it{constructor(){super(),this.productLabel=null,this.variantOptions=null}getElementName(){return"static subscription frequency selector"}connectedCallback(){super.connectedCallback(),this.init()}init(){this.productLabel=this.getAttribute(`${ee}`),this.variantOptions=this.getDefinedVariantOptions(),this.productLabel&&this.variantOptions&&0!==Object.keys(this.variantOptions).length?console.log("üîç Static Subscription Frequency Selector Initialized:",{productLabel:this.productLabel,variantOptions:this.variantOptions}):console.warn("WWAI ‚ö†Ô∏è Missing productLabel or variantOptions on <product-static-subscription-frequency-selector>.")}getDefinedVariantOptions(){const t=this.getAttribute(ne),e=this.getAttribute(oe),n=this.getAttribute(ie),o={};return t&&(o.option1=t),e&&(o.option2=e),n&&(o.option3=n),console.log("üîç Defined Variant Options:",{option1:t||"undefined",option2:e||"undefined",option3:n||"undefined",result:o}),o}handleSubscriptionPlanChange(t){console.log("üîç To be Implemented: Static Subscription Frequency Selector Plan Changed:",t)}updateSubscriptionOptionsForStaticUse(t){t&&Array.isArray(t)?this.updateSubscriptionOptions(t):console.warn(`WWAI ‚ö†Ô∏è No valid subscription options provided for ${this.productLabel} / ${this.variantOptions}`)}}customElements.define(n.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY_STATIC,Ie);class Ee extends h{constructor(){super(),this.priceLabel=null,this.productLabel=null,this.variantOptions=null}connectedCallback(){super.connectedCallback(),this.init()}init(){this.productLabel=this.getAttribute(`${ee}`),this.priceLabel=this.getAttribute("data-wwai-product-price-label"),this.productLabel&&this.priceLabel?(this.variantOptions=this.getDefinedVariantOptions(),0!==Object.keys(this.variantOptions).length?console.log("üîç Static Price Selector Initialized:",{productLabel:this.productLabel,priceLabel:this.priceLabel,variantOptions:this.variantOptions}):console.warn("WWAI ‚ö†Ô∏è Missing variantOptions on <product-static-price-selector>.")):console.warn("WWAI ‚ö†Ô∏è Missing productLabel or variantLabel or priceLabel on <product-static-price-selector>.")}getDefinedVariantOptions(){const t=this.getAttribute(ne),e=this.getAttribute(oe),n=this.getAttribute(ie),o={};return t&&(o.option1=t),e&&(o.option2=e),n&&(o.option3=n),console.log("üîç Defined Variant Options:",{option1:t||"undefined",option2:e||"undefined",option3:n||"undefined",result:o}),o}updatePrice(t){t?this.updatePrices(t,this.priceLabel):console.warn(`WWAI ‚ö†Ô∏è No pricing data provided for ${this.productLabel}`)}}function Re(t){const e=document.getElementById(t);if(!e)return console.warn(`‚ö†Ô∏è Script with ID "${t}" not found`),null;try{return JSON.parse(e.textContent)}catch(e){return console.error(`‚ùå Failed to parse JSON from script#${t}:`,e),null}}customElements.define(n.PRODUCT_GROUP.PRICE_STATIC,Ee);const Te={[n.PRODUCT_GROUP.VARIANT]:Mt,[n.PRODUCT_GROUP.PRICE]:h,[n.PRODUCT_GROUP.PURCHASE_TYPE]:H,[n.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY]:it,[n.PRODUCT_GROUP.VARIANT_CUSTOM_LABEL]:lt,[n.PRODUCT_GROUP.CAROUSEL]:l,[n.PRODUCT_GROUP.ADD_TO_CART]:r,[n.PRODUCT_GROUP.SUBMIT_INTERCEPTOR]:R,[n.PRODUCT_GROUP.PRODUCT_MEDIA_GALLERY_FOR_GRIDS]:qt,[n.PRODUCT_GROUP.GRID_SMART_INTERACTION]:Qt,[n.PRODUCT_GROUP.COLLECTION_OPTIONS_OVERLAY]:Zt,[n.PRODUCT_GROUP.TITLE]:te,[n.PRODUCT_GROUP.VARIANT_TRIGGER]:re,[n.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO]:me,[n.PRODUCT_GROUP.VARIANT_SELECTOR_WITH_SETS]:Oe,[n.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY_STATIC]:Ie,[n.PRODUCT_GROUP.PRICE_STATIC]:Ee,[n.OTHER.PRODUCT_GRID_HEIGHT_EQUALIZER]:Kt};"prod"!==E().MODE&&function(){const t=[];for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)){const o=n[e];t.push(...Object.values(o))}let e=!0;const o=[];for(const n of t)n in Te||(o.push(n),e=!1);e?console.log("ELEMENT_CLASS_REGISTRY Validation Passed: All defined selectors are registered."):console.error("WWAI-ERROR ELEMENT_CLASS_REGISTRY Validation Failed: The following selectors from `constants/selector-constants.js` are NOT registered:",o)}();const Se={"product-purchase-type-selector":40,"product-subscription-frequency-selector":30,"product-variant-custom-labeled-text":20,"product-custom-price-selector":10,"product-custom-submit-interceptor":10};function Pe(t){const e=t.dataset.debugId;if(!e)return;const n=document.querySelector(`[data-debug-for="${e}"]`);n&&n.remove()}function xe(t,e="green"){const n=t.tagName.toLowerCase(),o=Se[n]||0;if(document.querySelector(`[data-debug-for="${t.dataset.debugId}"]`))return;const i=function(t,e=32){const n=t.tagName.toLowerCase(),o=Se[n]||e,i=Array.from(t.querySelectorAll("*")).filter((t=>null!==t.offsetParent));if(0===i.length)return null;let r=1/0,s=1/0,a=-1/0,l=-1/0;if(i.forEach((t=>{const e=t.getBoundingClientRect();0!==e.width&&0!==e.height&&(r=Math.min(r,e.top),s=Math.min(s,e.left),a=Math.max(a,e.bottom),l=Math.max(l,e.right))})),r===1/0)return null;const c=window.scrollY,d=window.scrollX,u=document.documentElement.clientWidth,p=Math.max(0,s+d-o);return{top:Math.max(0,r+c-o),left:p,width:Math.min(u,l+d+o)-p,height:a-r+2*o}}(t);if(!i)return;const r=t.dataset.debugId||`${n}-debug-${Date.now()}`;t.dataset.debugId=r;const s=document.createElement("div");s.setAttribute("data-debug-for",r),s.style.position="absolute",s.style.left=`${i.left}px`,s.style.top=`${i.top+o}px`,s.style.width=`${i.width}px`,s.style.height=`${i.height}px`,s.style.border="2px dashed "+e,s.style.zIndex=9998,s.style.pointerEvents="none";const a=document.createElement("div");a.style.position="absolute",a.style.top="4px",a.style.right="4px",a.style.width="12px",a.style.height="12px",a.style.borderRadius="50%",a.style.zIndex="10001",a.style.cursor="pointer",a.style.pointerEvents="auto";const l=t.getAttribute("debug_status")||"none";a.style.background={valid:"limegreen",warning:"orange",error:"red"}[l]||"gray";const c=document.createElement("div");c.style.position="absolute",c.style.padding="10px 14px",c.style.background="#2c2c2c",c.style.color="#fff",c.style.fontSize="13px",c.style.borderRadius="6px",c.style.zIndex="10002",c.style.display="none",c.style.width="360px",c.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)",c.style.lineHeight="1.5",c.style.whiteSpace="normal",c.style.wordBreak="break-word",c.style.overflowWrap="break-word",c.style.border="1px solid #444";const d=document.createElement("div");d.textContent=`<${n}>`,d.style.fontWeight="bold",d.style.fontSize="14px",d.style.marginBottom="8px",c.appendChild(d);const u=document.createElement("ul");u.style.margin=0,u.style.paddingLeft="18px",u.style.listStyle="disc",c.appendChild(u),a.addEventListener("mouseenter",(()=>{const e=t.getAttribute("debug_message")||"[]";let n=[];try{n=JSON.parse(e)}catch(t){n=[e]}Array.isArray(n)&&0!==n.length||(n=["valid"]),u.innerHTML="",n.forEach((t=>{const e=document.createElement("li");e.textContent=t,e.style.marginBottom="8px",e.style.paddingLeft="2px",u.appendChild(e)}));const{right:o}=a.getBoundingClientRect(),i=o+320>window.innerWidth;c.style.left=i?"-320px":"20px",c.style.top="0px",c.style.display="block"})),a.addEventListener("mouseleave",(()=>{c.style.display="none"})),a.appendChild(c),s.appendChild(a),document.body.appendChild(s)}const $e="[data-wwai-media-container]",De="[data-wwai-media-slide]",Ue="data-wwai-carousel-media-id";function Ne(){}function We(){}function Le(){}function Ge(t){return 1===t.length&&1===t[0].length&&"Default Title"===t[0][0]}function ke(t,e){return Array.isArray(t)&&1===t.length&&e&&1===Object.keys(e).length&&Array.isArray(e.option1)&&1===e.option1.length&&"__wwai_first__"===e.option1[0]}function Me(t){const e=t.querySelectorAll('input[type="radio"]'),n=[];if(0===e.length)return{isValid:!1,messages:["‚ùå No variant input elements (radio buttons) found in selector."]};e.forEach((t=>{const e=function(t){const e=[],n=t.getAttribute(Y),o=t.getAttribute(J),i=t.getAttribute(X);return"product"!==n&&"product_variant"!==n&&e.push(`Invalid type: "${n}". Expected "product" or "product_variant".`),o||e.push(`Missing required attribute: ${J}.`),"product_variant"!==n||i||e.push(`Missing ${X} for product_variant input.`),{valid:0===e.length,issues:e}}(t);e.valid||n.push({input:t,debug:qe(t),issues:e.issues})}));const o=n.flatMap((({debug:t,issues:e})=>e.map((e=>`${t} : ${e}`))));return{isValid:0===n.length,messages:o}}function qe(t){return`type="${t.getAttribute(Y)||"(no type)"}", product="${t.getAttribute(J)||"(no product)"}", variant="${t.getAttribute(X)||"(no variant)"}"`}function je(t,e=!1){const n=Me(t),{inconsistencies:o,messages:i}=function(t){t.getAttribute("section_id");const e=t.querySelectorAll('input[type="radio"]'),n={};e.forEach((t=>{const e=t.getAttribute("name"),o=t.getAttribute(Y);e&&o&&(n[e]=n[e]||new Set,n[e].add(o))}));const o=[],i=[];return Object.entries(n).forEach((([t,n])=>{if(n.size>1){const r=`Inconsistent option types in radio group: "${t}" (found types: ${Array.from(n).join(", ")}).`;i.push(r);const s=Array.from(e).filter((e=>e.getAttribute("name")===t));o.push({groupName:t,types:Array.from(n),inputs:s,message:r})}})),{inconsistencies:o,messages:i}}(t),{conflicts:r,messages:s}=function(t){const e=t.getAttribute("section_id")||"(unknown)",n=t.querySelectorAll('input[type="radio"]'),o=[],i=[];return n.forEach((n=>{const r=n.getAttribute("name");r&&document.querySelectorAll(`input[type="radio"][name="${r}"]`).forEach((s=>{if(!t.contains(s)){const t=`Conflict: radio group name "${r}" is used both inside (seciton id="${e}") and outside of this selector too.`;o.push({name:r,input:n,conflictingElement:s,message:t}),i.push(t)}}))})),{conflicts:o,messages:i}}(t),a=[...n.messages,...i];let l=!n.isValid,c=i.length>0;a.push(...s),r.length>0&&(l=!0);const d=l?"error":c?"warning":"valid";return e&&console.log("messages:",a),{status:d,messages:a}}function Be(t){const e=bt(t);if(!t?.productGroup)return void console.warn("[WWAI] ‚ö†Ô∏è Product group not found for selector element.");const n=function(t,e){const n=[];for(const o of e.productLabels){const i=yt(t,o);if(!i||!i.variants||0===i.variants.length){n.push(`Product "${o}" has no variants in product data.`);continue}const r=i.variants.map((t=>[t.option1,t.option2,t.option3].filter(Boolean).map((t=>t.trim()))));if(Ge(r)){console.warn(`Skipping exhaustive check for product "${o}" ‚Äî single default variant.`);continue}const s=e.variants[o];if(!s||0===Object.keys(s).length){n.push(`Product "${o}" has no variant options defined in html hierarchy.`);continue}const a=s.option1||[],l=s.option2||[null],c=s.option3||[null];for(const t of a)for(const e of l)for(const i of c){const a=[t,e,i].filter(Boolean).map((t=>t.trim()));r.some((t=>a.length===t.length&&a.every(((e,n)=>e===t[n]))))||(ke(r,s)?console.warn("WWAI-WARN: Single variant option with special label __wwai_first__ detected. Skipping mismatch push."):n.push(`Variant [${a.join(", ")}] missing for product "${o}" in product data.`))}}return n}(t.productGroup,e);console.log("mismatches:",n);let o=[];try{const e=t.getAttribute("debug_message");o=e?JSON.parse(e):[]}catch(t){o=[]}const i=(n||[]).map((t=>`Product Connect Error: ${t}`)),r=[...o,...i];t.setAttribute("debug_message",JSON.stringify(r))}function Ve(t,{beforeCount:e,afterCount:n,discountCount:o},i){const r=[];let s=!1,a=!1;(e>1||n>1)&&(s=!0,r.push(`Label "${t}" has multiple elements: ${[e>1?`beforePrice (${e})`:null,n>1?`afterPrice (${n})`:null].filter(Boolean).join(", ")}`)),0===e&&0===n?(s=!0,r.push(`Label "${t}" is missing both beforePrice and afterPrice`)):0!==e&&0!==n||(a=!0,r.push(`Label "${t}" is missing: ${[0===e?"beforePrice":null,0===n?"afterPrice":null].filter(Boolean).join(", ")}`)),o>1&&(s=!0,r.push(`Label "${t}" has multiple discountPercentage elements (${o})`));const l=function(t,e){const n=[];let o=!1;const i=[{type:"before",el:d.BEFORE,wrapper:u},{type:"after",el:d.AFTER,wrapper:p},{type:"discount",el:d.DISCOUNT,wrapper:g}];for(const{type:r,el:s,wrapper:a}of i){const i=e.querySelector(`[${s}][${c}="${t}"]`);i&&!i.closest(`[${a}]`)&&(o=!0,n.push(`Label "${t}" has ${r} element not inside [${a}]`))}return{hasWarning:o,messages:n}}(t,i);return r.push(...l.messages),l.hasWarning&&(a=!0),{hasError:s,hasWarning:a,messages:r}}function He(t,e="<product-custom-price-selector>"){const n=t.querySelectorAll(`[${c}], [${d.BEFORE}], [${d.AFTER}], [${d.DISCOUNT}]`),o=t.querySelectorAll(`[${c}]`),i=[],r=function(t,e="<product-custom-price-selector>"){const n=[];return t.forEach(((t,o)=>{const i=t.getAttribute(c)?.trim();if(!i){const i=t.outerHTML.split("\n")[0].trim().slice(0,100);n.push(`Element ${o} inside ${e} is missing required ${c}: ${i}...`)}})),n}(n,e),s=r.length>0;if(i.push(...r),!o.length)return i.push(`No price-labeled elements found inside ${e}`),{status:"none",messages:i};const a=function(t){const e={};return t.forEach((t=>{const n=t.getAttribute(c)?.trim();n&&(e[n]||(e[n]={beforeCount:0,afterCount:0,discountCount:0}),t.hasAttribute(d.BEFORE)&&(e[n].beforeCount+=1),t.hasAttribute(d.AFTER)&&(e[n].afterCount+=1),t.hasAttribute(d.DISCOUNT)&&(e[n].discountCount+=1))})),e}(o),{messages:l,status:u}=function(t,e){const n=[];let o=!1,i=!1;for(const[r,s]of Object.entries(t)){const t=Ve(r,s,e);n.push(...t.messages),t.hasError&&(o=!0),t.hasWarning&&(i=!0)}return{status:o?"error":i?"warning":"valid",messages:n}}(a,t);i.push(...l);return{status:s?"error":u,messages:i}}function Fe(t,e,n){const{beforeCount:o,afterCount:i,discountCount:r}=e,s=[];let a=!1,l=!1;(o>1||i>1)&&(a=!0,s.push(`Label "${t}" has multiple elements: ${[o>1?`beforePrice (${o})`:null,i>1?`afterPrice (${i})`:null].filter(Boolean).join(", ")}`)),0===o&&0===i?(a=!0,s.push(`Label "${t}" is missing both beforePrice and afterPrice`)):0!==o&&0!==i||(l=!0,s.push(`Label "${t}" is missing: ${[0===o?"beforePrice":null,0===i?"afterPrice":null].filter(Boolean).join(", ")}`)),r>1&&(a=!0,s.push(`Label "${t}" has multiple discountPercentage elements (${r})`));const f=function(t,e){const n=[];let o=!1;const i=[{type:"before",el:d.BEFORE,wrapper:u},{type:"after",el:d.AFTER,wrapper:p},{type:"discount",el:d.DISCOUNT,wrapper:g}];for(const{type:r,el:s,wrapper:a}of i){const i=e.querySelector(`[${s}][${c}="${t}"]`);i&&!i.closest(`[${a}]`)&&(o=!0,n.push(`Label "${t}" has ${r} element not inside [${a}]`))}return{hasWarning:o,messages:n}}(t,n);return s.push(...f.messages),f.hasWarning&&(l=!0),{hasError:a,hasWarning:l,messages:s}}function ze(t,e="<product-static-price-selector>"){const n=t.querySelectorAll(`[${c}], [${d.BEFORE}], [${d.AFTER}], [${d.DISCOUNT}]`),o=t.querySelectorAll(`[${c}]`),i=[],r=function(t,e){const n=[];return t.forEach(((t,o)=>{const i=t.getAttribute(c)?.trim();if(!i){const i=t.outerHTML.split("\n")[0].trim().slice(0,100);n.push(`Element ${o} inside ${e} is missing required ${c}: ${i}...`)}})),n}(n,e),s=r.length>0;if(i.push(...r),!o.length)return i.push(`No price-labeled elements found inside ${e}`),{status:"none",messages:i};const a=function(t){const e={};return t.forEach((t=>{const n=t.getAttribute(c)?.trim();n&&(e[n]||(e[n]={beforeCount:0,afterCount:0,discountCount:0}),t.hasAttribute(d.BEFORE)&&(e[n].beforeCount+=1),t.hasAttribute(d.AFTER)&&(e[n].afterCount+=1),t.hasAttribute(d.DISCOUNT)&&(e[n].discountCount+=1))})),e}(o),{messages:l,status:u}=function(t,e){const n=[];let o=!1,i=!1;for(const[r,s]of Object.entries(t)){const t=Fe(r,s,e);n.push(...t.messages),t.hasError&&(o=!0),t.hasWarning&&(i=!0)}return{status:o?"error":i?"warning":"valid",messages:n}}(a,t);i.push(...l);return{status:s?"error":u,messages:i}}function Ye(){const t=[n.PRODUCT_GROUP.VARIANT,n.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO].filter(Boolean).join(", "),e=document.querySelectorAll(t),o={},i=[];return e.forEach((t=>{const e=t.sectionId,n=function(t){const e=t.getAttribute("product_group"),n=t.getAttribute("product-helper-handle");if(!e||!n)return console.warn("[getProductMappingJSON] Missing product_group or product-helper-handle."),null;const o=t.querySelectorAll(`input[type="radio"][${Y}="${K}"]`),i={};return o.forEach((t=>{const e=t.getAttribute(J);e&&(i[e]=`${n}`)})),{product_group:e,products:i}}(t);if(!e||!n)return;o[e]||(o[e]={},i.includes(e)||i.push(e));const r=n.product_group;o[e][r]=n.products})),{mapping:o,sectionOrder:i}}function Je(t=!1){const{mapping:e,sectionOrder:n}=Ye(),o={},i=new Map,r={},s={};let a=0;return n.forEach((n=>{const l=e[n];Object.entries(l).forEach((([e,l])=>{const c=function(t){return JSON.stringify(t,Object.keys(t).sort())}(l);if(function(t,e,n,o){if(t.has(e))return t.get(e)!==n&&console.warn(`‚ö†Ô∏è Conflict: Product group "${e}" has different mappings in section "${o}".`),!0;return!1}(i,e,c,n))return;i.set(e,c),o[e]=l;const{wasAddedToLiquid:d,newTotal:u}=function({productGroup:t,mapping:e,renderWithLiquid:n,totalHandles:o,liquid_loaded:i}){const r=Object.keys(e).length;return n&&o<20&&o+r<=20?(i[t]=e,{wasAddedToLiquid:!0,newTotal:o+r}):{wasAddedToLiquid:!1,newTotal:o}}({productGroup:e,mapping:l,renderWithLiquid:t,totalHandles:a,liquid_loaded:r});a=u,d||(s[e]=l)}))})),{merged:o,liquid_loaded:r,js_loaded:s}}function Xe(t){return t&&"object"==typeof t&&!Array.isArray(t)&&0===Object.keys(t).length}function Qe(t,e,n,o,i,r=!1){const s=function(t){const e=(n=t,`{%- assign product_mapping_str = "\n${Object.entries(n).flatMap((([t,e])=>Object.entries(e).map((([e,n])=>`  ${t}:${e}:${n}`)))).join(",\n")}\n" -%}`);var n;return`\n    ${e}\n  `}(t),a=function(t,e,n,o,i=!0){return`window.__WWAI__ = window.__WWAI__ || {};\n  \n// Environment + Mode Config\n// Use metafield-based subscription in sandbox/local\nwindow.__WWAI__.useMockSubscription = true;\n\n// Options: "local" | "sandbox" | "prod"\nwindow.__WWAI__.deployMode = "local";\n\n// Enables dev/debugger mode, values are dev, prod\nwindow.__WWAI__.MODE = "dev";\n\n// Controls Liquid-product rendering\nwindow.__WWAI__.RENDER_WITH_LIQUID = true;\n\n// Which connector to use for hydration\nwindow.__WWAI__.CONNECTOR_TYPE = "shopify";\n\n// Enable logging for grid height debugging\nwindow.__WWAI__.heightEqualizeLogging = true;\n\n// Currency Config\n// Active currency from Shopify\nwindow.__WWAI__.CURRENCY = Shopify.currency.active;\n\n// Currency conversion factor\nwindow.__WWAI__.CURRENCY_FACTOR = 0.01;\n\n// Product mapping object\nwindow.__WWAI__.JS_PRODUCT_MAPPING_OBJECT = ${JSON.stringify(t,null,2)};\n\n// Product group config\nwindow.__WWAI__.WWAI_PRODUCT_GROUP_CONFIG = ${JSON.stringify(e,null,2)};\n\n// Variant overrides\nwindow.__WWAI__.WWAI_PRODUCT_VARIANT_OVERRIDES = ${JSON.stringify(n,null,2)};\n\n// Labeled images\nwindow.__WWAI__.WWAI_LABELED_IMAGES = ${i?"{}":JSON.stringify(o,null,2)};\n\n// Action buttons\nwindow.__WWAI__.ACTION_BUTTONS = {};\n`}(e,n,o,i);!function(t,e){if(!document.getElementById("variantDevPopup")){const e=document.createElement("style");e.textContent="\n      #variantDevButton {\n        position: fixed;\n        top: 12px;\n        right: 12px;\n        z-index: 10000;\n        background: #111;\n        color: white;\n        padding: 8px 12px;\n        font-size: 13px;\n        border: 1px solid #666;\n        cursor: pointer;\n        border-radius: 4px;\n      }\n      #variantDevPopup {\n        position: fixed;\n        top: 60px;\n        right: 12px;\n        width: 600px;\n        max-height: 80vh;\n        overflow: auto;\n        background: #1e1e1e;\n        color: #eee;\n        padding: 16px;\n        z-index: 9999;\n        border: 1px solid #555;\n        font-family: monospace;\n        display: none;\n      }\n      #variantDevPopup pre {\n        white-space: pre-wrap;\n        background: #222;\n        padding: 12px;\n        overflow-x: auto;\n        margin: 12px 0 0;\n      }\n      #variantDevPopup .control-buttons {\n        display: flex;\n        gap: 8px;\n        margin-bottom: 12px;\n      }\n      #variantDevPopup button {\n        padding: 6px 12px;\n        background: #444;\n        color: white;\n        border: none;\n        cursor: pointer;\n      }\n      #variantDevPopup button.active {\n        background: #666;\n      }\n    ",document.head.appendChild(e);const n=document.createElement("button");n.id="variantDevButton",n.textContent="PDP Config",n.onclick=()=>{document.getElementById("variantDevPopup").style.display="block"},document.body.appendChild(n);const o=document.createElement("div");o.id="variantDevPopup";const i=document.createElement("div");i.className="control-buttons";const r=document.createElement("pre");r.id="variantDevOutputBlock";const s=document.createElement("button");s.textContent="Copy",s.onclick=()=>{navigator.clipboard.writeText(r.textContent),s.textContent="Copied!",setTimeout((()=>s.textContent="Copy"),1500)};const a=document.createElement("button");a.textContent="Close",a.onclick=()=>o.style.display="none";const l={};["Liquid Integration","JS Config"].forEach((e=>{const n=document.createElement("button");n.textContent=e,n.onclick=()=>{Object.values(l).forEach((t=>t.classList.remove("active"))),n.classList.add("active"),r.textContent=t[e]},i.appendChild(n),l[e]=n})),o.appendChild(i),o.appendChild(s),o.appendChild(a),o.appendChild(r),document.body.appendChild(o)}setTimeout((()=>{document.getElementById("variantDevOutputBlock");const t=document.querySelector("#variantDevPopup .control-buttons button");t&&t.click(),e&&(document.getElementById("variantDevPopup").style.display="block")}),0)}({"Liquid Integration":s,"JS Config":a},r)}function Ze(t){const{merged:e,liquid_loaded:o,js_loaded:i}=Je(t);Qe(o,i,function(){const t=[n.PRODUCT_GROUP.VARIANT,n.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO].filter(Boolean).join(", "),e=document.querySelectorAll(t),o={},i={pricingConfig:{discountPercent:0,subscriptionDiscountPercent:0,defaultSubscriptionOption:null,useVariantCompareAtPriceForSubscription:!0,discountCodeToApply:[],roundDiscount:!0,addOffSuffixToDiscount:!1},uxConfig:{variantOptionRemovePrefix:"Every",defaultPurchaseType:"onetime",variantUXConfig:{hideSingleLengthVariants:!1,onlyShowVariantsWithLabelContains:null,refreshUxOnVariantChange:!0},preAddToCartFlowConfig:{journeyType:"overlay",overlayContents:[],postSelectionAction:"na",postSelectionActionParams:{custom_url:null,redirect_variant_options:null}}},flowConfig:{destination:"side-cart",loader:"add-to-cart-submit-button",showSuccessNotification:!1,showErrorNotification:!1,sideCartLabel:"",successNotificationMessage:"‚úÖ Added to cart!",errorNotificationMessage:"Oops, couldn't add item.",notificationOptions:{backgroundColor:"#E8DDFA",textColor:"#000000",borderColor:"transparent",fontFamily:"sans-serif"}}};return e.forEach((t=>{const e=t.productGroup,n=t.sectionId;let r=n;n.includes("__")?r=n.split("__")[1]:n.includes("--")&&(r=n.split("--")[1]);const s=bt(t),a=s.productLabels?.[0]?.trim()||null,l=s.variants?.[a]||{},c={option1:new Set,option2:new Set,option3:new Set};for(const t of s.productLabels||[]){const e=s.variants?.[t]||{};["option1","option2","option3"].forEach((t=>{(e[t]||[]).forEach((e=>c[t].add(e.trim())))}))}const d=t=>[...t].join(" | ")||"",u={defaultProduct:a,defaultVariantOption1:l.option1?.[0]?.trim()||null,defaultVariantOption2:l.option2?.[0]?.trim()||null,defaultVariantOption3:l.option3?.[0]?.trim()||null,allProducts:(s.productLabels||[]).map((t=>t.trim())).join(" | "),allOptions:{option1:d(c.option1),option2:d(c.option2),option3:d(c.option3)}};o[r]=o[r]||{defaults:JSON.parse(JSON.stringify(i))},o[r][e]={pricingConfig:null,uxConfig:null,flowConfig:null,variantDispatchConfig:u}})),o}(),function(){const t=[n.PRODUCT_GROUP.VARIANT,n.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO].filter(Boolean).join(", "),e=document.querySelectorAll(t),o=document.querySelectorAll("product-variant-custom-labeled-text-selector"),i={};return e.forEach((t=>{const e=t.getAttribute("product_group"),n=t.sectionId;let r=n;n.includes("__")?r=n.split("__")[1]:n.includes("--")&&(r=n.split("--")[1]);const s=bt(t);i[r]||(i[r]={}),i[r][e]||(i[r][e]={}),s.productLabels.forEach((t=>{const n=s.variants[t]||{};i[r][e][t]||(i[r][e][t]={});const a=[];(n.option1||[]).forEach((t=>{const e=n.option2?.length?n.option2:[""],o=n.option3?.length?n.option3:[""];e.forEach((e=>{o.forEach((n=>{const o=[t,e,n].filter(Boolean).map((t=>t.trim())).join(" | ");a.push(o)}))}))}));const l={},c=Array.from(o).find((t=>{let n=t.getAttribute("section_id")||"";return n.includes("__")?n=n.split("__")[1]:n.includes("--")&&(n=n.split("--")[1]),n===r&&t.getAttribute("product_group")===e}));c&&c.querySelectorAll(at).forEach((t=>{const e=t.getAttribute(st),n=t.textContent.trim();e&&(l[e]=n)})),a.forEach((n=>{i[r][e][t][n]={customMediaLabel:null,redirectToMediaIndex:null,customLabelText:{...l}}}))}))})),i}(),function(){const t=document.querySelectorAll("product-custom-carousel-media-selector"),e={};return t.forEach((t=>{const n=t.getAttribute("section_id")||"",o=t.getAttribute("product_group")||"",i=`${n}__${o}`,r=t.querySelectorAll("main-slider-slide"),s=[];r.forEach(((t,e)=>{const i=t.querySelector("img"),r=t.id||t.getAttribute("id");if(i&&i.src){let t;try{const e=new URL(i.src,window.location.origin);e.searchParams.delete("v"),t=e.toString()}catch{t=i.src}const a=i.src.match(/[?&]width=(\d+)/),l=a?parseInt(a[1],10):i.width||0,c=i.width,d=i.height,u=c&&d?+(c/d).toFixed(3):1,p=l&&u?Math.round(l/u):0,g=`${n}__${o}__${e+1}`,f=parseInt(r?.split("_").pop(),10),h=isNaN(f)?g:f;s.push({alt:i.getAttribute("alt")||null,id:h,position:e+1,preview_image:{aspect_ratio:u,height:p,width:l,src:t},aspect_ratio:u,height:p,media_type:"image",src:t,width:l})}})),e[i]=s})),e}())}const Ke=[];function tn(t){if(Ke.push(t),!window._hasFunctionalityDebugToggleSetup){let t=!0;Object.defineProperty(window,"FUNCTIONALITY_DEBUG_MODE",{set(e){this._FUNCTIONALITY_DEBUG_MODE=e,console.log(`FUNCTIONALITY_DEBUG_MODE set to: ${e}`),Ke.forEach((n=>n(e,{isFirstSet:t}))),t=!1},get(){return this._FUNCTIONALITY_DEBUG_MODE},configurable:!0}),window._hasFunctionalityDebugToggleSetup=!0}}function en(t=!1){tn(((e,{isFirstSet:n})=>{!0===e?Ze(t):!1!==e||n||function(){const t=document.getElementById("variantDevPopup"),e=document.getElementById("variantDevButton");t&&(t.remove(),console.log("üßπ Removed #variantDevPopup")),e&&(e.remove(),console.log("üßπ Removed #variantDevButton"))}()}))}function nn({HighlighterClass:t,validateFn:e,extraOnEnable:n=null,extraOnDisable:o=null}){return function(i){if(!i)return void console.warn("‚ö†Ô∏è makeDebugHandler was called with an empty or invalid selector.",i);const r=new t(i);e(i),tn(((t,{isFirstSet:e})=>{!0===t?(r.enableDebugging(),n&&n()):!1!==t||e?console.log("FUNCTIONALITY_DEBUG_MODE is null. Skipping debug action."):(r.disableDebugging(),o&&o())}))}}const on=nn({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(!function(t){const e=t.querySelectorAll('input[type="radio"]');let n=document.querySelector("#wwai-debug-tooltip");n||(n=document.createElement("div"),n.id="wwai-debug-tooltip",Object.assign(n.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none"}),document.body.appendChild(n)),e.forEach((e=>{const o=e.getAttribute(Y),i=e.getAttribute(J)||"",r=e.getAttribute(X)||"",s=e.getAttribute(Q)||"",a="product"===o,l="product_variant"===o,c=Boolean(i);let d="";a?d=`Product Selector for "${i}"`:l&&(d=`Variant Selector for "${i}"\n${s}: ${r}`);const u=c&&(a||l&&r)?"2px solid limegreen":"2px solid red";e.style.outline=u;const p=t.querySelector(`label[for="${e.id}"]`);p&&(p.style.outline=u,p.addEventListener("mouseover",(t=>{n.textContent=d,n.style.display="block",n.style.left=`${t.pageX+10}px`,n.style.top=`${t.pageY+10}px`})),p.addEventListener("mousemove",(t=>{n.style.left=`${t.pageX+10}px`,n.style.top=`${t.pageY+10}px`})),p.addEventListener("mouseout",(()=>{n.style.display="none"}))),e.addEventListener("mouseover",(t=>{n.textContent=d,n.style.display="block",n.style.left=`${t.pageX+10}px`,n.style.top=`${t.pageY+10}px`})),e.addEventListener("mousemove",(t=>{n.style.left=`${t.pageX+10}px`,n.style.top=`${t.pageY+10}px`})),e.addEventListener("mouseout",(()=>{n.style.display="none"}))}))}(this.selector),xe(this.selector))}disableDebugging(){!function(t){console.log("clearHighlighting called"),t.querySelectorAll('input[type="radio"]').forEach((e=>{e.style.outline="";const n=e.cloneNode(!0);e.replaceWith(n);const o=t.querySelector(`label[for="${e.id}"]`);if(o){o.style.outline="";const t=o.cloneNode(!0);o.replaceWith(t)}}));const e=document.getElementById("wwai-debug-tooltip");e&&(e.style.display="none"),t.initInputs(),t.bindEvents()}(this.selector),Pe(this.selector)}},validateFn:function(t){const{status:e,messages:n}=je(t);t.setAttribute("debug_status",e),t.setAttribute("debug_message",JSON.stringify(n))}}),rn=nn({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=Object.values(d).map((t=>`[${t}]`)).join(", "),n=t.querySelectorAll(e);let o=document.querySelector("#wwai-debug-tooltip-price");o||(o=document.createElement("div"),o.id="wwai-debug-tooltip-price",Object.assign(o.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none"}),document.body.appendChild(o)),n.forEach((t=>{const e=t.getAttribute(c)||"(missing)";let n="";t.hasAttribute(d.BEFORE)?n="beforePrice":t.hasAttribute(d.AFTER)?n="afterPrice":t.hasAttribute(d.DISCOUNT)?n="discountPercentage":t.hasAttribute(d.SAVINGS)&&(n="savings");const i="(missing)"!==e?"2px solid limegreen":"2px solid red";t.style.outline=i;const r=`Label: ${e}\nType: ${n}`;t.addEventListener("mouseover",(t=>{o.textContent=r,o.style.display="block",o.style.left=`${t.pageX+10}px`,o.style.top=`${t.pageY+10}px`})),t.addEventListener("mousemove",(t=>{o.style.left=`${t.pageX+10}px`,o.style.top=`${t.pageY+10}px`})),t.addEventListener("mouseout",(()=>{o.style.display="none"}))}))}(this.selector))}disableDebugging(){Pe(this.selector),function(t){console.log("clearPriceHighlighting called");const e=Object.values(d).map((t=>`[${t}]`)).join(", ");t.querySelectorAll(e).forEach((t=>{t.style.outline="";const e=t.cloneNode(!0);t.replaceWith(e)}));const n=document.getElementById("wwai-debug-tooltip-price");n&&(n.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const{status:n,messages:o}=He(t,"<product-custom-price-selector>");e&&(console.log("Status:",n),console.log("Messages:",o),console.groupEnd()),t.setAttribute("debug_status",n),t.setAttribute("debug_message",JSON.stringify(o))}}),sn=nn({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=t.querySelectorAll(P);let n=document.querySelector("#wwai-debug-tooltip-purchase-type");n||(n=document.createElement("div"),n.id="wwai-debug-tooltip-purchase-type",Object.assign(n.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none"}),document.body.appendChild(n)),e.forEach((e=>{const o=e.getAttribute(T),i=`Type: ${o}\nName: ${e.getAttribute("name")||"(none)"}`,r=[S.ONETIME,S.SUBSCRIPTION].includes(o)?"2px solid limegreen":"2px solid red";e.style.outline=r,e.addEventListener("mouseover",(t=>{n.textContent=i,n.style.display="block",n.style.left=`${t.pageX+10}px`,n.style.top=`${t.pageY+10}px`})),e.addEventListener("mousemove",(t=>{n.style.left=`${t.pageX+10}px`,n.style.top=`${t.pageY+10}px`})),e.addEventListener("mouseout",(()=>{n.style.display="none"}));const s=e.id;if(s){const e=t.querySelector(`label[for="${s}"]`);e&&(e.style.outline=r,e.addEventListener("mouseover",(t=>{n.textContent=i,n.style.display="block",n.style.left=`${t.pageX+10}px`,n.style.top=`${t.pageY+10}px`})),e.addEventListener("mousemove",(t=>{n.style.left=`${t.pageX+10}px`,n.style.top=`${t.pageY+10}px`})),e.addEventListener("mouseout",(()=>{n.style.display="none"})))}}))}(this.selector))}disableDebugging(){Pe(this.selector),function(t){t.querySelectorAll(P).forEach((e=>{e.style.outline="";const n=e.cloneNode(!0);e.replaceWith(n);const o=e.id;if(o){const e=t.querySelector(`label[for="${o}"]`);if(e){e.style.outline="";const t=e.cloneNode(!0);e.replaceWith(t)}}}));const e=document.querySelector("#wwai-debug-tooltip-purchase-type");e&&(e.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const n=[];let o=!1,i=!1;const r=t.querySelectorAll(P),s=new Set,a={[S.ONETIME]:0,[S.SUBSCRIPTION]:0};r.forEach((t=>{const e=t.getAttribute(T)?.trim(),n=t.getAttribute("name");n&&s.add(n),e===S.ONETIME?a.onetime+=1:e===S.SUBSCRIPTION&&(a.subscription+=1)})),0!==a.onetime&&0!==a.subscription||(o=!0,n.push(`Missing purchase types: ${[0===a.onetime?S.ONETIME:null,0===a.subscription?S.SUBSCRIPTION:null].filter(Boolean).join(", ")}`)),(a.onetime>1||a.subscription>1)&&(o=!0,n.push(`Multiple radios found for: ${[a.onetime>1?`onetime (${a.onetime})`:null,a.subscription>1?`subscription (${a.subscription})`:null].filter(Boolean).join(", ")}`)),s.size>1&&(i=!0,n.push(`Radios inside use multiple "name" attributes: [${[...s].join(", ")}]`));const l=[...s][0];if(l){const e=document.querySelectorAll(`input[type="radio"][name="${l}"]`);Array.from(e).filter((e=>!t.contains(e))).length>0&&(o=!0,n.push(`Radio "name" conflict: "${l}" is reused elsewhere in the document`))}const c=o?"error":i?"warning":"valid";return t.setAttribute("debug_status",c),t.setAttribute("debug_message",JSON.stringify(n)),e&&(console.group("[ProductPurchaseTypeSelector] Validation Output"),console.log("Status:",c),console.log("Messages:",n),console.groupEnd()),{status:c,messages:n}}}),an=nn({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=t.querySelector(z);if(!e)return;let n=document.getElementById("wwai-subscription-tooltip");n||(n=document.createElement("div"),n.id="wwai-subscription-tooltip",Object.assign(n.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",pointerEvents:"none"}),document.body.appendChild(n));const o=`Subscription Frequency Select\nname: ${e.getAttribute("name")||"[no name]"}\noptions: ${e.querySelectorAll("option").length}`;e.style.outline="2px solid limegreen";const i=()=>{const t=e.getBoundingClientRect();n.textContent=o,n.style.left=`${t.left+window.scrollX}px`,n.style.top=`${t.bottom+window.scrollY+6}px`,n.style.display="block"},r=()=>{n.style.display="none"};e._tooltipHandlers={mouseOverHandler:i,mouseOutHandler:r},e.addEventListener("mouseover",i),e.addEventListener("mouseout",r)}(this.selector))}disableDebugging(){Pe(this.selector),function(t){const e=t.querySelector(z);if(!e)return;e.style.outline="";const n=e._tooltipHandlers;n&&(e.removeEventListener("mouseover",n.mouseOverHandler),e.removeEventListener("mouseout",n.mouseOutHandler),delete e._tooltipHandlers);const o=document.getElementById("wwai-subscription-tooltip");o&&(o.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const n=[];let o=!1;const i=t.querySelectorAll(z);0===i.length?(o=!0,n.push(`Missing <select> with [${F}]`)):i.length>1&&(o=!0,n.push(`Multiple <select> elements with [${F}] found (${i.length}) ‚Äî only one allowed.`));const r=i[0];if(r){"select"!==r.tagName.toLowerCase()&&(o=!0,n.push(`Element with [${F}] must be a <select>, found <${r.tagName.toLowerCase()}>`));const t=r.getAttribute("name");if(t){const e=document.querySelectorAll(`input[name="${t}"], select[name="${t}"]`),i=Array.from(e).filter((t=>t!==r));i.length>0&&(o=!0,n.push(`Name "${t}" is not unique ‚Äî found ${i.length} other input/select(s) using this name`))}else o=!0,n.push('Select element must have a "name" attribute')}const s=o?"error":"valid";return t.setAttribute("debug_status",s),t.setAttribute("debug_message",JSON.stringify(n)),e&&(console.group("[ProductSubscriptionFrequencySelector] Validation Output"),console.log("Status:",s),console.log("Messages:",n),console.groupEnd()),{status:s,messages:n}}}),ln=nn({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=t.querySelector(z);if(!e)return;let n=document.getElementById("wwai-static-subscription-tooltip");n||(n=document.createElement("div"),n.id="wwai-static-subscription-tooltip",Object.assign(n.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",pointerEvents:"none"}),document.body.appendChild(n));const o=t.getAttribute(ee)||"[no product label]",i={option1:t.getAttribute(ne),option2:t.getAttribute(oe),option3:t.getAttribute(ie)},r=`Static Subscription Frequency Selector\nProduct: ${o}\n${Object.entries(i).filter((([t,e])=>!!e)).map((([t,e])=>`${t}: ${e}`)).join("\n")||"[no variant options]"}\nOptions: ${e.querySelectorAll("option").length}`;e.style.outline="2px solid orange";const s=()=>{const t=e.getBoundingClientRect();n.textContent=r,n.style.left=`${t.left+window.scrollX}px`,n.style.top=`${t.bottom+window.scrollY+6}px`,n.style.display="block"},a=()=>{n.style.display="none"};e._tooltipHandlers={mouseOverHandler:s,mouseOutHandler:a},e.addEventListener("mouseover",s),e.addEventListener("mouseout",a)}(this.selector))}disableDebugging(){Pe(this.selector),function(t){const e=t.querySelector("select");if(!e)return;e.style.outline="";const n=e._tooltipHandlers;n&&(e.removeEventListener("mouseover",n.mouseOverHandler),e.removeEventListener("mouseout",n.mouseOutHandler),delete e._tooltipHandlers);const o=document.getElementById("wwai-static-subscription-tooltip");o&&(o.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const n=[];let o=!1;const i=t.querySelectorAll("select");0===i.length?(o=!0,n.push("Missing <select> element inside static frequency selector")):i.length>1&&(o=!0,n.push(`Multiple <select> elements found (${i.length}) ‚Äî only one allowed.`));const r=i[0];if(r){"select"!==r.tagName.toLowerCase()&&(o=!0,n.push(`Expected a <select> element but found <${r.tagName.toLowerCase()}>`));const t=r.getAttribute("name");if(t){const e=document.querySelectorAll(`input[name="${t}"], select[name="${t}"]`),i=Array.from(e).filter((t=>t!==r));i.length>0&&(o=!0,n.push(`Name "${t}" is not unique ‚Äî found ${i.length} other input/select(s) using this name`))}else o=!0,n.push('Select element must have a "name" attribute')}t.getAttribute(ee)||(o=!0,n.push(`Missing required attribute [${ee}]`));const s=t.getAttribute(ne),a=t.getAttribute(oe),l=t.getAttribute(ie);s||a||l||(o=!0,n.push(`At least one variant option attribute must be defined ([${ne}], etc.)`));const c=o?"error":"valid";return t.setAttribute("debug_status",c),t.setAttribute("debug_message",JSON.stringify(n)),e&&(console.group("[ProductStaticSubscriptionFrequencySelector] Validation Output"),console.log("Status:",c),console.log("Messages:",n),console.groupEnd()),{status:c,messages:n}}}),cn=nn({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=Object.values(d).map((t=>`[${t}]`)).join(", "),n=t.querySelectorAll(e);if(!n.length)return;let o=document.getElementById("wwai-static-price-tooltip");o||(o=document.createElement("div"),o.id="wwai-static-price-tooltip",Object.assign(o.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",pointerEvents:"none"}),document.body.appendChild(o));const i=t.getAttribute(ee)||"(missing)",r={option1:t.getAttribute(ne),option2:t.getAttribute(oe),option3:t.getAttribute(ie)},s=Object.entries(r).filter((([t,e])=>e)).map((([t,e])=>`${t}: ${e}`)).join("\n");n.forEach((t=>{const e=t.getAttribute(c)||"(missing)";let n="";t.hasAttribute(d.BEFORE)?n="beforePrice":t.hasAttribute(d.AFTER)?n="afterPrice":t.hasAttribute(d.DISCOUNT)?n="discountPercentage":t.hasAttribute(d.SAVINGS)&&(n="savings");const r="(missing)"!==e;t.style.outline=r?"2px solid limegreen":"2px solid red";const a=`Static Price Selector\nLabel: ${e}\nType: ${n}\nProduct: ${i}\n${s}`;t.addEventListener("mouseover",(t=>{o.textContent=a,o.style.display="block",o.style.left=`${t.pageX+10}px`,o.style.top=`${t.pageY+10}px`})),t.addEventListener("mousemove",(t=>{o.style.left=`${t.pageX+10}px`,o.style.top=`${t.pageY+10}px`})),t.addEventListener("mouseout",(()=>{o.style.display="none"}))}))}(this.selector))}disableDebugging(){Pe(this.selector),function(t){const e=Object.values(d).map((t=>`[${t}]`)).join(", ");t.querySelectorAll(e).forEach((t=>{t.style.outline="";const e=t.cloneNode(!0);t.replaceWith(e)}));const n=document.getElementById("wwai-static-price-tooltip");n&&(n.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const{status:n,messages:o}=ze(t,"<product-static-price-selector>");e&&(console.group("[ProductStaticPriceSelector] Validation Output"),console.log("Status:",n),console.log("Messages:",o),console.groupEnd()),t.setAttribute("debug_status",n),t.setAttribute("debug_message",JSON.stringify(o))}}),dn=nn({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(!function(t){const e=t.querySelectorAll(at);if(!e.length)return;let n=document.getElementById("wwai-variant-custom-label-tooltip");n||(n=document.createElement("div"),n.id="wwai-variant-custom-label-tooltip",Object.assign(n.style,{position:"fixed",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",pointerEvents:"none"}),document.body.appendChild(n)),e.forEach((t=>{const e=`Custom Variant Label Text\nLabel: ${t.getAttribute(st)||"[missing label]"}\nText: ${t.textContent?.trim()||"[empty text]"}`;t.style.outline="2px solid limegreen";const o=t=>{n.textContent=e,n.style.display="block",n.style.left=`${t.clientX+10}px`,n.style.top=`${t.clientY+10}px`},i=t=>{n.style.left=`${t.clientX+10}px`,n.style.top=`${t.clientY+10}px`},r=()=>{n.style.display="none"};t._tooltipHandlers={onMouseOver:o,onMouseMove:i,onMouseOut:r},t.addEventListener("mouseover",o),t.addEventListener("mousemove",i),t.addEventListener("mouseout",r)}))}(this.selector),xe(this.selector))}disableDebugging(){!function(t){const e=t.querySelectorAll(at);if(!e.length)return;e.forEach((t=>{t.style.outline="";const e=t._tooltipHandlers;e&&(t.removeEventListener("mouseover",e.onMouseOver),t.removeEventListener("mousemove",e.onMouseMove),t.removeEventListener("mouseout",e.onMouseOut),delete t._tooltipHandlers)}));const n=document.getElementById("wwai-variant-custom-label-tooltip");n&&(n.style.display="none")}(this.selector),Pe(this.selector)}},validateFn:function(t,e=!1){const n=[];let o=!1,i=!1;const r=t.querySelectorAll(at);0===r.length&&(i=!0,n.push(`No element found with [${at}]`));const s=new Set;r.forEach(((t,e)=>{const r=t.getAttribute(st)?.trim(),a=(t.textContent||"").trim();r?s.has(r)?(o=!0,n.push(`Duplicate label value "${r}" found`)):s.add(r):(o=!0,n.push(`Element #${e+1} is missing [${st}]`)),a||(i=!0,n.push(`Element #${e+1} has no visible text content`))}));const a=o?"error":i?"warning":"valid";return t.setAttribute("debug_status",a),t.setAttribute("debug_message",JSON.stringify(n)),e&&(console.group("[VariantCustomLabelText] Validation Output"),console.log("Status:",a),console.log("Messages:",n),console.groupEnd()),{status:a,messages:n}}}),un=nn({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=t.querySelector(s);if(!e)return;let n=document.getElementById("wwai-carousel-tooltip");n||(n=document.createElement("div"),n.id="wwai-carousel-tooltip",Object.assign(n.style,{position:"fixed",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",pointerEvents:"none"}),document.body.appendChild(n)),e.style.outline="2px solid limegreen";const o=a.map((t=>`${t}: ${"function"==typeof e[t]?"yes":"no"}`)).join("\n"),i=`<${s}> found\nMethods:\n${o}`,r=t=>{n.textContent=i,n.style.display="block",n.style.transform=`translate(${t.clientX+10}px, ${t.clientY+10}px)`},l=t=>{n.style.transform=`translate(${t.clientX+10}px, ${t.clientY+10}px)`},c=()=>{n.style.display="none"};e._tooltipHandlers={onMouseOver:r,onMouseMove:l,onMouseOut:c},e.addEventListener("mouseover",r),e.addEventListener("mousemove",l),e.addEventListener("mouseout",c)}(this.selector))}disableDebugging(){Pe(this.selector),function(t){const e=t.querySelector(s);if(!e)return;e.style.outline="";const n=e._tooltipHandlers;n&&(e.removeEventListener("mouseover",n.onMouseOver),e.removeEventListener("mousemove",n.onMouseMove),e.removeEventListener("mouseout",n.onMouseOut),delete e._tooltipHandlers);const o=document.getElementById("wwai-carousel-tooltip");o&&(o.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const n=[];let o=!1;const i=t.querySelectorAll(s);if(0===i.length?(o=!0,n.push(`Missing <${s}> inside <product-custom-carousel-media-selector>.`)):i.length>1&&(o=!0,n.push(`Multiple <${s}> elements found (${i.length}). Only one is allowed.`)),1===i.length){const t=i[0];a.forEach((e=>{"function"!=typeof t[e]&&(o=!0,n.push(`Missing required method: "${e}" on <${s}>.`))}))}const r=o?"error":"valid";return t.setAttribute("debug_status",r),t.setAttribute("debug_message",JSON.stringify(n)),e&&(console.group("[CustomCarouselMediaSelector] Validation Output"),console.log("Status:",r),console.log("Messages:",n),console.groupEnd()),{status:r,messages:n}}}),pn=nn({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=t.querySelector("form");if(!e)return;let n=document.getElementById("wwai-addtocart-tooltip");n||(n=document.createElement("div"),n.id="wwai-addtocart-tooltip",Object.assign(n.style,{position:"fixed",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",pointerEvents:"none"}),document.body.appendChild(n)),t.style.outline="2px solid limegreen";const o=e.querySelectorAll('input[type="hidden"]'),r=`Custom Add to Cart\nHidden Inputs: ${Array.from(o).map((t=>t.name)).join(", ")||"[none]"}\nSubmit Button: ${e.querySelector('button[type="submit"]')?"yes":"no"}\n[+Text]: ${e.querySelector(`[${i.ADD_TO_CART_TEXT_ATTR}]`)?"yes":"no"} | [Sold]: ${e.querySelector(`[${i.SOLD_OUT_TEXT_ATTR}]`)?"yes":"no"}`,s=t=>{n.textContent=r,n.style.display="block",n.style.transform=`translate(${t.clientX+12}px, ${t.clientY+12}px)`},a=t=>{n.style.transform=`translate(${t.clientX+12}px, ${t.clientY+12}px)`},l=()=>{n.style.display="none"};t._tooltipHandlers={onMouseOver:s,onMouseMove:a,onMouseOut:l},t.addEventListener("mouseover",s),t.addEventListener("mousemove",a),t.addEventListener("mouseout",l)}(this.selector))}disableDebugging(){Pe(this.selector),function(t){t.style.outline="";const e=t._tooltipHandlers;e&&(t.removeEventListener("mouseover",e.onMouseOver),t.removeEventListener("mousemove",e.onMouseMove),t.removeEventListener("mouseout",e.onMouseOut),delete t._tooltipHandlers);const n=document.getElementById("wwai-addtocart-tooltip");n&&(n.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const n=[];let r=!1,s=!1;const a=t.querySelector("form");if(a){const t=new Set;Array.from(a.querySelectorAll("input")).forEach((e=>{const o=e.getAttribute("name");o&&(t.has(o)&&(r=!0,n.push(`‚ùå Duplicate hidden input name: "${o}"`)),t.add(o))})),o.forEach((({name:t,label:e})=>{a.querySelector(`input[name="${t}"]`)||(r=!0,n.push(`‚ùå Missing hidden input for: ${e} (name="${t}")`))}));const e=a.querySelector('button[type="submit"]');if(e){const t=e.querySelector(`[${i.ADD_TO_CART_TEXT}]`),o=e.querySelector(`[${i.SOLD_OUT_TEXT}]`);t&&o||(s=!0,n.push("‚ö†Ô∏è Missing span(s) inside button: "+(t?"":`[${i.ADD_TO_CART_TEXT}] `)+(o?"":`[${i.SOLD_OUT_TEXT}]`)))}else r=!0,n.push("‚ùå No <button type='submit'> found inside form.")}else r=!0,n.push("‚ùå No <form> found inside <product-custom-add-to-cart-button>.");const l=r?"error":s?"warning":"valid";return t.setAttribute("debug_status",l),t.setAttribute("debug_message",JSON.stringify(n)),e&&(console.group("[AddToCartButton Validation]"),console.log("Status:",l),console.log("Messages:",n),console.groupEnd()),{status:l,messages:n}}}),gn=nn({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){if(!t)return;let e=document.getElementById("wwai-submit-interceptor-tooltip");e||(e=document.createElement("div"),e.id="wwai-submit-interceptor-tooltip",Object.assign(e.style,{position:"fixed",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",pointerEvents:"none",maxWidth:"300px"}),document.body.appendChild(e));const o="Submit Interceptor\nATC Exists: "+(t.querySelector(n.PRODUCT_GROUP.ADD_TO_CART)?"‚úÖ Yes":"‚ùå No");t.style.outline="2px solid orange";const i=t=>{e.textContent=o,e.style.display="block",e.style.transform=`translate(${t.clientX+10}px, ${t.clientY+10}px)`},r=t=>{e.style.transform=`translate(${t.clientX+10}px, ${t.clientY+10}px)`},s=()=>{e.style.display="none"};t._tooltipHandlers={mouseOver:i,mouseMove:r,mouseOut:s},t.addEventListener("mouseover",i),t.addEventListener("mousemove",r),t.addEventListener("mouseout",s)}(this.selector))}disableDebugging(){Pe(this.selector),function(t){if(!t)return;t.style.outline="";const e=t._tooltipHandlers;e&&(t.removeEventListener("mouseover",e.mouseOver),t.removeEventListener("mousemove",e.mouseMove),t.removeEventListener("mouseout",e.mouseOut),delete t._tooltipHandlers);const n=document.getElementById("wwai-submit-interceptor-tooltip");n&&(n.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const o=[];let i=!1;t.querySelector(n.PRODUCT_GROUP.ADD_TO_CART)||(i=!0,o.push("‚ùå Missing <${ADD_TO_CART_SELECTOR}> inside submit interceptor."));const r=i?"error":"valid";return t.setAttribute("debug_status",r),t.setAttribute("debug_message",JSON.stringify(o)),e&&(console.group("[ProductCustomSubmitInterceptor] Validation Output"),console.log("Status:",r),console.log("Messages:",o),console.groupEnd()),{status:r,messages:o}}}),fn=nn({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=t.querySelectorAll(De);let n=document.querySelector("#wwai-debug-tooltip-media");n||(n=document.createElement("div"),n.id="wwai-debug-tooltip-media",Object.assign(n.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none"}),document.body.appendChild(n)),e.forEach((t=>{const e=t.getAttribute(Ue)||"(missing)",o="(missing)"!==e?"2px solid limegreen":"2px solid red",i=t.querySelector("img");i?i.style.outline=o:t.style.outline=o;const r=`Media ID: ${e}`;t.addEventListener("mouseover",(t=>{n.textContent=r,n.style.display="block",n.style.left=`${t.pageX+10}px`,n.style.top=`${t.pageY+10}px`})),t.addEventListener("mousemove",(t=>{n.style.left=`${t.pageX+10}px`,n.style.top=`${t.pageY+10}px`})),t.addEventListener("mouseout",(()=>{n.style.display="none"}))}))}(this.selector))}disableDebugging(){Pe(this.selector),function(t){console.log("clearMediaHighlighting called"),t.querySelectorAll(De).forEach((t=>{t.style.outline="";const e=t.cloneNode(!0);t.replaceWith(e)}));const e=document.getElementById("wwai-debug-tooltip-media");e&&(e.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const n=[];let o=!1;const i=t.getAttribute("section_id"),r=t.getAttribute("product_group");i||(o=!0,n.push("‚ö†Ô∏è Missing attribute [section_id]")),r||(o=!0,n.push("‚ö†Ô∏è Missing attribute [product_group]"));const s=t.querySelector($e);s||(o=!0,n.push(`‚ö†Ô∏è Missing main media container [${$e}]`));const a=s?s.querySelector(De):null;if(a){a.querySelector("img")||(o=!0,n.push("‚ö†Ô∏è Missing <img> element inside the first slide")),a.hasAttribute(Ue)||(o=!0,n.push(`‚ö†Ô∏è First slide is missing required attribute [${Ue}]`))}else o=!0,n.push(`‚ö†Ô∏è Missing initial slide [${De}] in container`);const l=o?"error":"valid";return t.setAttribute("debug_status",l),t.setAttribute("debug_message",JSON.stringify(n)),e&&(console.group("[ProductMediaGalleryForGrids] Validation Output"),console.log("Status:",l),console.log("Messages:",n),console.groupEnd()),{status:l,messages:n}}}),hn=nn({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){if(!t)return void console.error("WWAI-ERROR ‚ùå Selector element not found for hover panel initialization.");let e=document.querySelector("#wwai-flow-config-panel");e||(e=document.createElement("div"),e.id="wwai-flow-config-panel",Object.assign(e.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"8px 10px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",maxWidth:"400px",overflowWrap:"break-word",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.2)"}),document.body.appendChild(e)),t.addEventListener("mouseover",(n=>{const o=t.uxConfig?.preAddToCartFlowConfig,i=`${o?.journeyType||"-"} - ${o?.postSelectionAction||"-"} | ${Array.isArray(o?.overlayContents)?o.overlayContents.join(", "):"-"}`;e.textContent=`${i}`,e.style.display="block"})),t.addEventListener("mousemove",(t=>{e.style.left=`${t.pageX+15}px`,e.style.top=`${t.pageY+15}px`})),t.addEventListener("mouseout",(()=>{e.style.display="none"}))}(this.selector))}disableDebugging(){Pe(this.selector),function(t){if(!t)return void console.warn("‚ö†Ô∏è No selector element provided for panel removal.");const e=document.getElementById("wwai-flow-config-panel");e&&(e.remove(),console.log("‚úÖ Hover panel successfully removed from the DOM.")),t.removeEventListener("mouseover",Ne),t.removeEventListener("mousemove",We),t.removeEventListener("mouseout",Le),console.log("‚úÖ Event listeners successfully removed.")}(this.selector)}},validateFn:function(t,e=!1){const n=[];let o=!1;const i=t.querySelector(":scope > button");if(i){i.textContent.trim().length>0&&(o=!0,n.push("‚ö†Ô∏è Button should not contain text, only an icon."))}else o=!0,n.push(`‚ö†Ô∏è Expected an immediate child <button> element inside <${t.tagName.toLowerCase()}>`);const r=o?"error":"valid";return t.setAttribute("debug_status",r),t.setAttribute("debug_message",JSON.stringify(n)),e&&(console.group("[validateProductGridIconSmartInteractionButton] Validation Output"),console.log("Status:",r),console.log("Messages:",n),console.groupEnd()),{status:r,messages:n}}}),bn={[n.PRODUCT_GROUP.VARIANT]:t=>on(t),[n.PRODUCT_GROUP.PRICE]:rn,[n.PRODUCT_GROUP.PURCHASE_TYPE]:sn,[n.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY]:an,[n.PRODUCT_GROUP.VARIANT_CUSTOM_LABEL]:dn,[n.PRODUCT_GROUP.CAROUSEL]:un,[n.PRODUCT_GROUP.ADD_TO_CART]:pn,[n.PRODUCT_GROUP.SUBMIT_INTERCEPTOR]:gn,[n.PRODUCT_GROUP.PRODUCT_MEDIA_GALLERY_FOR_GRIDS]:fn,[n.PRODUCT_GROUP.GRID_SMART_INTERACTION]:hn,[n.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY_STATIC]:ln,[n.PRODUCT_GROUP.PRICE_STATIC]:cn};const mn=Object.values(n.PRODUCT_GROUP);function wn(t){const e=[];for(const[n,o]of Object.entries(t)){const t=document.getElementById(n);if(!t)continue;const i=Array.from(o),r=`‚úÖ Product groups in this section: ${i.length} /  ${i.join(", ")}`,s=(()=>{try{return JSON.parse(t.getAttribute("debug_message"))||[]}catch{return[]}})(),a=Array.from(new Set([...s,r]));t.setAttribute("debug_status","valid"),t.setAttribute("debug_message",JSON.stringify(a)),e.push(t)}var n;(n=e)&&n.length&&tn(((t,{isFirstSet:e})=>{n.forEach((n=>{!0===t?xe(n):!1!==t||e||Pe(n)}))}))}function _n(){const t=function(){const t={};return mn.forEach((e=>{document.querySelectorAll(e).forEach((e=>{const n=e.getAttribute("section_id")?.trim(),o=e.getAttribute("product_group")?.trim(),i=n&&!!document.getElementById(n),r=[];let s=!1;n?i||(s=!0,r.push(`No element found in DOM with id="${n}".`)):(s=!0,r.push("Missing `section_id` attribute.")),o||(s=!0,r.push("Missing `product_group` attribute."));const a=(()=>{try{return JSON.parse(e.getAttribute("debug_message"))||[]}catch{return[]}})(),l=e.getAttribute("debug_status")||"valid",c=s||"error"===l?"error":l,d=Array.from(new Set([...a,...r]));e.setAttribute("debug_status",c),e.setAttribute("debug_message",JSON.stringify(d)),!s&&n&&o&&(t[n]=t[n]||new Set,t[n].add(o))}))})),t}();wn(t);const e={};for(const[n,o]of Object.entries(t))e[n]=Array.from(o);return e}const yn={mock:async t=>(console.log(`[MOCK] Simulated fetch for: /products/${t}.js`),{handle:t,title:`Mock Product for ${t}`,variants:[{id:`${t}-variant-1`,title:"Default Variant",available:!0}],selling_plan_groups:[],images:[],description:"Mock product.",vendor:"MockVendor",product_type:"MockType"}),shopify:async t=>{try{const e=await fetch(`/products/${t}.js`);return e.ok?await e.json():(console.error(`WWAI-ERROR ‚ùå Fetch failed for /products/${t}.js ‚Äî HTTP ${e.status}`),null)}catch(e){return console.error(`WWAI-ERROR ‚ùå Error fetching ${t}:`,e),null}}};function vn(t){let e=0,n=0;return Object.entries(t.productGroups||{}).forEach((([t,o])=>{e++,n+=Object.keys(o).length})),{groupCount:e,totalLabels:n}}function Cn(t,e){const n=function(t){return"object"==typeof E().JS_PRODUCT_MAPPING_OBJECT&&null!==E().JS_PRODUCT_MAPPING_OBJECT&&Object.keys(E().JS_PRODUCT_MAPPING_OBJECT).length>0?(console.log("Using preloaded getWWAIConfig().JS_PRODUCT_MAPPING_OBJECT to hydrate via JS."),E().JS_PRODUCT_MAPPING_OBJECT):"object"==typeof jsObj&&null!==jsObj&&0===Object.keys(jsObj).length?(t&&(console.warn("‚ö†Ô∏è getWWAIConfig().JS_PRODUCT_MAPPING_OBJECT is defined but empty."),console.warn("üí° This likely means your JS assignment didn‚Äôt populate product mappings correctly.")),{}):(console.error("WWAI-ERROR [ERROR]: getWWAIConfig().JS_PRODUCT_MAPPING_OBJECT is undefined"),{})}(e);if(0==Object.keys(n).length)return;const o=function({createIfMissing:t=!1}={}){if(!window.__WWAI__SECTION_PRODUCT_DATA__){if(!t)throw new Error("window.__WWAI__SECTION_PRODUCT_DATA__ not found.");window.__WWAI__SECTION_PRODUCT_DATA__={}}if(!window.__WWAI__SECTION_PRODUCT_DATA__.all_sections){if(!t)throw new Error("window.__WWAI__SECTION_PRODUCT_DATA__['all_sections'] not found.");window.__WWAI__SECTION_PRODUCT_DATA__.all_sections={}}if(!window.__WWAI__SECTION_PRODUCT_DATA__.all_sections.storeData){if(!t)throw new Error("SECTION_DATA.storeData not initialized. Make sure Liquid block ran before this.");window.__WWAI__SECTION_PRODUCT_DATA__.all_sections.storeData={productGroups:{},variantSellingPlans:{},variantSubscriptionMapping:{}}}return window.__WWAI__SECTION_PRODUCT_DATA__.all_sections.storeData}({createIfMissing:"mock"==t}),i=vn(o),{toFetch:r,grouped:s}=function(t,e){const n=new Set,o={};return Object.entries(t).forEach((([t,i])=>{e.productGroups[t]=e.productGroups[t]||{},o[t]=[],Object.entries(i).forEach((([i,r])=>{e.productGroups[t][i]?console.info(`Skipping already loaded: [${t}] ${i} (${r})`):(o[t].push({label:i,handle:r}),n.add(r))}))})),{toFetch:n,grouped:o}}(n,o);return function(t,e="mock"){const n=yn[e];if(!n)throw new Error(`‚ùå Unknown connector type: "${e}"`);return Promise.all(t.map((t=>n(t))))}([...r],t).then((t=>{const e=function(t){const e={};return t.forEach((t=>{t&&(e[t.handle]=t)})),e}(t);!function({grouped:t,handleToProduct:e,storeData:n}){window.__WWAI_PRODUCT_AVAILABILITY__=window.__WWAI_PRODUCT_AVAILABILITY__||{},Object.entries(t).forEach((([t,o])=>{o.forEach((({label:o,handle:i})=>{const r=e[i],s=`${t}__${o}`;r?(n.productGroups[t][o]=r,n.variantSellingPlans[s]={variants:r.variants||[],selling_plan_groups:r.selling_plan_groups||[]},n.variantSubscriptionMapping=n.variantSubscriptionMapping||{},n.variantSubscriptionMapping[s]={},window.__WWAI_PRODUCT_AVAILABILITY__[i]=!0,console.log(`‚úÖ Loaded: Product using connector ${E().CONNECTOR_TYPE} - ${i}`)):(window.__WWAI_PRODUCT_AVAILABILITY__[i]=!1,console.warn(`‚ö†Ô∏è Failed to fetch: ${i}`))}))}))}({grouped:s,handleToProduct:e,storeData:o});const n=vn(o),r=n.totalLabels-i.totalLabels;console.log(`Hydrated ${r} new product label(s) across ${n.groupCount} group(s).`)}))}function An(t=!0){if(Array.isArray(window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__)&&window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__.length>0)return console.log("‚ö° Using preloaded window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__ to init product availability."),e=window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__,window.__WWAI_PRODUCT_AVAILABILITY__=window.__WWAI_PRODUCT_AVAILABILITY__||{},void e.forEach((t=>{const e=t.split(":").map((t=>t.trim()))[2];e&&(window.__WWAI_PRODUCT_AVAILABILITY__[e]=!0)}));var e;Array.isArray(window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__)&&0===window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__.length?t&&(console.warn("‚ö†Ô∏è Detected has_static_loaded_products is set but window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__ is defined and empty."),console.warn("üí° This likely means your Liquid block did not assign `product_mapping_array` correctly.")):console.log("[ERROR]: window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__ undefined")}function On({sectionId:t,productGroup:e,config:o={}}){console.log(`üîÑ Initializing Config for [${t} / ${e}]`),function({sectionId:t,productGroup:e,flowConfig:o={}}){Object.values(n.PRODUCT_GROUP).forEach((n=>{const i=L(t,e,n);i.length&&i.forEach(((t,e)=>{if("function"==typeof t.initFlowConfig)try{t.initFlowConfig(o)}catch(t){console.error(`WWAI-ERROR ‚ùå Error initializing flow config for [${n} - index ${e}]`,t)}}))}))}({sectionId:t,productGroup:e,flowConfig:o.flowConfig}),function({sectionId:t,productGroup:e,uxConfig:o={}}){Object.values(n.PRODUCT_GROUP).forEach((n=>{const i=L(t,e,n);i.length&&i.forEach(((t,e)=>{if("function"==typeof t.initUXConfig)try{t.initUXConfig(o)}catch(t){console.error(`WWAI-ERROR ‚ùå Error initializing UX config for [${n} - index ${e}]`,t)}}))}))}({sectionId:t,productGroup:e,uxConfig:o.uxConfig}),function({sectionId:t,productGroup:e,pricingConfig:o={}}){Object.values(n.PRODUCT_GROUP).forEach((n=>{const i=L(t,e,n);i.length&&i.forEach(((t,e)=>{if("function"==typeof t.initPricingConfig)try{t.initPricingConfig(o)}catch(t){console.error(`WWAI-ERROR ‚ùå Error initializing Pricing config for [${n} - index ${e}]`,t)}}))}))}({sectionId:t,productGroup:e,pricingConfig:o.pricingConfig})}function In(t,e,n={}){const{mock:o=!1}=n;if(!t?.variants||!Array.isArray(t.variants))return void console.warn("‚ö†Ô∏è Product object does not contain variants.");if(!e||!e.inputs)return void console.warn("‚ö†Ô∏è Invalid or missing variant selector element.");const i=function(t){const e={option1:new Set,option2:new Set,option3:new Set};return t.forEach((t=>{t.available&&(t.option1&&e.option1.add(t.option1.trim()),t.option2&&e.option2.add(t.option2.trim()),t.option3&&e.option3.add(t.option3.trim()))})),e}(t.variants);o&&function(t,e=!0){const n=t?.option3;if(!n||n.size<=1)return;const o=Array.from(n),i=o[Math.random()>.5?0:o.length-1];n.delete(i),e&&console.log(`üîÑ Removed "${i}" from option3`)}(i,!0),function(t,e){t.forEach((t=>{if(t.getAttribute(Y)===tt){const n=t.getAttribute(Q)||"option1",o=t.getAttribute(X),i=document.querySelector(`label[for="${t.id}"]`),r=e[n]?.has(o.trim());t.disabled=!r,t.style.opacity=r?"":"0.5",t.style.pointerEvents=r?"":"none",t.style.cursor=r?"":"not-allowed",i&&(i.style.color=r?"":"#aaa",i.style.cursor=r?"":"not-allowed")}}))}(e.inputs,i)}async function En(t,e=!0){try{if(e){const e=await async function(t){try{const e=document.querySelector("script[id='shopify-features']"),n=JSON.parse(e.innerHTML),o=await fetch(`${Shopify.routes.root}cart.js`).then((t=>t.json())),i={Authorization:"Basic "+btoa(n.accessToken),Accept:"*/*","Content-Type":"application/json"},r={checkout:{line_items:o.items,discount_code:t,country:Shopify.country,presentment_currency:o.currency}},s=await fetch("/wallets/checkouts/",{method:"POST",headers:i,body:JSON.stringify(r),referrerPolicy:"no-referrer"}),a=await s.json();return a.errors&&a.errors.discount_code?{isValid:!1,error:a.errors.discount_code[0].message}:{isValid:!0}}catch(t){return console.error("WWAI-ERROR Error in validateDiscountCode:",t),{isValid:!1,error:"Unable to validate discount code"}}}(t);if(!e.isValid)return void console.error(`WWAI-ERROR Failed to activate discount code "${t}" because: ${e.error}`)}const n=await async function(t){try{const e=await fetch(`/discount/${t}`);return{success:!0,html:await e.text()}}catch(t){return console.error("WWAI-ERROR Discount activation failed (/discount):",t),{success:!1,error:"Unable to activate discount"}}}(t);n.success?console.log(`Discount code "${t}" activated successfully.`):console.error(`WWAI-ERROR Failed to activate discount code "${t}" because: ${n.error}`)}catch(e){console.error(`WWAI-ERROR Error activating discount code "${t}":`,e)}}function Rn(t){(t?.pricingConfig?.discountCodeToApply||[]).filter((t=>"string"==typeof t&&t.trim())).forEach((t=>async function(t,e=!0){const n=t.trim().toUpperCase();if(window.__wwai_discount_codes_applied.has(n))console.warn(`Discount code "${n}" has already been applied.`);else try{await En(n,e),window.__wwai_discount_codes_applied.add(n)}catch(t){console.error(`WWAI-ERROR ‚ùå Error applying discount code "${n}":`,t.message)}}(t.trim(),!1)))}function Tn(t,e,n){if(!t||!t.variantDispatchConfig)return console.error("WWAI-ERROR ‚ùå No config found for sectionId:",e,"productGroup:",n),{productLabel:null,variantOptions:null};return{productLabel:t.variantDispatchConfig.defaultProduct,variantOptions:function(t){const e={};return t.defaultVariantOption1&&(e.option1=t.defaultVariantOption1),t.defaultVariantOption2&&(e.option2=t.defaultVariantOption2),t.defaultVariantOption3&&(e.option3=t.defaultVariantOption3),e}(t.variantDispatchConfig)}}function Sn({sectionId:t,productGroup:e,variantSelector:n}){const o=Tt(t,e),{productLabel:i,variantOptions:r}=Tn(o,t,e);if(!i||!r)return{config:null,variant_config:null,product_object:null,variant_object:null,productLabel:null,variantOptions:null};const{config:s,variant_config:a,product_object:l,variant_object:c}=St(t,e,i,r);return function({sectionId:t,productGroup:e,variantSelector:n,resolvedConfig:o,product_object:i}){On({sectionId:t,productGroup:e,config:o}),Rn(o),In(i,n,{mock:!1})}({sectionId:t,productGroup:e,variantSelector:n,resolvedConfig:s,product_object:l}),{config:s,variant_config:a,product_object:l,variant_object:c,productLabel:i,variantOptions:r}}function Pn(t,e,o,i){const r=k(t,e,n.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO),s=Tt(t,e),{productLabel:a,variantOptions:l}=Tn(s,t,e),{config:c,variant_config:d,product_object:u,variant_object:p}=St(t,e,a,l);On({sectionId:t,productGroup:e,config:c}),Rn(c),c&&d&&u&&p?function({scope:t,sectionId:e,productGroup:n,productLabel:o,variantOptions:i,product_object:r,variant_object:s,variant_config:a,config:l}){if("pdp"!==t)throw new Error("WWAI-ERROR ‚ùå Unknown scope type:",t);be({sectionId:e,productGroup:n,productLabel:o,variantOptions:i,productObject:r,variantObject:s,variantConfig:a,config:l}),he({sectionId:e,productGroup:n})}({scope:r,sectionId:t,productGroup:e,productLabel:a,variantOptions:l,product_object:u,variant_object:p,variant_config:d,config:s}):console.error("WWAI-ERROR ‚ùå No config, variant_config, product_object, or variant_object found for sectionId:",t,"productGroup:",e)}function xn({scope:t,sectionId:e,productGroup:o,productLabel:i,variantOptions:r,product_object:s,variant_object:a,variant_config:l,config:c}){switch(t){case"collection":case"pdp":kt({sectionId:e,productGroup:o,productLabel:i,variantOptions:r,productObject:s,variantObject:a,variantConfig:l,config:c});break;case"virtual_bundle":!function({sectionId:t,productGroup:e,bundlePayload:o}){const i=G(t,e,n.PRODUCT_GROUP.ADD_TO_CART);i&&("function"==typeof i.updateAddToCartFormWithBundlePayload?(console.log("üõí Bundle AddToCart Payload to be set:",o),i.updateAddToCartFormWithBundlePayload(o)):console.error("WWAI-ERROR ‚ùå <product-custom-add-to-cart-button-selector> is missing .updateAddToCartFormWithBundlePayload()"))}({sectionId:e,productGroup:o,bundlePayload:a});break;default:throw new Error("WWAI-ERROR ‚ùå Unknown scope type:",t)}}function $n(){window.addEventListener("pageshow",(t=>{t.persisted?(console.log("üîÅ Page restored from bfcache ‚Äî cleaning up loaders..."),_()):console.log("‚úÖ Page shown normally (not from bfcache).")})),window.addEventListener("load",(()=>{console.log("üì¶ Full page load ‚Äî running loader cleanup just in case..."),_()})),console.group("[WWAI] üîß Initializing Product Groups");Object.values(U).map((({sectionId:t,productGroup:e})=>({sectionId:t,productGroup:e}))).forEach(((t,e)=>function({sectionId:t,productGroup:e},o){console.group(`‚úÖ [${o+1}] Init: section="${t}", product_group="${e}"`);const i=G(t,e,n.PRODUCT_GROUP.VARIANT),r=G(t,e,n.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO);if(i&&r)throw new Error("WWAI-ERROR ‚ùå Both variant and variant purchase type combo selectors found for sectionId:",t,"productGroup:",e);if(r)return void Pn(t,e);const s=k(t,e,n.PRODUCT_GROUP.VARIANT),{config:a,variant_config:l,product_object:c,variant_object:d,productLabel:u,variantOptions:p}=Sn({sectionId:t,productGroup:e,variantSelector:i});a&&l&&c&&d?(xn({scope:s,sectionId:t,productGroup:e,productLabel:u,variantOptions:p,product_object:c,variant_object:d,variant_config:l,config:a}),console.groupEnd()):console.error("WWAI-ERROR ‚ùå No config, variant_config, product_object, or variant_object found for sectionId:",t,"productGroup:",e)}(t,e))),console.log("üîÑ Starting height equalization on load."),document.querySelectorAll(n.OTHER.PRODUCT_GRID_HEIGHT_EQUALIZER).forEach((t=>{const e=t.getBoundingClientRect();e.top<window.innerHeight&&e.bottom>0&&(console.log(`[${t.sectionId}] üü¢ Detected in view, running equalize now.`),t.equalize("immediate-on-load"))})),console.groupEnd()}function Dn(){console.log("üîÑ Initializing product data from JSON scripts..."),function(){const t=Re("wwai-static-product-section-data"),e=Re("wwai-static-liquid-product-mapping-array");window.__WWAI__SECTION_PRODUCT_DATA__=window.__WWAI__SECTION_PRODUCT_DATA__||{},window.__WWAI__SECTION_PRODUCT_DATA__.all_sections?console.warn("‚ö†Ô∏è SECTION_DATA.all_sections is already initialized. Skipping overwrite."):window.__WWAI__SECTION_PRODUCT_DATA__.all_sections=t,window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__=window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__||e}(),function(t=window.__WWAI__){const e=[],n={useMockSubscription:"boolean",deployMode:["local","sandbox","prod"],MODE:["dev","prod"],RENDER_WITH_LIQUID:"boolean",CONNECTOR_TYPE:["shopify"],heightEqualizeLogging:"boolean"};for(const[o,i]of Object.entries(n)){const n=t[o];Array.isArray(i)?i.includes(n)||e.push(`‚ùå ${o} must be one of [${i.join(", ")}], got "${n}"`):typeof n!==i&&e.push(`‚ùå ${o} must be of type ${i}, got ${typeof n}`)}if("string"!=typeof t.CURRENCY&&e.push("‚ùå CURRENCY must be a string, got "+typeof t.CURRENCY),"number"!=typeof t.CURRENCY_FACTOR&&e.push("‚ùå CURRENCY_FACTOR must be a number, got "+typeof t.CURRENCY_FACTOR),I(t.JS_PRODUCT_MAPPING_OBJECT)||e.push("‚ùå JS_PRODUCT_MAPPING_OBJECT must be an object"),I(t.WWAI_PRODUCT_GROUP_CONFIG)||e.push("‚ùå WWAI_PRODUCT_GROUP_CONFIG must be an object"),I(t.WWAI_PRODUCT_VARIANT_OVERRIDES)||e.push("‚ùå WWAI_PRODUCT_VARIANT_OVERRIDES must be an object"),I(t.WWAI_LABELED_IMAGES)||e.push("‚ùå WWAI_LABELED_IMAGES must be an object"),0===Object.keys(t.WWAI_PRODUCT_VARIANT_OVERRIDES||{}).length&&console.warn("‚ö†Ô∏è WWAI_PRODUCT_VARIANT_OVERRIDES is empty"),e.length>0)throw console.group("‚ùå WWAI Config Validation Failed:"),e.forEach((t=>console.warn(t))),console.groupEnd(),new Error("WWAI config validation failed");console.log("‚úÖ WWAI config validated successfully.")}(),console.log("‚úÖ Product data initialization complete")}function Un(){Object.entries(Te).forEach((([t,e])=>{document.querySelectorAll(t).forEach((n=>{n instanceof e||console.warn(`[WWAI] Element <${t}> is NOT an instance of its expected class.`)}))}));const t=function(){const t={};for(const e in n.PRODUCT_GROUP)if(Object.prototype.hasOwnProperty.call(n.PRODUCT_GROUP,e)){const o=n.PRODUCT_GROUP[e];bn[o]?t[o]=bn[o]:console.warn(`No debug function mapped for selector: ${o}`)}return t}();var e;e=t,Object.entries(e).forEach((([t,e])=>{document.querySelectorAll(t).forEach((t=>{e(t)}))})),en(E().RENDER_WITH_LIQUID),_n();const o=E();window.FUNCTIONALITY_DEBUG_MODE=o.MODE&&"dev"==o.MODE,window.FUNCTIONALITY_DEBUG_MODE&&console.log("üîß Functionality Debug Mode Enabled")}function Nn(){console.log("üöÄ Running Dispatch Logic..."),W();const t=document.querySelector(n.PRODUCT_VARIANT_SELECTOR);(async()=>{const{has_static_loaded_liquid_products:e,has_js_loaded_products:n}=function(t){const{merged:e,liquid_loaded:n,js_loaded:o}=Je(t);return{has_static_loaded_liquid_products:!Xe(n),has_js_loaded_products:!Xe(o)}}(E().RENDER_WITH_LIQUID);await async function(t,e,n){if(An(e),_storeDataApiInitialized)console.info("‚ö†Ô∏è initializeStoreDataViaApiCall() skipped (already initialized).");else{if(window._storeDataApiInitialized=!0,n)return console.log("Hydrating product group(s) via JS..."),void await Cn(t,n);console.log("No additional JS-based product groups to hydrate.")}}(E().CONNECTOR_TYPE,e,n),Be(t),$n(),console.log("Running Grid equalization from cache."),window.applyCachedHeightsOnLoad(),console.log("‚úÖ Product Groups Initialized Successfully")})()}function Wn(t,e,n=null){const o=Object.entries(t||{}).map((([t,e])=>function(t,e){if("object"==typeof e&&null!==e)return`\n      <details style="margin-bottom: 8px; border: 1px solid #eee; border-radius: 4px;" data-config-key="${t}">\n        <summary style="padding: 8px; cursor: pointer; font-weight: bold; background-color: #f8f9fa;">\n          ${t}\n        </summary>\n        <div style="padding: 8px;">\n          <textarea rows="4" data-config-field style="\n            width: 100%;\n            font-family: monospace;\n            font-size: 12px;\n            padding: 8px;\n            border: 1px solid #ccc;\n            border-radius: 4px;\n            resize: vertical;\n            background-color: #fafafa;\n          ">${JSON.stringify(e,null,2)}</textarea>\n        </div>\n      </details>\n    `;let n="";return n="string"==typeof e?`<input type="text" data-config-field value="${e}" style="width: 300px; padding: 6px 10px; font-family: monospace; font-size: 12px;" />`:"number"==typeof e?`<input type="number" data-config-field value="${e}" style="width: 150px; padding: 6px 10px; font-family: monospace; font-size: 12px;" />`:"boolean"==typeof e?`\n      <select data-config-field style="padding: 6px 10px; font-family: monospace; font-size: 12px;">\n        <option value="true" ${e?"selected":""}>true</option>\n        <option value="false" ${e?"":"selected"}>false</option>\n      </select>\n    `:'<span style="color: red;">Unsupported type</span>',`\n    <div style="margin-bottom: 12px; display: flex; align-items: center; gap: 12px;" data-config-key="${t}">\n      <label style="font-weight: bold; font-family: monospace; font-size: 12px; min-width: 200px;">${t}</label>\n      ${n}\n    </div>\n  `}(t,e))).join("");return n&&(window.wwaiConfigSnapshots=window.wwaiConfigSnapshots||{},window.wwaiConfigSnapshots[n]=structuredClone(t)),o||`<p style="color: #888; text-align: center; padding: 20px;">${e}</p>`}function Ln(t){const e=document.querySelector(t),n={};return e?(e.querySelectorAll("[data-config-key]").forEach((t=>{const e=t.getAttribute("data-config-key"),o=t.querySelector("[data-config-field]");if(o)if("TEXTAREA"===o.tagName)try{n[e]=JSON.parse(o.value)}catch(t){console.warn(`Invalid JSON in field for key: ${e}`),n[e]=null}else"SELECT"===o.tagName?n[e]="true"===o.value:"number"===o.type?n[e]=parseFloat(o.value):n[e]=o.value})),n):n}function Gn(t){return Ln(t)}function kn(t,e){const n=window.wwaiConfigSnapshots[t]||{},o=Ln(e),i={};for(const t of new Set([...Object.keys(n),...Object.keys(o)])){JSON.stringify(n[t])!==JSON.stringify(o[t])&&(i[t]={before:n[t],after:o[t]})}return i}function Mn(t,e){const n=Ln(e);window.wwaiConfigSnapshots[t]=structuredClone(n)}function qn(t){const e=function(t){const e=document.querySelectorAll('[id*="shopify-section-template"]');for(const n of e)if(n.id.includes(t))return n;return null}(t);e?(e.scrollIntoView({behavior:"smooth",block:"start"}),e.style.transition="background-color 0.3s ease",e.style.backgroundColor="#fff3cd",setTimeout((()=>{e.style.backgroundColor=""}),2e3),console.log(`‚úÖ Scrolled to section: ${t}`)):(console.warn(`‚ö†Ô∏è Section not found: ${t}`),alert(`Section "${t}" not found on the page.`))}window._storeDataApiInitialized=window._storeDataApiInitialized||!1,window.__wwai_discount_codes_applied=window.__wwai_discount_codes_applied||new Set,window.wwaiConfigSnapshots=window.wwaiConfigSnapshots||{},window.wwaiConfigPanelGetGeneralConfig=function(){const t=Gn("#tab-content-general");return console.log("üõ† Updated Config:",t),t},window.wwaiDiffGeneralConfig=function(){const t=kn("general-config","#tab-content-general");return console.log("ü™Ñ Config Diff:",t),t},window.wwaiSaveGeneralConfig=function(){Mn("general-config","#tab-content-general"),console.log("‚úÖ Saved updated config for snapshot: general-config")},window.wwaiConfigPanelGetProductMappingConfig=function(){const t=Gn("#tab-content-mapping");return console.log("üó∫Ô∏è Updated Product Mapping Config:",t),t},window.wwaiDiffProductMappingConfig=function(){const t=kn("product-mapping","#tab-content-mapping");return console.log("ü™Ñ Product Mapping Diff:",t),t},window.wwaiSaveProductMappingConfig=function(){Mn("product-mapping","#tab-content-mapping"),console.log("‚úÖ Saved updated config for snapshot: product-mapping")},window.scrollToSection=qn;const jn={discountPercent:"number",subscriptionDiscountPercent:"number",defaultSubscriptionOption:"string|null",discountCodeToApply:"array<string>",roundDiscount:"boolean",addOffSuffixToDiscount:"boolean"},Bn={destination:["checkout","cart","side-cart"],loader:["add-to-cart-submit-button","media-gallery"],showSuccessNotification:"boolean",showErrorNotification:"boolean",sideCartLabel:["","littlewords","rco","nwkw","kitsch","puracy","drmtlgy"],successNotificationMessage:"string",errorNotificationMessage:"string",notificationOptions:{backgroundColor:"string",textColor:"string",borderColor:"string",fontFamily:"string"}},Vn={variantOptionRemovePrefix:"string",defaultPurchaseType:["onetime","subscription"],variantUXConfig:{hideSingleLengthVariants:"boolean",onlyShowVariantsWithLabelContains:["string","null"],refreshUxOnVariantChange:"boolean"},preAddToCartFlowConfig:{journeyType:["custom-redirect","direct-add","redirect","overlay","na"],overlayContents:["array<string>","null"],postSelectionAction:["add-to-cart","redirect","na"],postSelectionActionParams:{custom_url:["string","null"],redirect_variant_options:["array<string>","null"]}}},Hn={defaultProduct:"string",defaultVariantOption1:["string","null"],defaultVariantOption2:["string","null"],defaultVariantOption3:["string","null"],allProducts:"string",allOptions:{option1:"string",option2:"string",option3:"string"}};function Fn(t,e){return"string"===e?"string"==typeof t:"number"===e?"number"==typeof t:"boolean"===e?"boolean"==typeof t:"null"===e?null===t:"string|null"===e?"string"==typeof t||null===t:"array<string>"===e&&(Array.isArray(t)&&t.every((t=>"string"==typeof t)))}function zn(t){if(!Array.isArray(t))return!1;const e=["string","number","boolean","null","array<string>"];return t.every((t=>e.includes(t)))}function Yn(t){if(!Array.isArray(t))return!1;const e=["string","number","boolean","null","array<string>"];return t.every((t=>!e.includes(t)))}function Jn(t,e){return 0===t.length?`<div style="color: green; font-weight: bold; margin-bottom: 8px;">${e} is valid.</div>`:`<div style="color: red; font-weight: bold; margin-bottom: 8px;">Invalid ${e}:<br>${t.join("<br>")}</div>`}function Xn(t,e,n=""){const o=[];if(t&&"object"==typeof t)for(const i in t)if(!(i in e)){const t=n?`${n}.${i}`:i;o.push(`${t} is not a valid field in the schema`)}for(const i in e){const r=n?`${n}.${i}`:i,s=e[i],a=t?.[i];if(Array.isArray(s))if(zn(s)){s.some((t=>Fn(a,t)))||o.push(`${r} must be one of types: ${s.join(", ")}`)}else if(Yn(s)){s.includes(a)||o.push(`${r} must be one of: ${s.join(", ")}`)}else{s.includes(a)||o.push(`${r} must be one of: ${s.join(", ")}`)}else"string"==typeof s?Fn(a,s)||o.push(`${r} must be of type ${s}`):"object"==typeof s&&("object"!=typeof a||null==a?o.push(`${r} must be an object`):o.push(...Xn(a,s,r)))}return o}function Qn(t,e,n,o=!1){return`\n        <div style="margin-bottom: 10px;">\n            <label style="font-weight: bold; font-size: 12px;">${t}:</label>\n            <input type="text" value="${n??""}" data-config-path="${e}" data-allow-null="${o}" onchange="window.wwaiProductGroupConfigOnChangeHandler(this)" />\n        </div>\n    `}function Zn(t,e,n,o=!1,i=""){return`\n        <div style="margin-bottom: 10px;">\n            <label style="font-weight: bold; font-size: 12px;">${t}:</label>\n            <input type="text" value="${n?n.join(", "):""}" data-config-path="${e}" data-allow-null="${o}" data-is-array="true" onchange="window.wwaiProductGroupConfigOnChangeHandler(this)" />\n            ${i?`<div style="font-size: 11px; color: #666;">${i}</div>`:""}\n        </div>\n    `}function Kn(t,e,n,o={}){const i=[];for(const[a,l]of Object.entries(t||{})){const t=e[a];if(t)if("object"!=typeof t||Array.isArray(t))i.push(to(a,l,e,n));else if(l){const e=Kn(l,t,`${n}.${a}`,o);i.push((r=a,s=e.join(""),`\n        <fieldset style="margin-top: 12px; padding: 8px; border: 1px dashed #999;">\n            <legend><strong>${r}</strong></legend>\n            ${s}\n        </fieldset>\n    `))}}var r,s;return i}function to(t,e,n,o){const i=`${o}.${t}`,r=n[t];if("string"==typeof r){const n={string:()=>Qn(t,i,e),number:()=>`\n        <div style="margin-bottom: 10px;">\n            <label style="font-weight: bold; font-size: 12px;">${t}:</label>\n            <input type="number" value="${e}" data-config-path="${i}" onchange="window.wwaiProductGroupConfigOnChangeHandler(this)" />\n        </div>\n    `,boolean:()=>{return`\n        <div style="margin-bottom: 10px;">\n            <label style="font-weight: bold; font-size: 12px;">${t}:</label>\n            <select data-config-path="${i}" onchange="window.wwaiProductGroupConfigOnChangeHandler(this)">\n                <option value="true" ${(n=e)?"selected":""}>true</option>\n                <option value="false" ${n?"":"selected"}>false</option>\n            </select>\n        </div>\n    `;var n},"string|null":()=>Qn(t,i,e,!0),"array<string>":()=>Zn(t,i,e,!1,"Comma-separated list")};return n[r]?n[r]():Qn(t,i,e)}if(Array.isArray(r)){const n=["string","number","boolean","null","array<string>","string|null"];if(r.every((t=>n.includes(t)))){return"array<string>"===r.find((t=>"null"!==t))?Zn(t,i,e,!0):Qn(t,i,e,!0)}return s=e,`\n        <div style="margin-bottom: 10px;">\n            <label style="font-weight: bold; font-size: 12px;">${t}:</label>\n            <select data-config-path="${i}" onchange="window.wwaiProductGroupConfigOnChangeHandler(this)">\n                ${r.map((t=>`<option value="${t}" ${t===s?"selected":""}>${t||"(empty)"}</option>`)).join("")}\n            </select>\n        </div>\n    `}return"object"==typeof r?function(t,e,n){return`\n        <div style="margin-bottom: 10px;">\n            <label style="font-weight: bold; font-size: 12px;">${t}:</label>\n            <textarea rows="3" data-config-path="${e}" onchange="window.wwaiProductGroupConfigOnChangeHandler(this)">${JSON.stringify(n,null,2)}</textarea>\n        </div>\n    `}(t,i,e):Qn(t,i,e);var s}function eo(t,e){const n=Jn(Xn(t,jn),"Pricing config"),o=function(t,e){return Kn(t,jn,e).join("")}(t,e);return n+o}function no(t,e){const n=Jn(Xn(t,Vn),"UX config"),o=function(t,e){const n=[],o=Kn(t,Vn,e);return n.push(...o),n.join("")}(t,e);return n+o}function oo(t,e){const n=Jn(Xn(t,Bn),"Flow config"),o=function(t,e){return Kn(t,Bn,e).join("")}(t,e);return n+o}function io(t,e,n){return`\n        <details style="margin-top: 10px; border: 1px solid #ddd; border-radius: 4px; padding: 8px;">\n            <summary style="cursor: pointer; font-weight: bold; padding: 4px 0;">\n                Defaults\n            </summary>\n            <div style="margin-top: 8px;">\n                ${function(t,e,n,o){const i=`${e}-${n}`;return`\n    <div class="wwai-config-tabs" style="margin-top: 12px;">\n    <div style="display: flex; gap: 12px; margin-bottom: 12px;">\n        <button onclick="window.showConfigTab('${e}', '${n}', 'pricing')">Pricing</button>\n        <button onclick="window.showConfigTab('${e}', '${n}', 'ux')">UX</button>\n        <button onclick="window.showConfigTab('${e}', '${n}', 'flow')">Flow</button>\n    </div>\n\n    <div id="tab-${i}-pricing">\n        ${eo(t.pricingConfig||{},`${o}.pricingConfig`)}\n    </div>\n    <div id="tab-${i}-ux" style="display: none;">\n        ${no(t.uxConfig||{},`${o}.uxConfig`)}\n    </div>\n    <div id="tab-${i}-flow" style="display: none;">\n        ${oo(t.flowConfig||{},`${o}.flowConfig`)}\n    </div>\n    </div>\n    `}(e,t,"default",n)}\n            </div>\n        </details>\n    `}function ro(t,e,n,o){const i=JSON.stringify(o??{},null,2),r=null!=e?JSON.stringify(e,null,2):"";return`\n    <div style="margin-top: 8px;">\n      <span style="font-weight: bold; cursor: pointer;">${t}</span>\n\n      ${null==e?`<button onclick="window.copyDefaultToTextarea(this)" data-defaults="${i.replace(/"/g,"&quot;")}" style="margin-bottom: 8px;">Copy defaults to override</button>`:""}\n\n      <textarea\n        data-config-path="${n}"\n        data-is-json="true"\n        oninput="window.wwaiProductGroupConfigOnChangeHandler(this)"\n        style="width: 100%; min-height: 140px; font-family: monospace; font-size: 13px;"\n      >${r}</textarea>\n    </div>\n  `}function so(t,e){const n=Jn(Xn(t,Hn),"Variant Dispatch config"),o=function(t,e){return Kn(t,Hn,e).join("")}(t,e);return n+o}function ao(t,e,n){const o=t.map((([t,o])=>`\n    <details style="margin-bottom: 12px; border: 1px solid #ccc; border-radius: 6px; padding: 8px;">\n      <summary style="cursor: pointer; font-weight: bold;">\n        Product Group: <code>${t}</code>\n      </summary>\n      ${function(t,e,n,o){const i=`group-${n.replace(/[^a-zA-Z0-9]/g,"-")}`;return`\n        <div style="margin-top: 12px; padding: 8px; border: 1px dashed #ccc; border-radius: 4px;">\n            <div style="font-weight: bold; margin-bottom: 12px;">Product Group: <code>${t}</code></div>\n            \n            <div style="border-bottom: 1px solid #ddd; margin-bottom: 12px;">\n                <button class="tab-button active" onclick="window.switchTabForProductGroupConfig('${i}', 'variant-dispatch')" data-tab="variant-dispatch" style="background: #0070f3; color: white; border: none; padding: 8px 16px; margin-right: 4px; border-radius: 4px 4px 0 0; cursor: pointer;">Variant Dispatch</button>\n                <button class="tab-button" onclick="window.switchTabForProductGroupConfig('${i}', 'pricing')" data-tab="pricing" style="background: #f0f0f0; color: #333; border: none; padding: 8px 16px; margin-right: 4px; border-radius: 4px 4px 0 0; cursor: pointer;">Pricing</button>\n                <button class="tab-button" onclick="window.switchTabForProductGroupConfig('${i}', 'ux')" data-tab="ux" style="background: #f0f0f0; color: #333; border: none; padding: 8px 16px; margin-right: 4px; border-radius: 4px 4px 0 0; cursor: pointer;">UX</button>\n                <button class="tab-button" onclick="window.switchTabForProductGroupConfig('${i}', 'flow')" data-tab="flow" style="background: #f0f0f0; color: #333; border: none; padding: 8px 16px; margin-right: 4px; border-radius: 4px 4px 0 0; cursor: pointer;">Flow</button>\n            </div>\n            \n            <div id="${i}-variant-dispatch" class="tab-content" style="display: block;">\n                ${so(e.variantDispatchConfig,n+".variantDispatchConfig")}\n            </div>\n\n            <div id="${i}-pricing" class="tab-content" style="display: none;">\n                ${ro("pricingConfig",e.pricingConfig,n+".pricingConfig",o.pricingConfig)}\n            </div>\n            \n            <div id="${i}-ux" class="tab-content" style="display: none;">\n                ${ro("uxConfig",e.uxConfig,n+".uxConfig",o.uxConfig)}\n            </div>\n            \n            <div id="${i}-flow" class="tab-content" style="display: none;">\n                ${ro("flowConfig",e.flowConfig,n+".flowConfig",o.flowConfig)}\n            </div>\n        </div>\n    `}(t,o,`${e}.${t}`,n)}\n    </details>\n    `)).join("");return`\n    <div style="margin-top: 16px;">\n      <strong>Product Groups</strong>\n      ${o||'<p style="color: #888;">No product group overrides defined.</p>'}\n    </div>\n  `}function lo(t={}){const e=function(t){return new Set([...Object.keys(t||{})])}(t);return[...e].map(((e,n)=>function(t,e,n,o){const i=e.defaults||{},r=Object.entries(e).filter((([t])=>"defaults"!==t));return`\n      <details style="margin-bottom: 16px; border: 1px solid #eee; padding: 12px; border-radius: 6px;">\n        <summary style="cursor: pointer; font-weight: bold; font-size: 15px;">\n          ${function(t,e){return`\n    <div style="display: flex; align-items: center; flex-wrap: wrap; gap: 8px; font-family: 'Inter', sans-serif;">\n      <span style="background-color: #0070f3; color: white; padding: 4px 8px; border-radius: 999px; font-size: 12px; font-weight: 500;">\n        #${e}\n      </span>\n      <code style="background-color: #f5f5f5; padding: 2px 6px; border-radius: 4px; font-size: 13px; font-family: monospace;">\n        ${t}\n      </code>\n      ${function(t){return`\n      <button \n        onclick="window.scrollToSection('${t}')" \n        style="\n          margin-left: 8px; \n          padding: 2px 6px; \n          font-size: 10px; \n          background-color: #0070f3; \n          color: white; \n          border: none; \n          border-radius: 3px; \n          cursor: pointer;\n          vertical-align: middle;\n        "\n        title="Go to section on page"\n      >\n        Go\n      </button>\n    `}(t)}\n    </div>\n  `}(t,n)}\n        </summary>\n        ${io(t,i,o+".defaults")}\n        ${ao(r,t,i)}\n      </details>\n    `}(e,t[e]||{},n+1,e))).join("\n")}function co(t={}){return window.wwaiConfigSnapshots=window.wwaiConfigSnapshots||{},window.wwaiConfigSnapshots["grouped-section-config"]=structuredClone(t),`<div id="tab-content-group" class="wwai-tab-content" style="display: none;">\n      <div style="margin-bottom: 20px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">\n        <div style="font-weight: bold; margin-bottom: 12px; color: #495057;">Configuration Actions</div>\n        <div style="display: flex; gap: 8px; flex-wrap: wrap;">\n          <button onclick="console.log('üìä Current Config:', window.wwaiConfigPanelGetGroupedSectionConfig())" \n                  style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n            Log Config\n          </button>\n          <button onclick="window.wwaiSaveGroupedSectionConfig()" \n                  style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n            Save Changes\n          </button>\n          <button onclick="console.log('üîç Changes Diff:', window.wwaiDiffGroupedSectionConfig())" \n                  style="background: #ffc107; color: #212529; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n            Show Diff\n          </button>\n        </div>\n      </div>\n      ${lo(t)}\n    </div>`}function uo(t){const e=JSON.stringify(t,null,2);return window.wwaiConfigSnapshots=window.wwaiConfigSnapshots||{},window.wwaiConfigSnapshots["labeled-images"]=structuredClone(t),`\n        <div id="tab-content-images" class="wwai-tab-content" style="display: none;">\n        <button onclick="window.wwaiConfigPanelGetLabeledImagesConfig()">Log Config</button>\n        <button onclick="window.wwaiDiffLabeledImagesConfig()">Diff</button>\n        <button onclick="window.wwaiSaveLabeledImagesConfig()">Save Config</button>\n        <div style="margin: 20px 0;">\n            <label for="wwai-labeled-images-textarea" style="display: block; margin-bottom: 10px; font-weight: bold;">Labeled Images Configuration (JSON):</label>\n            <textarea \n                id="wwai-labeled-images-textarea" \n                style="width: 100%; height: 400px; font-family: monospace; padding: 10px; border: 1px solid #ccc; border-radius: 4px;"\n                placeholder="Enter labeled images configuration as JSON..."\n            >${e}</textarea>\n        </div>\n        </div>\n    `}function po(t,e,n,o){const i=Object.entries(t),r=i.map((([t,i])=>function(t,e,n){return`\n        <div style="margin-top: 8px; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; background: #fafafa;">\n            <div style="font-weight: bold; margin-bottom: 8px; color: #333;">\n                Configuration for: <code>${t}</code>\n            </div>\n            <textarea \n                data-config-path="${n}"\n                data-is-json="true"\n                oninput="window.wwaiVariantOverridesConfigOnChangeHandler(this)"\n                style="width: 100%; min-height: 120px; font-family: monospace; font-size: 12px; padding: 8px; border: 1px solid #ccc; border-radius: 4px;"\n                placeholder="Enter variant override configuration as JSON..."\n            >${JSON.stringify(e,null,2)}</textarea>\n        </div>\n    `}(t,i,`${e}.${n}.${o}.${t}`))).join("");return`\n        <details style="margin-bottom: 12px; border: 1px solid #e0e0e0; border-radius: 6px; padding: 8px;">\n            <summary style="cursor: pointer; font-weight: bold; color: #666;">\n                Variants (${i.length})\n            </summary>\n            <div style="margin-top: 12px;">\n                ${r||'<p style="color: #888; font-style: italic;">No product label configurations defined.</p>'}\n            </div>\n        </details>\n    `}function go(t,e,n){const o=Object.entries(e).map((([e,n])=>function(t,e,n){const o=Object.entries(e).map((([e,o])=>po(o,n,t,e))).join("");return`\n        <details style="margin-bottom: 12px; border: 1px solid #ddd; border-radius: 6px; padding: 8px;">\n            <summary style="cursor: pointer; font-weight: bold; color: #555;">\n                Product Group: <code>${t}</code>\n            </summary>\n            <div style="margin-top: 12px;">\n                ${o||'<p style="color: #888; font-style: italic;">No product label overrides defined.</p>'}\n            </div>\n        </details>\n    `}(e,n,t))).join("");return`\n        <details style="margin-bottom: 16px; border: 1px solid #eee; padding: 12px; border-radius: 6px;">\n            <summary style="cursor: pointer; font-weight: bold; font-size: 15px;">\n                <div style="display: flex; align-items: center; gap: 8px;">\n                    <span style="background-color: #0070f3; color: white; padding: 4px 8px; border-radius: 999px; font-size: 12px; font-weight: 500;">\n                        #${n}\n                    </span>\n                    <code style="background-color: #f5f5f5; padding: 2px 6px; border-radius: 4px; font-size: 13px; font-family: monospace;">\n                        ${t}\n                    </code>\n                </div>\n            </summary>\n            <div style="margin-top: 12px;">\n                ${o||'<p style="color: #888; font-style: italic;">No product group overrides defined for this section.</p>'}\n            </div>\n        </details>\n    `}function fo(t){return window.wwaiConfigSnapshots=window.wwaiConfigSnapshots||{},window.wwaiConfigSnapshots["variant-overrides"]=structuredClone(t),`\n        <div id="tab-content-variant_overrides" class="wwai-tab-content" style="display: none;">\n            <div style="margin-bottom: 20px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">\n                <div style="font-weight: bold; margin-bottom: 12px; color: #495057;">Configuration Actions</div>\n                <div style="display: flex; gap: 8px; flex-wrap: wrap;">\n                    <button onclick="window.wwaiConfigPanelLogVariantOverridesConfig()" \n                            style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n                        Log Config\n                    </button>\n                    <button onclick="window.wwaiDiffVariantOverridesConfig()" \n                            style="background: #ffc107; color: #212529; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n                        Show Diff\n                    </button>\n                    <button onclick="window.wwaiSaveVariantOverridesConfig()" \n                            style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n                        Save Changes\n                    </button>\n                </div>\n            </div>\n            <div style="margin-top: 16px;">\n                ${function(t={}){const e=Object.entries(t);return 0===e.length?'<p style="color: #888; font-style: italic; text-align: center; padding: 20px;">No variant overrides configured.</p>':e.map((([t,e],n)=>go(t,e,n+1))).join("")}(t)}\n            </div>\n        </div>\n    `}function ho(){const t={groupedSectionConfig:window.wwaiConfigPanelGetGroupedSectionConfig(),productMappingConfig:window.wwaiConfigPanelGetProductMappingConfig(),labeledImagesConfig:window.wwaiConfigPanelGetLabeledImagesConfig(),variantOverridesConfig:window.wwaiConfigPanelGetVariantOverridesConfig(),generalConfig:window.wwaiConfigPanelGetGeneralConfig()};return{JS_PRODUCT_MAPPING_OBJECT:t.productMappingConfig,WWAI_PRODUCT_GROUP_CONFIG:t.groupedSectionConfig,WWAI_PRODUCT_VARIANT_OVERRIDES:t.variantOverridesConfig,WWAI_LABELED_IMAGES:t.labeledImagesConfig,...t.generalConfig}}function bo(){return{groupedSectionConfig:window.wwaiDiffGroupedSectionConfig(),productMappingConfig:window.wwaiDiffProductMappingConfig(),labeledImagesConfig:window.wwaiDiffLabeledImagesConfig(),variantOverridesConfig:window.wwaiDiffVariantOverridesConfig(),generalConfig:window.wwaiDiffGeneralConfig()}}function mo(){window.wwaiSaveGroupedSectionConfig(),window.wwaiSaveProductMappingConfig(),window.wwaiSaveLabeledImagesConfig(),window.wwaiSaveVariantOverridesConfig(),window.wwaiSaveGeneralConfig();const t=ho();return window.__WWAI__=t,Dn(),Nn(),!0}function wo(t){const e=Object.entries(t),n=e.some((([t,e])=>e&&Object.keys(e).length>0)),o=n?e.map((([t,e])=>{if(!e||0===Object.keys(e).length)return"";const n=Object.entries(e).map((([t,e])=>{const{before:n,after:o}=e;let i="";if(void 0===n&&void 0!==o)i=`Added: ${JSON.stringify(o,null,2)}`;else if(void 0!==n&&void 0===o)i=`Removed: ${JSON.stringify(n,null,2)}`;else{if(JSON.stringify(n)===JSON.stringify(o))return"";i=`Modified: ${JSON.stringify(n,null,2)} => ${JSON.stringify(o,null,2)}`}return`\n            <div style="margin-bottom: 8px; padding: 8px; border-radius: 4px; background-color: #f8f9fa; border-left: 3px solid #0070f3;">\n                <strong style="color: #0070f3;">${t}</strong>\n                <div style="margin-top: 4px; font-family: monospace; font-size: 11px; color: #666;">\n                ${i}\n                </div>\n            </div>\n            `})).filter((t=>""!==t)).join("");return""===n?"":`\n        <div style="margin-bottom: 16px; border: 1px solid #e0e0e0; border-radius: 6px; padding: 12px;">\n            <h4 style="margin: 0 0 12px 0; color: #333; font-size: 14px; font-weight: bold;">\n                ${function(t){return{groupedSectionConfig:"Group & Variant Config",productMappingConfig:"Product Mapping",labeledImagesConfig:"Labeled Images",variantOverridesConfig:"Variant Overrides",generalConfig:"General Config"}[t]||t}(t)}\n            </h4>\n            ${n}\n        </div>\n        `})).filter((t=>""!==t)).join(""):'<p style="color: #666; text-align: center; padding: 20px;">No changes detected - configs are identical</p>';return`\n        <div id="wwai-diff-modal" style="\n        position: fixed; \n        top: 50%; \n        left: 50%; \n        transform: translate(-50%, -50%); \n        background: white; \n        border: 1px solid #ddd; \n        border-radius: 8px; \n        padding: 20px; \n        width: 800px; \n        max-height: 80vh; \n        overflow-y: auto; \n        z-index: 10003;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n        ">\n        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">\n            <h3 style="margin: 0;">Config Management</h3>\n            <button id="wwai-close-diff" style="background: none; border: none; font-size: 18px; cursor: pointer; padding: 4px;">&times;</button>\n        </div>\n        \n        \x3c!-- Tab Navigation --\x3e\n        <div style="display: flex; gap: 4px; border-bottom: 1px solid #eee; padding: 8px 0; margin-bottom: 16px;">\n            <button id="wwai-tab-diff" class="wwai-modal-tab-btn active" style="background: #0070f3; color: white; border: none; padding: 8px 16px; border-radius: 4px 4px 0 0; cursor: pointer; font-size: 13px;">Diff & Save</button>\n            <button id="wwai-tab-config" class="wwai-modal-tab-btn" style="background: #f0f0f0; color: #333; border: none; padding: 8px 16px; border-radius: 4px 4px 0 0; cursor: pointer; font-size: 13px;">Config String</button>\n        </div>\n        \n        \x3c!-- Diff Tab Content --\x3e\n        <div id="wwai-tab-content-diff" class="wwai-modal-tab-content">\n            <div style="margin-bottom: 16px;">\n                <strong>Total Changes: ${e.reduce(((t,[e,n])=>n?t+Object.keys(n).length:t),0)}</strong>\n            </div>\n            \n            <div style="margin-bottom: 20px; max-height: 400px; overflow-y: auto;">\n                ${o}\n            </div>\n            \n            <div style="display: flex; gap: 8px; justify-content: flex-end;">\n                <button id="wwai-cancel-diff" style="padding: 8px 16px; background-color: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer;">Close</button>\n                ${n?'<button id="wwai-confirm-diff" style="padding: 8px 16px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">Apply Changes</button>':""}\n            </div>\n        </div>\n        \n        \x3c!-- Config String Tab Content --\x3e\n        <div id="wwai-tab-content-config" class="wwai-modal-tab-content" style="display: none;">\n            <div style="margin-bottom: 16px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">\n                <div style="font-weight: bold; margin-bottom: 12px; color: #495057;">Config String Actions</div>\n                <div style="display: flex; gap: 8px; flex-wrap: wrap;">\n                    <button id="wwai-copy-config-string" \n                            style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n                        Copy to Clipboard\n                    </button>\n                    <button id="wwai-log-config-string" \n                            style="background: #ffc107; color: #212529; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n                        Log to Console\n                    </button>\n                </div>\n            </div>\n            \n            <div style="margin-top: 16px;">\n                <label for="wwai-config-string-textarea" style="display: block; margin-bottom: 10px; font-weight: bold;">Current Config String:</label>\n                <textarea \n                    id="wwai-config-string-textarea" \n                    style="width: 100%; height: 400px; font-family: monospace; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 11px;"\n                    readonly\n                >${function(){const t=ho(),e=window.wwaiConfigPanelGetGeneralConfig?window.wwaiConfigPanelGetGeneralConfig():{},n={useMockSubscription:"Use metafield-based subscription in sandbox/local",deployMode:'Options: "local" | "sandbox" | "prod"',MODE:"Enables dev/debugger mode, values are dev, prod",RENDER_WITH_LIQUID:"Controls Liquid-product rendering",CONNECTOR_TYPE:"Which connector to use for hydration",heightEqualizeLogging:"Enable logging for grid height debugging",CURRENCY:"Active currency from Shopify",CURRENCY_FACTOR:"Currency conversion factor"},o=["useMockSubscription","deployMode","MODE","RENDER_WITH_LIQUID","CONNECTOR_TYPE","heightEqualizeLogging","CURRENCY","CURRENCY_FACTOR"].map((o=>{let i;return"CURRENCY"===o?i="Shopify.currency.active":(i=e[o]??t[o],i=JSON.stringify(i)),`// ${n[o]}\nwindow.__WWAI__.${o} = ${i};`}));return`window.__WWAI__ = window.__WWAI__ || {};\n    \n// Environment + Mode Config\n${o.slice(0,6).join("\n\n")}\n\n// Currency Config\n${o.slice(6).join("\n\n")}\n\n// Product mapping object\nwindow.__WWAI__.JS_PRODUCT_MAPPING_OBJECT = ${JSON.stringify(t.JS_PRODUCT_MAPPING_OBJECT,null,2)};\n\n// Product group config\nwindow.__WWAI__.WWAI_PRODUCT_GROUP_CONFIG = ${JSON.stringify(t.WWAI_PRODUCT_GROUP_CONFIG,null,2)};\n\n// Variant overrides\nwindow.__WWAI__.WWAI_PRODUCT_VARIANT_OVERRIDES = ${JSON.stringify(t.WWAI_PRODUCT_VARIANT_OVERRIDES,null,2)};\n\n// Labeled images\nwindow.__WWAI__.WWAI_LABELED_IMAGES = ${JSON.stringify(t.WWAI_LABELED_IMAGES,null,2)};\n\n// Action buttons\nwindow.__WWAI__.WWAI_ACTION_BUTTONS = ${JSON.stringify(window.__WWAI__.WWAI_ACTION_BUTTONS,null,2)};\n`}()}</textarea>\n            </div>\n        </div>\n        </div>\n        <div id="wwai-diff-overlay" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 10002;"></div>\n    `}function _o(t,e){const n=wo(t);document.body.insertAdjacentHTML("beforeend",n);const o=document.getElementById("wwai-diff-modal"),i=document.getElementById("wwai-diff-overlay");!function(){const t=document.querySelectorAll(".wwai-modal-tab-btn"),e=document.querySelectorAll(".wwai-modal-tab-content");t.forEach((n=>{n.onclick=()=>{const o=n.getAttribute("id").replace("wwai-tab-","");t.forEach((t=>{t.style.background="#f0f0f0",t.style.color="#333"})),n.style.background="#0070f3",n.style.color="white",e.forEach((t=>{t.style.display=t.id===`wwai-tab-content-${o}`?"block":"none"}))}}))}();const r=()=>{o&&o.remove(),i&&i.remove()},s=document.getElementById("wwai-close-diff");s&&(s.onclick=r);const a=document.getElementById("wwai-cancel-diff");a&&(a.onclick=r);const l=document.getElementById("wwai-confirm-diff");l&&(l.onclick=()=>{if(e()){r();const t=document.querySelector("#wwai-save-status");t&&(t.textContent="‚úÖ Applied successfully!",t.style.color="#28a745",setTimeout((()=>{t.textContent=""}),3e3))}});const c=document.getElementById("wwai-copy-config-string");c&&(c.onclick=()=>{const t=document.getElementById("wwai-config-string-textarea");if(t){t.select(),t.setSelectionRange(0,99999);try{document.execCommand("copy"),console.log("‚úÖ Config string copied to clipboard");const t=c.textContent;c.textContent="Copied!",c.style.background="#28a745",setTimeout((()=>{c.textContent=t,c.style.background="#007bff"}),2e3)}catch(t){console.error("‚ùå Failed to copy to clipboard:",t)}}});const d=document.getElementById("wwai-log-config-string");d&&(d.onclick=()=>{const t=document.getElementById("wwai-config-string-textarea");t&&console.log("üìã Current Config String:",t.value)}),i&&(i.onclick=r);const u=t=>{"Escape"===t.key&&(r(),document.removeEventListener("keydown",u))};document.addEventListener("keydown",u)}function yo(){function t(t){t.querySelector("#wwai-close-btn").onclick=()=>t.remove(),function(t){const e=t.querySelectorAll(".wwai-tab-btn"),n=t.querySelectorAll(".wwai-tab-content");e.forEach((t=>{t.onclick=()=>{const o=t.getAttribute("data-tab");n.forEach((t=>{t.style.display=t.id===`tab-content-${o}`?"block":"none"})),e.forEach((t=>t.classList.remove("active-tab"))),t.classList.add("active-tab")}})),e[0].click()}(t),function(t,e,n,o){const i=t.querySelector("#wwai-save-btn"),r=t.querySelector("#wwai-save-status");i.onclick=()=>{r.textContent="Analyzing changes...",r.style.color="#0070f3";try{const t=window.__WWAI__||{},i=o();console.log("Old config:",t),console.log("New config:",i);const s=n();console.log("Diff result:",s),r.textContent="",_o(s,e)}catch(t){console.error("Error analyzing config:",t),r.textContent="‚ùå Error: "+t.message,r.style.color="#dc3545"}}}(t,mo,bo,ho);const n=t.querySelector("#wwai-button-highlight-toggle"),o=t.querySelector("#wwai-highlight-status");n&&o&&(n.checked=!!window.wwaiIsButtonHighlightingActive&&window.wwaiIsButtonHighlightingActive(),e(o,n.checked),n.addEventListener("change",(t=>{const n=t.target.checked;window.wwaiToggleButtonHighlighting&&(window.wwaiToggleButtonHighlighting(n),e(o,n))})))}function e(t,e){t&&(t.textContent=e?"üü¢ Active":"‚ö™ Inactive",t.style.color=e?"#28a745":"#666")}function n(){if(document.getElementById("wwai-config-side-panel"))return;const e=document.createElement("div");e.id="wwai-config-side-panel",Object.assign(e.style,{position:"fixed",top:"0",right:"0",width:"480px",height:"100vh",backgroundColor:"#fff",boxShadow:"-2px 0 8px rgba(0, 0, 0, 0.1)",zIndex:"10002",padding:"0",fontFamily:"sans-serif",fontSize:"14px",color:"#333",borderLeft:"1px solid #e0e0e0",display:"flex",flexDirection:"column"});const n=function(){const{JS_PRODUCT_MAPPING_OBJECT:t,WWAI_PRODUCT_GROUP_CONFIG:e,WWAI_PRODUCT_VARIANT_OVERRIDES:n,WWAI_LABELED_IMAGES:o,...i}=E()||{};return{JS_PRODUCT_MAPPING_OBJECT:t,WWAI_PRODUCT_GROUP_CONFIG:e,WWAI_PRODUCT_VARIANT_OVERRIDES:n,WWAI_LABELED_IMAGES:o,filteredConfig:i}}();e.innerHTML=function(t){const e=[(o=t.filteredConfig,`\n        <div id="tab-content-general" class="wwai-tab-content" style="display: none;">\n            <button onclick="window.wwaiConfigPanelGetGeneralConfig()">Log Config</button>\n            <button onclick="window.wwaiDiffGeneralConfig()"> Diff</button>\n            <button onclick="window.wwaiSaveGeneralConfig()">Save Config</button>\n        ${Wn(o,"No general config data available.","general-config")}\n        </div>\n    `),(n=t.JS_PRODUCT_MAPPING_OBJECT,`\n        <div id="tab-content-mapping" class="wwai-tab-content" style="display: none;">\n        <button onclick="window.wwaiConfigPanelGetProductMappingConfig()">Log Config</button>\n        <button onclick="window.wwaiDiffProductMappingConfig()">Diff</button>\n        <button onclick="window.wwaiSaveProductMappingConfig()">Save Config</button>\n        ${Wn(n,"No product mapping data available.","product-mapping")}\n        </div>\n    `),co(t.WWAI_PRODUCT_GROUP_CONFIG),uo(t.WWAI_LABELED_IMAGES),fo(t.WWAI_PRODUCT_VARIANT_OVERRIDES)].join("");var n,o;return`\n        \n      <div style="padding: 16px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee;">\n        <strong>WWAI Config Panel</strong>\n        <button id="wwai-close-btn" style="background: none; border: none; font-size: 18px; cursor: pointer;">&times;</button>\n      </div>\n    \n        \n        <div style="display: flex; gap: 4px; border-bottom: 1px solid #eee; padding: 8px 16px;">\n        ${[{id:"general",label:"General Config"},{id:"mapping",label:"Product Mapping"},{id:"group",label:"Group + Variant Config"},{id:"images",label:"Labeled Images"},{id:"variant_overrides",label:"Variant Overrides"}].map((t=>`<button data-tab="${t.id}" class="wwai-tab-btn">${t.label}</button>`)).join("")}\n        </div>\n    \n        <div id="wwai-tab-container" style="flex: 1; padding: 16px; overflow-y: auto;">\n        ${e}\n        </div>\n        \n        <div style="padding: 16px; border-top: 1px solid #eee;">\n            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">\n                <div style="display: flex; align-items: center; gap: 8px;">\n                    <label style="font-size: 14px; font-weight: 500; cursor: pointer;">\n                        <input type="checkbox" id="wwai-button-highlight-toggle" style="margin-right: 6px;">\n                        Button Highlighting\n                    </label>\n                </div>\n                <span id="wwai-highlight-status" style="font-size: 12px; color: #666;"></span>\n            </div>\n            <button id="wwai-save-btn" style="padding: 8px 12px; background-color: #0070f3; color: white; border: none; border-radius: 4px; cursor: pointer;">Preview Changes</button>\n            <span id="wwai-save-status" style="margin-left: 10px; font-size: 12px; color: #666;"></span>\n        </div>\n    \n    `}(n),t(e),document.body.appendChild(e)}if(!document.getElementById("wwai-toggle-panel-button")){const t=function(){const t=document.createElement("button");return t.id="wwai-toggle-panel-button",t.innerText="Config",Object.assign(t.style,{position:"fixed",bottom:"20px",right:"20px",zIndex:"10001",padding:"10px 14px",backgroundColor:"#333",color:"#fff",border:"none",borderRadius:"6px",cursor:"pointer",boxShadow:"0 2px 6px rgba(0,0,0,0.15)",fontSize:"14px",fontFamily:"sans-serif"}),t}();t.onclick=()=>n(),document.body.appendChild(t)}}function vo(){const t=window.__WWAI__?.WWAI_ACTION_BUTTONS||{};let e=!0;"prod"===window.__WWAI__.deployMode&&(e=!1);const n=e?t:function(t){const e=t=>t.replace(/\/\/div\[@id="shopify-section-template--\d+__([^"]+)"\]/g,((t,e)=>`//div[@id="shopify-section-template--${e}"]`)),n={};for(const[o,i]of Object.entries(t)){const t=e(o),r="scroll-to"===i.actionType&&"string"==typeof i.value?i.value.replace(/shopify-section-template--\d+__/,"shopify-section-template--"):i.value;n[t]={actionType:i.actionType,value:r}}return n}(t);Object.entries(n).forEach((([t,{actionType:e,value:n}])=>{const o=(t=>{try{return document.evaluate(t,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}catch(e){return console.warn("Invalid XPath:",t),null}})(t);if(!o)return;const i=()=>!0===window.wwaiIsButtonHighlightingActive?.();i()?console.log("Skipping action:",e,n):(console.log("Applying action:",e,n),"no-action"===e?(o.setAttribute("href","javascript:void(0)"),o.onclick=t=>{i()||t.preventDefault()}):"custom-url"===e?(o.setAttribute("href",n),o.onclick=t=>{i()}):"scroll-to"===e&&(o.setAttribute("href","javascript:void(0)"),o.onclick=t=>{if(i())return;t.preventDefault();const e=document.getElementById(n);e&&e.scrollIntoView({behavior:"smooth"})}))}))}window.showConfigTab=function(t,e,n){["pricing","ux","flow"].forEach((o=>{const i=document.getElementById(`tab-${t}-${e}-${o}`);i&&(i.style.display=o===n?"block":"none")}))},window.copyDefaultToTextarea=function(t){const e=t.nextElementSibling,n=t.getAttribute("data-defaults");n&&(e.value=n,e.dispatchEvent(new Event("input",{bubbles:!0})),t.remove())},window.switchTabForProductGroupConfig=function(t,e){document.querySelectorAll(`[id^="${t}-"]`).forEach((t=>{t.style.display="none"}));const n=document.getElementById(`${t}-${e}`);n&&(n.style.display="block");document.querySelectorAll(`[onclick*="${t}"]`).forEach((t=>{t.getAttribute("data-tab")===e?(t.style.background="#0070f3",t.style.color="white"):(t.style.background="#f0f0f0",t.style.color="#333")}))},window._wwaiProductGroupConfigChanges={},window.wwaiProductGroupChangeHandler=function(t,e){window._wwaiProductGroupConfigChanges[t]=e,console.log("[ChangeTracker]",t,"=>",e)},window.wwaiProductGroupConfigOnChangeHandler=function(t){const e=t.getAttribute("data-config-path"),n="true"===t.getAttribute("data-is-array"),o="true"===t.getAttribute("data-is-json"),i="true"===t.getAttribute("data-allow-null"),r=t.value;if(i&&""===r)return window.wwaiProductGroupChangeHandler(e,null);let s;try{s=o?JSON.parse(r):n?r.split(",").map((t=>t.trim())):""!==r.trim()&&!isNaN(r)&&Number.isInteger(Number(r))?Number(r):r,window.wwaiProductGroupChangeHandler(e,s)}catch(t){console.warn("Parsing failed for",e,t)}},window.wwaiDiffGroupedSectionConfig=function(){const t="grouped-section-config",e=window.wwaiConfigSnapshots?.[t],n=window._wwaiProductGroupConfigChanges||{};if(!e)return console.warn("No snapshot found for",t),{};const o={};return Object.entries(n).forEach((([t,n])=>{let i=null;try{const n=t.split(".");let o=e;for(let t=0;t<n.length;t++){if(!o||"object"!=typeof o||!(n[t]in o)){o=void 0;break}o=o[n[t]]}i=o}catch(e){console.warn("Could not get original value for path:",t)}i!==n&&(o[t]={before:i,after:n})})),o},window.wwaiConfigPanelGetGroupedSectionConfig=function(){const t="grouped-section-config",e=window.wwaiConfigSnapshots?.[t],n=window._wwaiProductGroupConfigChanges||{};if(!e)return console.warn("No snapshot found for",t),{};const o=structuredClone(e);return Object.entries(n).forEach((([t,e])=>{try{const n=t.split(".");let i=o;for(let t=0;t<n.length-1;t++){const e=n[t];e in i||(i[e]={}),i=i[e]}i[n[n.length-1]]=e,console.log(`Applied change: ${t} =`,e)}catch(e){console.error(`Failed to apply change for path: ${t}`,e)}})),o},window.wwaiSaveGroupedSectionConfig=function(){const t="grouped-section-config",e=window.wwaiConfigPanelGetGroupedSectionConfig();window.wwaiConfigSnapshots[t]=structuredClone(e),window._wwaiProductGroupConfigChanges={},console.log("‚úÖ Saved grouped section config changes to snapshot"),console.log("üìä Updated snapshot:",window.wwaiConfigSnapshots[t])},window.wwaiConfigPanelGetLabeledImagesConfig=function(){const t=document.getElementById("wwai-labeled-images-textarea");if(!t)return console.error("‚ùå Labeled images textarea not found"),{};try{const e=JSON.parse(t.value);return console.log("üñºÔ∏è Updated Labeled Images Config:",e),e}catch(t){console.error("‚ùå Invalid JSON in labeled images textarea:",t)}return{}},window.wwaiDiffLabeledImagesConfig=function(){const t=document.getElementById("wwai-labeled-images-textarea");if(t)try{const e=JSON.parse(t.value),n=window.wwaiConfigSnapshots?.["labeled-images"]||{};if(JSON.stringify(n)!==JSON.stringify(e)){const t={images:{before:n,after:e}};return console.log("ü™Ñ Labeled Images Diff:",t),t}return console.log("ü™Ñ No changes in labeled images"),{}}catch(t){console.error("‚ùå Invalid JSON in labeled images textarea:",t)}else console.error("‚ùå Labeled images textarea not found")},window.wwaiSaveLabeledImagesConfig=function(){const t=document.getElementById("wwai-labeled-images-textarea");if(t)try{const e=JSON.parse(t.value);window.wwaiConfigSnapshots||(window.wwaiConfigSnapshots={}),window.wwaiConfigSnapshots["labeled-images"]=e,console.log("‚úÖ Saved updated config for snapshot: labeled-images",e)}catch(t){console.error("‚ùå Invalid JSON in labeled images textarea:",t)}else console.error("‚ùå Labeled images textarea not found")},window._wwaiVariantOverridesConfigChanges={},window.wwaiVariantOverridesConfigOnChangeHandler=function(t){const e=t.getAttribute("data-config-path"),n="true"===t.getAttribute("data-is-json"),o=t.value;let i;try{i=n?JSON.parse(o):o,window._wwaiVariantOverridesConfigChanges[e]=i,console.log("[VariantOverrides ChangeTracker]",e,"=>",i)}catch(t){console.warn("Parsing failed for",e,t)}},window.wwaiConfigPanelLogVariantOverridesConfig=function(){const t=window.wwaiConfigPanelGetVariantOverridesConfig();console.log("üéõÔ∏è Updated Variant Overrides Config:",t)},window.wwaiDiffVariantOverridesConfig=function(){const t="variant-overrides",e=window.wwaiConfigSnapshots?.[t],n=window._wwaiVariantOverridesConfigChanges||{};if(!e)return console.warn("No snapshot found for",t),{};const o={};return Object.entries(n).forEach((([t,n])=>{let i=null;try{const n=t.split(".");let o=e;for(let t=0;t<n.length;t++){if(!o||"object"!=typeof o||!(n[t]in o)){o=void 0;break}o=o[n[t]]}i=o}catch(e){console.warn("Could not get original value for path:",t)}JSON.stringify(i)!==JSON.stringify(n)&&(o[t]={before:i,after:n})})),Object.keys(o).length>0?console.log("ü™Ñ Variant Overrides Diff:",o):console.log("ü™Ñ No changes in variant overrides"),o},window.wwaiConfigPanelGetVariantOverridesConfig=function(){const t="variant-overrides",e=window.wwaiConfigSnapshots?.[t],n=window._wwaiVariantOverridesConfigChanges||{};if(!e)return console.warn("No snapshot found for",t),{};const o=structuredClone(e);return Object.entries(n).forEach((([t,e])=>{try{const n=t.split(".");let i=o;for(let t=0;t<n.length-1;t++){const e=n[t];e in i||(i[e]={}),i=i[e]}i[n[n.length-1]]=e,console.log(`Applied variant override change: ${t} =`,e)}catch(e){console.error(`Failed to apply change for path: ${t}`,e)}})),o},window.wwaiSaveVariantOverridesConfig=function(){const t="variant-overrides",e=window.wwaiConfigPanelGetVariantOverridesConfig();window.wwaiConfigSnapshots[t]=structuredClone(e),window._wwaiVariantOverridesConfigChanges={},console.log("‚úÖ Saved variant overrides config changes to snapshot"),console.log("üìä Updated snapshot:",window.wwaiConfigSnapshots[t])},(()=>{let t=!1,e=new Map;function n(){t||(window.wwaiHighlighter&&window.wwaiHighlighter.isActive&&window.wwaiHighlighter.isActive()?console.log("‚ö†Ô∏è Cannot enable button highlighting - highlighter is active"):(console.log("üîç Enabling button highlighting..."),t=!0,document.querySelectorAll("a").forEach((t=>{t.style.outline="2px solid red",t.style.backgroundColor="yellow"})),document.querySelectorAll("a").forEach((t=>{const n=e=>(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),function(t){window.__WWAI__=window.__WWAI__||{},window.__WWAI__.WWAI_ACTION_BUTTONS=window.__WWAI__.WWAI_ACTION_BUTTONS||{};const e=t.innerText.trim()||"(no text)",n=t.getAttribute("href")||"(no href)",o=function(t){let e=t.closest('div[id^="shopify-section-template--"], section[id^="shopify-section-template--"]');if(!e)return"(no Shopify section found)";const n=e.getAttribute("id"),o=[];let i=t;for(;i&&i!==e;){let t=1,e=i.previousSibling;for(;e;)1===e.nodeType&&e.nodeName===i.nodeName&&t++,e=e.previousSibling;o.unshift(`${i.nodeName.toLowerCase()}[${t}]`),i=i.parentNode}return`//div[@id="${n}"]//${o.join("/")}`}(t),i=window.__WWAI__.WWAI_ACTION_BUTTONS[o],r=document.createElement("div");r.className="wwai-modal-backdrop",Object.assign(r.style,{position:"fixed",inset:"0",backgroundColor:"rgba(0,0,0,0.4)",zIndex:9998});const s=document.createElement("div");s.className="wwai-action-modal",Object.assign(s.style,{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 5px 15px rgba(0,0,0,0.3)",zIndex:9999,width:"90%",maxWidth:"600px",fontFamily:"monospace",maxHeight:"80vh",overflowY:"auto"}),s.innerHTML=`\n            <h2 style="margin-top:0;">Link Action Configuration</h2>\n            <div style="margin-bottom: 15px;">\n                <strong>Text:</strong> ${e}<br>\n                <strong>Current Href:</strong> ${n}\n            </div>\n            \n            <div style="margin-bottom: 15px;">\n                <strong>XPath:</strong><br>\n                <code style="word-break: break-all; background: #f5f5f5; padding: 8px; display: block; margin: 5px 0;">${o}</code>\n                <button id="wwai-copy-xpath" style="margin-top: 5px; padding: 4px 8px; font-size: 12px;">Copy XPath</button>\n            </div>\n            \n            <div style="margin-bottom: 15px;">\n                <strong>Action Type:</strong>\n                <select id="wwai-action-type" style="width: 100%; padding: 6px; margin-top: 5px;">\n                    <option value="no-action">No Action (Prevent Default)</option>\n                    <option value="custom-url">Custom URL</option>\n                    <option value="scroll-to">Scroll to Element</option>\n                    <option value="console-log">Console Log</option>\n                    <option value="alert">Alert Message</option>\n                </select>\n            </div>\n            \n            <div id="wwai-action-input" style="margin-bottom: 15px;"></div>\n\n            <div style="display: flex; gap: 10px;">\n                <button id="wwai-apply-action" style="padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 4px;">Apply Action</button>\n                <button id="wwai-close-modal" style="padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 4px;">Close</button>\n            </div>\n        `;const a=s.querySelector("#wwai-action-input"),l=s.querySelector("#wwai-action-type"),c=()=>{a.innerHTML="";const t=l.value;if("custom-url"===t)a.innerHTML='\n                    <strong>Custom URL:</strong><br>\n                    <input id="wwai-custom-url" placeholder="https://example.com" style="width:100%; padding:6px; margin-top: 5px;">\n                ';else if("scroll-to"===t){const t=Array.from(document.querySelectorAll('[id^="shopify-section-template--"]')).map((t=>t.id));if(0===t.length)a.innerHTML='<p style="color: #666;">No matching Shopify section IDs found on this page.</p>';else{const e=t.map((t=>`<option value="${t}">${t}</option>`)).join("");a.innerHTML=`\n                        <strong>Scroll to Section:</strong><br>\n                        <select id="wwai-scroll-target" style="width:100%; padding:6px; margin-top: 5px;">\n                            ${e}\n                        </select>\n                    `}}else"console-log"===t?a.innerHTML='\n                    <strong>Console Message:</strong><br>\n                    <input id="wwai-console-message" placeholder="Message to log" style="width:100%; padding:6px; margin-top: 5px;">\n                ':"alert"===t&&(a.innerHTML='\n                    <strong>Alert Message:</strong><br>\n                    <input id="wwai-alert-message" placeholder="Message to show" style="width:100%; padding:6px; margin-top: 5px;">\n                ')};c(),l.addEventListener("change",c),i?.actionType&&(l.value=i.actionType,c());if(i?.value){setTimeout((()=>{const t=l.value;if("custom-url"===t){const t=s.querySelector("#wwai-custom-url");t&&(t.value=i.value)}else if("scroll-to"===t){const t=s.querySelector("#wwai-scroll-target");t&&(t.value=i.value)}else if("console-log"===t){const t=s.querySelector("#wwai-console-message");t&&(t.value=i.value)}else if("alert"===t){const t=s.querySelector("#wwai-alert-message");t&&(t.value=i.value)}}),50)}s.querySelector("#wwai-copy-xpath").addEventListener("click",(()=>{navigator.clipboard.writeText(o).then((()=>{const t=s.querySelector("#wwai-copy-xpath");t.textContent="Copied!",setTimeout((()=>t.textContent="Copy XPath"),2e3)}))})),s.querySelector("#wwai-apply-action").addEventListener("click",(()=>{const e=l.value;if("no-action"===e)t.setAttribute("href","javascript:void(0)"),t.onclick=t=>t.preventDefault();else if("custom-url"===e){const e=s.querySelector("#wwai-custom-url")?.value.trim();e&&(t.setAttribute("href",e),t.onclick=null)}else if("scroll-to"===e){const e=s.querySelector("#wwai-scroll-target")?.value;e&&(t.setAttribute("href","javascript:void(0)"),t.onclick=t=>{t.preventDefault();const n=document.getElementById(e);n&&n.scrollIntoView({behavior:"smooth"})})}else if("console-log"===e){const e=s.querySelector("#wwai-console-message")?.value.trim()||"Link clicked";t.setAttribute("href","javascript:void(0)"),t.onclick=t=>{t.preventDefault(),console.log(e)}}else if("alert"===e){const e=s.querySelector("#wwai-alert-message")?.value.trim()||"Link clicked";t.setAttribute("href","javascript:void(0)"),t.onclick=t=>{t.preventDefault(),alert(e)}}let n=null;"custom-url"===e?n=s.querySelector("#wwai-custom-url")?.value.trim():"scroll-to"===e?n=s.querySelector("#wwai-scroll-target")?.value:"console-log"===e?n=s.querySelector("#wwai-console-message")?.value.trim():"alert"===e&&(n=s.querySelector("#wwai-alert-message")?.value.trim()),window.__WWAI__.WWAI_ACTION_BUTTONS[o]={actionType:e,value:n||null},s.remove(),r.remove()})),s.querySelector("#wwai-close-modal").addEventListener("click",(()=>{s.remove(),r.remove()})),r.addEventListener("click",(()=>{s.remove(),r.remove()})),document.body.appendChild(r),document.body.appendChild(s)}(t),!1);e.set(t,n),t.addEventListener("click",n,!0)})),console.log("‚úÖ Button highlighting enabled - Click any link to configure actions")))}function o(){t&&(console.log("üîç Disabling button highlighting..."),t=!1,document.querySelectorAll("a").forEach((t=>{t.style.outline="",t.style.backgroundColor=""})),e.forEach(((t,e)=>{e.removeEventListener("click",t,!0)})),e.clear(),document.querySelectorAll(".wwai-action-modal, .wwai-modal-backdrop").forEach((t=>t.remove())),console.log("‚úÖ Button highlighting disabled"))}window.wwaiToggleButtonHighlighting=function(t){t?n():o()},window.wwaiIsButtonHighlightingActive=function(){return t},setInterval((()=>{t&&window.wwaiHighlighter&&window.wwaiHighlighter.isActive&&window.wwaiHighlighter.isActive()&&(console.log("üîÑ Auto-disabling button highlighting - highlighter is active"),o())}),1e3),o()})();let Co=!1,Ao=Date.now();function Oo(){if(!window.__WWAI_HAS_DISPATCHED__){if(!Co){const t=Date.now()-Ao;if(!(t>5e3))return console.log(`‚è≥ Waiting for product data initialization (${t}ms elapsed)...`),void setTimeout(Oo,100);console.warn(`‚ö†Ô∏è Product data initialization timeout after ${t}ms - proceeding with dispatch anyway`),Co=!0}window.__WWAI_HAS_DISPATCHED__=!0,window.runDispatch(),console.log("Applying actions"),vo()}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{Dn(),Co=!0})):(Dn(),Co=!0),window.addEventListener("DOMContentLoaded",(()=>{Co||(console.log("üîÑ DOMContentLoaded fired before data initialization, ensuring data is ready..."),Dn(),Co=!0),Un(),"dev"===window.__WWAI__.MODE&&yo()})),window.runDispatch=Nn,window.__WWAI_HAS_DISPATCHED__=window.__WWAI_HAS_DISPATCHED__||!1,"interactive"===document.readyState||"complete"===document.readyState?Oo():document.addEventListener("DOMContentLoaded",Oo),window.addEventListener("pageshow",(t=>{t.persisted&&(console.log("üîÑ BFCache restore inside script"),window.__WWAI_HAS_DISPATCHED__=!1,requestAnimationFrame(Oo))}));const Io=setInterval((()=>{window.__WWAI_HAS_DISPATCHED__?clearInterval(Io):"interactive"!==document.readyState&&"complete"!==document.readyState||(console.log("‚è±Ô∏è Fallback Dispatch Triggered"),clearInterval(Io),Oo())}),200)}();
//# sourceMappingURL=bundle.js.map
