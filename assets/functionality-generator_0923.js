!function(){"use strict";function t(t,e="success",o=!1){const n=document.createElement("div");n.textContent=t,n.style.cssText=`\n        position: fixed;\n        ${o?"top: 50%; left: 50%; transform: translate(-50%, -50%);":"bottom: 20px; right: 20px;"}\n        background: ${"error"===e?"#D9534F":"warning"===e?"rgb(87, 102, 92)":"#333"};\n        color: white;\n        padding: 15px 20px;\n        border-radius: 5px;\n        font-size: 16px;\n        font-weight: bold;\n        text-align: center;\n        z-index: 9999;\n        opacity: 1;\n        transition: opacity 0.5s ease-in-out;\n    `,document.body.appendChild(n),setTimeout((()=>{n.style.opacity="0",setTimeout((()=>n.remove()),500)}),2e3)}class e extends HTMLElement{constructor(){super(),this.sectionId=this.getAttribute("section_id"),this.productGroup=this.getAttribute("product_group"),this.registryKey=`${this.sectionId}__${this.productGroup}`}initPricingConfig(t){t?this.pricingConfig=t:console.error("WWAI-ERROR ‚ùå Pricing Config is missing or invalid.")}initFlowConfig(e){if(!e||!e.destination)return console.error("WWAI-ERROR ‚ùå Flow Config is missing or invalid."),void t("‚ö†Ô∏è Error: Flow Config is not set!","error",!0);this.flowConfig=e}initUXConfig(t){t?this.uxConfig=t:console.error("WWAI-ERROR ‚ùå UI Config is missing or invalid.")}}const o={PRODUCT_GROUP:{ADD_TO_CART:"product-custom-add-to-cart-button-selector",CAROUSEL:"product-custom-carousel-media-selector",COLLECTION_OPTIONS_OVERLAY:"product-custom-collection-options-overlay-selector",PRICE:"product-custom-price-selector",SUBMIT_INTERCEPTOR:"product-custom-submit-interceptor",TITLE:"product-custom-title-selector",GRID_SMART_INTERACTION:"product-grid-smart-interaction-button-selector",PRODUCT_MEDIA_GALLERY_FOR_GRIDS:"product-media-gallery-for-grids",PURCHASE_TYPE:"product-purchase-type-selector",SUBSCRIPTION_FREQUENCY:"product-subscription-frequency-selector",VARIANT_CUSTOM_LABEL:"product-variant-custom-labeled-text-selector",VARIANT:"product-variant-selector",VARIANT_TRIGGER:"product-variant-trigger",VARIANT_PURCHASE_TYPE_COMBO:"product-variant-purchase-type-combo-selector",VARIANT_SELECTOR_WITH_SETS:"product-variant-selector-with-sets",SUBSCRIPTION_FREQUENCY_STATIC:"product-static-subscription-frequency-selector",PRICE_STATIC:"product-static-price-selector"},OTHER:{PRODUCT_GRID_HEIGHT_EQUALIZER:"product-grid-height-equalizer-selector"}},n=[{name:"id",label:"Variant ID"},{name:"selling_plan",label:"Selling Plan"},{name:"quantity",label:"Quantity"},{name:"bundle_payload",label:"Bundle Payload"}],i={ADD_TO_CART_TEXT:"data-wwai-add-to-cart-text",SOLD_OUT_TEXT:"data-wwai-sold-out-text"};class r extends e{constructor(){super(),this.button=null,this.addToCartText=null,this.soldOutText=null,this.variantIdInput=null,this.sellingPlanInput=null,this.quantityInput=null,this.bundleInput=null}connectedCallback(){this.form=this.querySelector("form"),this.form?(n.forEach((({name:t})=>{let e=this.form.querySelector(`input[name="${t}"]`);e||(e=document.createElement("input"),e.type="hidden",e.name=t,e.value="quantity"===t?"1":"",this.form.appendChild(e)),"id"===t&&(this.variantIdInput=e),"selling_plan"===t&&(this.sellingPlanInput=e),"quantity"===t&&(this.quantityInput=e),"bundle_payload"===t&&(this.bundleInput=e)})),this.button=this.form.querySelector('button[type="submit"]')||null,this.addToCartText=this.button?.querySelector(`[${i.ADD_TO_CART_TEXT}]`)||null,this.soldOutText=this.button?.querySelector(`[${i.SOLD_OUT_TEXT}]`)||null,this.button||console.error("WWAI-ERROR ‚ùå No submit button found inside the form.")):console.error("WWAI-ERROR ‚ùå No form found inside <product-custom-add-to-cart-button>")}updateAddToCartForm(t){if(t){if(t.variantId&&this.variantIdInput&&(this.variantIdInput.value=t.variantId,this.variantIdInput.dataset.title=t.variantName),t.sellingPlanId&&this.sellingPlanInput?(this.sellingPlanInput.value=t.sellingPlanId,this.sellingPlanInput.dataset.option_name=t.sellingPlanName):(this.sellingPlanInput.value="",this.sellingPlanInput.dataset.option_name=""),void 0!==t.available){if("redirect"===this.flowConfig.destination)return void console.log("Flow config is destination redirect, so not updating availablity.");this.button.disabled=!t.available,this.button.style.opacity=t.available?"1":"0.5",this.addToCartText&&this.soldOutText&&(this.addToCartText.style.display=t.available?"":"none",this.soldOutText.style.display=t.available?"none":"")}}else console.error("WWAI-ERROR ‚ùå No payload provided to updateAddToCartForm")}updateAddToCartFormWithBundlePayload(t){t.add_to_cart_payload&&this.bundleInput&&(this.bundleInput.value=JSON.stringify(t.add_to_cart_payload),this.bundleInput.dataset.title=t.title)}updateSellingPlan(t,e=""){this.sellingPlanInput?(console.log(`üîÑ Updating Selling Plan: ${t} (${e})`),this.sellingPlanInput.value=t,this.sellingPlanInput.dataset.option_name=e):console.warn("‚ö†Ô∏è Selling Plan input not found. Update aborted.")}}customElements.define(o.PRODUCT_GROUP.ADD_TO_CART,r);const s="carousel-slider",a=["clearSlides","createCustomCarouselSlide","gotoSlide"];class l extends e{constructor(){super(),this.currentMedia=null,this.carouselElement=null,this.use_custom_uploaded_images="true"===this.getAttribute("data-wwai-use-custom-uploaded-images")}shouldUseCustomImagesAndNotOverwrite(){return this.use_custom_uploaded_images||this.uxConfig?.imageCarouselConfig?.useCustomImages}connectedCallback(){this.carouselElement=this.querySelector(s),this.carouselElement||console.error(`WWAI-ERROR ‚ùå Missing <${s}> inside <product-custom-carousel-media-selector>.`)}updateCarouselMedia(t,e=0){if(this.shouldUseCustomImagesAndNotOverwrite())return void this.carouselElement.gotoSlide(e);if(!Array.isArray(t)||0===t.length)return void console.warn("‚ö†Ô∏è No media provided to update the carousel.");if(this.isSameMedia(t))return console.log("üîÑ Media is unchanged, skipping update."),void this.carouselElement.gotoSlide(e);this.currentMedia=t,this.carouselElement.clearSlides();const o=this.carouselElement.querySelector("main-slider"),n=this.carouselElement.querySelector("thumb-slider");t.forEach(((t,e)=>{if("image"===t.media_type){if(o){const e=this.carouselElement.createCustomCarouselSlide(t,!1);o.appendChild(e)}if(n){const e=this.carouselElement.createCustomCarouselSlide(t,!0);n.appendChild(e)}}})),this.carouselElement.refresh(e),this.carouselElement.gotoSlide(e)}isSameMedia(t){return!!this.currentMedia&&(this.currentMedia.length===t.length&&this.currentMedia.every(((e,o)=>e.id===t[o].id)))}}customElements.define(o.PRODUCT_GROUP.CAROUSEL,l);const c="data-wwai-product-price-label",d={BEFORE:"data-wwai-product-before-price",AFTER:"data-wwai-product-after-price",DISCOUNT:"data-wwai-discount-percentage",SAVINGS:"data-wwai-discount-savings"},u="data-wwai-price-before-wrapper",p="data-wwai-price-after-wrapper",g="data-wwai-discount-percentage-wrapper",f="data-wwai-discount-savings-wrapper";class h extends e{connectedCallback(){this.pricingConfig=null,this.availableLabels=new Set,this.querySelectorAll("[data-wwai-product-price-label]").forEach((t=>{this.availableLabels.add(t.getAttribute("data-wwai-product-price-label"))}))}findWrapper(t,e,o=3){let n=t.parentElement;for(let t=0;t<o&&n;t++){if(n.hasAttribute(e))return n;n=n.parentElement}return null}updatePrices({price:t,compareAtPrice:e,discount_percent:o,savings:n=null},i){let r=!0,s=!0;this.pricingConfig&&null!=this.pricingConfig.roundDiscount&&(r=this.pricingConfig.roundDiscount),this.pricingConfig&&null!=this.pricingConfig.addOffSuffixToDiscount&&(s=this.pricingConfig.addOffSuffixToDiscount);const a=this.querySelectorAll(`[${c}="${i}"]`),l=t!=e,p=Number(o);a.forEach((i=>{i.hasAttribute(d.BEFORE)&&(i.textContent=l?e:"",i.setAttribute("data-wwai-slash-pricing-before-tag",l?"true":"false")),i.hasAttribute(d.AFTER)&&(i.textContent=t,i.setAttribute("data-wwai-slash-pricing-after-tag",l?"true":"false"));const a=this.findWrapper(i,u);a&&(a.style.display=l?"":"none");const c=this.findWrapper(i,g);if(c&&(c.style.display=l?"":"none"),n){i.hasAttribute(d.SAVINGS)&&(i.textContent=n);const t=this.findWrapper(i,f);t&&(t.style.display=l?"":"none")}if(i.hasAttribute(d.DISCOUNT)){if(isNaN(p))return void console.error("WWAI-ERROR ‚ùå Invalid discount_percent received:",o);let t=`${r?Math.round(p):p}%${s?" OFF":""}`;const e=i.textContent.trim();l?e.includes("(")?i.textContent=e.replace(/\(\d+(\.\d+)?%\)/,`(${t})`):i.textContent=t:i.textContent=""}}))}}function b(t,e){!function(){if(document.getElementById("wwai-overlay-styles"))return;const t=document.createElement("style");t.id="wwai-overlay-styles",t.innerText="\n    /* White overlay */\n    .overlay-spinner {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background-color: rgba(255, 255, 255, 0.7);\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      z-index: 10;\n    }\n\n    /* Positioning wrapper */\n    product-media-gallery-for-grids {\n      position: relative;\n    }\n  \n    @keyframes spin {\n      to {\n        transform: rotate(360deg);\n      }\n    }\n  ",document.head.appendChild(t)}();const o=document.querySelector(`product-media-gallery-for-grids[section_id="${t}"][product_group="${e}"]`);if(!o)return void console.error("WWAI-ERROR ‚ùå product-media-gallery-for-grids not found for",t,e);if(o.querySelector(`.overlay-spinner[data-overlay-id="${t}__${e}"]`))return;const n=document.createElement("div");n.className="overlay-spinner",n.setAttribute("data-overlay-id",`${t}__${e}`),n.innerHTML='\n    <div style="\n      width: 40px;\n      height: 40px;\n      border: 4px solid rgba(0, 0, 0, 0.1);\n      border-top-color: #333;\n      border-radius: 50%;\n      animation: spin 0.8s linear infinite;\n      display: block;\n    "></div>\n  ',o.appendChild(n)}function m(t,e,o){switch(o){case"none":break;case"media-gallery":b(t,e);break;case"add-to-cart-submit-button":!function(t,e){const o=document.querySelectorAll(`product-custom-submit-interceptor[section_id="${t}"][product_group="${e}"]`);o&&0!==o.length?(o.forEach((t=>{t.submitButton?.classList.add("loading")})),console.log(`‚úÖ Loading state added to ${o.length} submit interceptors for [${t} / ${e}]`)):console.error("WWAI-ERROR ‚ùå product-custom-submit-interceptor not found for",t,e)}(t,e);break;default:console.warn(`‚ö†Ô∏è Unknown overlay_type "${o}" passed to addLoadingOverlay`)}}function w(t,e,o,n=!1){switch(o){case"none":break;case"media-gallery":!function(t,e,o=!1){const n=document.querySelector(`.overlay-spinner[data-overlay-id="${t}__${e}"]`);n?(n.remove(),console.log(`‚úÖ Overlay removed for ${t} / ${e}`)):o||console.warn(`‚ö†Ô∏è No overlay found for ${t} / ${e}`)}(t,e,n);break;case"add-to-cart-submit-button":!function(t,e,o=!1){const n=document.querySelectorAll(`product-custom-submit-interceptor[section_id="${t}"][product_group="${e}"]`);n&&0!==n.length?(n.forEach((t=>{t.submitButton?.classList.remove("loading")})),console.log(`‚úÖ Loading state removed from ${n.length} submit interceptors for [${t} / ${e}]`)):o||console.error("WWAI-ERROR ‚ùå product-custom-submit-interceptor not found for",t,e)}(t,e,n);break;default:console.warn(`‚ö†Ô∏è Unknown overlay_type "${o}" passed to removeLoadingOverlay`)}}function _(){const t=document.querySelectorAll("product-variant-selector"),e=new Set;t.forEach((t=>{const o=t.getAttribute("section_id"),n=t.getAttribute("product_group"),i=`${o}::${n}`;e.has(i)||(e.add(i),w(o,n,"media-gallery",!0),w(o,n,"add-to-cart-submit-button",!0))}))}function y(t,e=400,o={}){!function({backgroundColor:t="#E8DDFA",textColor:e="#000000",borderColor:o="transparent",fontFamily:n="sans-serif"}={}){if(document.getElementById("wwai-notification-styles"))return;const i=`\n      .wwai-temporary-notification {\n        position: fixed;\n        bottom: 20px;\n        right: 20px;\n        background-color: ${t};\n        color: ${e};\n        border: 1px solid ${o};\n        font-family: ${n};\n        padding: 10px 20px;\n        border-radius: 5px;\n        font-size: 14px;\n        z-index: 10000;\n        opacity: 0.95;\n        transition: opacity 0.3s ease-in-out;\n        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.15);\n        max-width: 300px;\n      }\n  \n      .wwai-temporary-notification.fade-out {\n        opacity: 0;\n      }\n    `,r=document.createElement("style");r.type="text/css",r.id="wwai-notification-styles",r.innerText=i,document.head.appendChild(r)}(o);const n=document.createElement("div");n.className="wwai-temporary-notification",n.innerText=t,document.body.appendChild(n),setTimeout((()=>{n.classList.add("fade-out"),setTimeout((()=>{n.remove()}),500)}),e)}async function v(e,o,n,i){if(n){return void t((t=>`üõí Product added to cart (mock mode) ‚Äî ${t} redirect enabled.\n\n${i||""}`)("side-cart"+e),"success",!0)}let r=!1;switch(e){case"littlewords":r=function(){const t=document.querySelector("cart-drawer");return!(!t||"function"!=typeof t.show||(window.isCartRefreshed=!0,document.documentElement.dispatchEvent(new CustomEvent("cart:refresh",{bubbles:!0})),t.show(),0))}();break;case"rco":r=!!window.VueMinicart?.$store&&(window.VueMinicart.$store.dispatch("refreshCart"),window.VueMinicart.$store.commit("toggleCart",!0),document.body.classList.add("noscroll"),!0);break;case"nwkw":r=await(s=o,fetch("/?sections=cart-drawer,cart-icon-bubble").then((t=>{if(!t.ok)throw new Error("Failed to fetch cart sections");return t.json()})).then((t=>{const e=document.querySelector("cart-drawer");if(!e||"function"!=typeof e.renderContents)return!1;e.renderContents({sections:t});const o=e.querySelector("#CartDrawer-CartItems");return o&&o.innerHTML.trim()&&e.classList.remove("is-empty"),setTimeout((()=>{e.classList.contains("active")||e.classList.add("active")}),100),publish(PUB_SUB_EVENTS.cartUpdate,{source:"product-form",productVariantId:`virtual-${Math.random().toString(36).slice(2,10)}`,cartData:s}),!0})).catch((t=>(console.error("WWAI-ERROR [SideCart] Failed to open drawer:",t),!1))));break;case"kitsch":r=await(window.dispatchEvent(new Event("toggle-cart-drawer")),window.dispatchEvent(new Event("update-cart")),console.log("‚úÖ Cart drawer refreshed and opened."),!0);break;case"puracy":r=await async function(){try{const t=document.querySelector("cart-drawer");if(!t)return!1;t&&!t.open&&(t.open=!0,t.classList.add("active"));const e=window.themeVariables?.routes?.cartUrl||"/cart",o="drawer"===window.themeVariables?.settings?.cartType,[n,i]=await Promise.all([fetch(`${e}.js`).then((t=>t.json())),fetch(`${e}?sections=mini-cart`).then((t=>t.json()))]),r={...n,sections:i};document.documentElement.dispatchEvent(new CustomEvent("cart:updated",{bubbles:!0,detail:{cart:r}}));const s=o&&!document.querySelector(".drawer");return document.documentElement.dispatchEvent(new CustomEvent("cart:refresh",{bubbles:!0,detail:{cart:r,openMiniCart:s}})),!0}catch(t){return console.error("‚ùå Failed to refresh cart:",t),!1}}();break;case"drmtlgy":r=await async function(){return window.dispatchEvent(new CustomEvent("cart-updated")),window.dispatchEvent(new CustomEvent("toggle-cart",{detail:{open:!0}})),!0}();break;case"dose":r=await async function(){try{return window.wwaiCartDrawer=new theme.CartDrawer,window.wwaiCartDrawer.drawer.open(),!0}catch(t){return console.error("‚ùå Failed to open cart drawer:",t),!1}}();break;default:console.warn(`[SideCart] Unknown or missing brandName: "${e}". Redirecting to /cart.`)}var s;if(!r){if("rco"==e)return;window.location.href="/cart"}}function C(t,e,o,n,i=!1){if(!t||"string"!=typeof t)return void console.error("WWAI-ERROR ‚ùå Invalid path specified for redirect.");const{isValid:r,errors:s,config:a}=O(e);r?(m(o,n,a.loader),A(o,n),function(t,e=!1,o=!1){t&&"string"==typeof t?!0!==o?e?window.open(t,"_blank"):window.location.href=t:y(`You'll be redirected to: ${t}`,3e3):console.error("WWAI-ERROR ‚ùå Invalid path specified for redirect.")}(t,!1,i),i&&(console.log("üîÑ Removing loading overlay:",o,n,a.loader),setTimeout((()=>{w(o,n,a.loader)}),1e3))):console.error("WWAI-ERROR ‚ùå Invalid flowConfig:",s)}function O(t={}){const e=[],o={loader:t.loader??"none",showSuccessNotification:t.showSuccessNotification??!0,showErrorNotification:t.showErrorNotification??!0,successNotificationMessage:t.successNotificationMessage??"üéâ Item(s) added to cart!",errorNotificationMessage:t.errorNotificationMessage??"‚ùå Something went wrong.",destination:t.destination??"cart",sideCartLabel:t.sideCartLabel??null,redirectUrl:t.redirectUrl??null,notificationOptions:t.notificationOptions??{},clearCartBeforeAddingItems:t.clearCartBeforeAddingItems??!1,additionalItemsToAdd:t.additionalItemsToAdd??[]};return null==t.loader||["media-gallery","add-to-cart-submit-button","none"].includes(t.loader)||e.push(`Invalid loader value: "${t.loader}"`),null!=t.showSuccessNotification&&"boolean"!=typeof t.showSuccessNotification&&e.push("showSuccessNotification must be a boolean"),null!=t.showErrorNotification&&"boolean"!=typeof t.showErrorNotification&&e.push("showErrorNotification must be a boolean"),null==t.destination||["cart","checkout","side-cart","redirect"].includes(t.destination)||e.push(`Invalid destination value: "${t.destination}"`),"side-cart"===o.destination&&"string"!=typeof o.sideCartLabel&&e.push('sideCartLabel must be defined as a string when destination is "side-cart"'),{isValid:0===e.length,errors:e,config:o}}function A(t,e){const o=document.querySelector(`product-custom-collection-options-overlay-selector[section_id="${t}"][product_group="${e}"]`);o&&o.closeOverlay()}async function I(e,o,n,i,r=!1,s=null){const{debugString:a,cleanedItems:l}=function(t){let e=`üõí Total Items to Add: ${t.length}\n`;const o=t.map(((t,o)=>{const n=t._debug||{};e+=`‚Ä¢ ${n.readableString||`Item ${o+1}`} - Variant ID: ${n.variantId||"N/A"} - Qty: ${n.quantity||"N/A"} - Selling Plan: ${n.sellingPlan||"None"}\n`;const{_debug:i,...r}=t;return r}));return{debugString:e,cleanedItems:o}}(e);console.log("üîç Cart add debug string:",a);const c=performance.now();let d=c;const{isValid:u,errors:p,config:g}=O(o);if(!u)return void console.error("WWAI-ERROR ‚ùå Invalid flowConfig:",p);console.log(`‚è±Ô∏è Step 1 - Config validation: ${(performance.now()-d).toFixed(2)}ms`),d=performance.now();const{loader:f,showSuccessNotification:h,showErrorNotification:b,successNotificationMessage:_,errorNotificationMessage:I,destination:E,sideCartLabel:R,redirectUrl:T,notificationOptions:S,clearCartBeforeAddingItems:P,additionalItemsToAdd:x}=g;m(n,i,f),console.log(`‚è±Ô∏è Step 2 - Loading overlay: ${(performance.now()-d).toFixed(2)}ms`),d=performance.now();try{let e=null;if(r){const t=performance.now();await new Promise((t=>setTimeout(t,600))),console.log(`‚è±Ô∏è Step 3c - Mock delay: ${(performance.now()-t).toFixed(2)}ms`)}else{if("checkout"===E&&P){const t=performance.now();await async function(){try{const t=await fetch("/cart/clear.js",{method:"POST",headers:{"Content-Type":"application/json"}});if(!t.ok){const e=await t.json();return void console.error("WWAI-ERROR ‚ùå Failed to clear cart:",e)}console.log("üßπ Cart cleared successfully")}catch(t){console.error("WWAI-ERROR ‚ùå Error while clearing cart:",t)}}(),console.log(`‚è±Ô∏è Step 3a - Clear cart: ${(performance.now()-t).toFixed(2)}ms`)}const t=performance.now();"redirect"!=E&&(e=await function(t,e){const o=performance.now();console.log("üõí Starting addItemsToCart operation...");const n=[...e,...t],i=performance.now();console.log(`‚è±Ô∏è Step 1 - Prepare items array: ${(i-o).toFixed(2)}ms`);const r=performance.now();return fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:n})}).then((t=>{const e=performance.now();if(console.log(`‚è±Ô∏è Step 2 - Network request: ${(e-r).toFixed(2)}ms`),!t.ok)throw new Error("Add to cart failed");const n=performance.now();return t.json().then((t=>{const e=performance.now();return console.log(`‚è±Ô∏è Step 3 - Parse response: ${(e-n).toFixed(2)}ms`),console.log(`‚è±Ô∏è Total addItemsToCart time: ${(e-o).toFixed(2)}ms`),t}))}))}(l,x)),console.log(`‚è±Ô∏è Step 3b - Add items to cart: ${(performance.now()-t).toFixed(2)}ms`)}console.log(`‚è±Ô∏è Step 3 - Cart operation total: ${(performance.now()-d).toFixed(2)}ms`),d=performance.now();const s=performance.now();!function(t,e,o={}){t&&y(e,2e3,o)}(h,_,S),console.log(`‚è±Ô∏è Step 4 - Success notification: ${(performance.now()-s).toFixed(2)}ms`),d=performance.now();const c=performance.now();await async function(e,o,n,i,r,s,a,l,c){const d=t=>`üõí Product added to cart (mock mode) ‚Äî ${t} redirect enabled.\n\n${s||""}`;"checkout"===e?i?t(d("checkout"),"success",!0):window.location.href="/checkout":"cart"===e?i?t(d("cart"),"success",!0):window.location.href="/cart":"redirect"===e?C(n,a,l,c,i=!1):"side-cart"===e?await v(o,r,i,s):console.warn(`‚ö†Ô∏è Unknown destination "${e}"`)}(E,R,T,r,e,a,o,n,i),console.log(`‚è±Ô∏è Step 5 - Post-add journey: ${(performance.now()-c).toFixed(2)}ms`),d=performance.now()}catch(t){console.error("WWAI-ERROR ‚ùå Failed to add to cart:",t),function(t,e,o={}){t&&y(e,2e3,o)}(b,I||t.message,S)}finally{const t=performance.now();w(n,i,f),A(n,i),"function"==typeof s&&s("addedToCart"),console.log(`‚è±Ô∏è Step 6 - Cleanup: ${(performance.now()-t).toFixed(2)}ms`),console.log(`‚è±Ô∏è Total add to cart time: ${(performance.now()-c).toFixed(2)}ms`)}}function E(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function R(){return window.__WWAI__||{}}customElements.define(o.PRODUCT_GROUP.PRICE,h);class T extends e{constructor(){super(),this.formElement=null,this.submitButton=null,this.variantInput=null,this.sellingPlanInput=null,this.quantityInput=null,this.deployMode=null,this.flowConfig=null,this.handlers={}}connectedCallback(){const t=R().deployMode;this.deployMode=t,this.formElement=this.querySelector("form"),this.submitButton=this.formElement?.querySelector('button[type="submit"]'),this.variantInput=this.formElement?.querySelector('input[name="id"]'),this.sellingPlanInput=this.formElement?.querySelector('input[name="selling_plan"]'),this.bundleInput=this.formElement?.querySelector('input[name="bundle_payload"]'),this.quantityInput=this.formElement?.querySelector('input[name="quantity"]'),this.formElement&&this.submitButton?this.formElement.addEventListener("submit",(t=>this.handleSubmit(t))):console.error("WWAI-ERROR ‚ùå Missing form or submit button inside <product-custom-submit-interceptor>")}registerHandler(t,e){console.log("registerHandler with type: ",t),this.handlers[t]||(this.handlers[t]=[]),this.handlers[t].push(e)}triggerHandler(t){this.handlers&&this.handlers[t]&&(this.handlers[t]||[]).forEach((t=>t()))}itemsToAdd(){const t=this.variantInput?.value,e=Number(this.quantityInput?.value)||1,o=this.sellingPlanInput?.value||null,n=this.bundleInput?.value||null,i=this.variantInput?.dataset.title||"Unknown Product",r=this.sellingPlanInput?.dataset.option_name||"One-time purchase",s=this.quantityInput?.value||"1";if(n){return JSON.parse(n).map((t=>({...t,_debug:{source:"bundle",variantId:t.id,quantity:t.quantity,sellingPlan:t.selling_plan||null,bundlePayload:!0,readableString:null}})))}if(!t)return console.error("WWAI-ERROR ‚ùå No variant selected. Cannot proceed."),[];const a={id:t,quantity:e};return o&&(a.selling_plan=o),a._debug={source:"single",variantId:t,quantity:e,sellingPlan:o,bundlePayload:!1,readableString:`${i} - ${r} (Qty: ${s})`},[a]}validateFlowReady(){return this.deployMode?!!this.flowConfig||(t("‚ö†Ô∏è Error: Flow Config is not initialized!","error",!0),!1):(t("‚ö†Ô∏è Error: `deploy_mode` is not set!","error",!0),!1)}handleSubmit(e){if(!this.validateFlowReady())return void e.preventDefault();e.preventDefault();const o=this.itemsToAdd();0!==o.length?"local"===this.deployMode?(console.log("Running in Local Mode"),this.handleLocalMode(o)):"sandbox"===this.deployMode?(console.log("Running in Sandbox Mode"),this.handleSandboxMode(e)):this.proceedWithSubmission(e,this.flowConfig,o):t("‚ö†Ô∏è No items found for submission.","warning",!0)}handleLocalMode(e){console.info("[LOCAL] Simulated add-to-cart for items:",e);const o=this.variantInput?.dataset.title||"Unknown Product",n=this.sellingPlanInput?.dataset.option_name||"One-time purchase",i=this.quantityInput?.value||"1";t(`üõçÔ∏è Simulated add-to-cart for ${e.length} items. ${o} - ${n} (Qty: ${i})`),setTimeout((()=>{this.proceedWithSubmission(event,this.flowConfig,this.itemsToAdd())}),2e3)}handleSandboxMode(e){if(e.preventDefault(),this.sellingPlanInput?.value){const o=this.sellingPlanInput.value;console.warn(`[SANDBOX] Clearing selling_plan_id: ${o}`),t(`Removing Selling Plan: ${o}`,"warning",!0),setTimeout((()=>{this.sellingPlanInput.value="",console.log(`Selling plan removed: ${o}`),this.proceedWithSubmission(e,this.flowConfig,this.itemsToAdd())}),2e3)}else this.proceedWithSubmission(e,this.flowConfig,this.itemsToAdd())}async proceedWithSubmission(t,e,o){t&&t.preventDefault();let n="local"===this.deployMode;await I(o,e,this.sectionId,this.productGroup,n,(t=>this.triggerHandler(t)))}}customElements.define(o.PRODUCT_GROUP.SUBMIT_INTERCEPTOR,T);const S="data-wwai-purchase-type-option",P={ONETIME:"onetime",SUBSCRIPTION:"subscription"},x=`input[type="radio"][${S}]`,$=[{selector:o.PRODUCT_GROUP.PURCHASE_TYPE,required:!1,max:1,name:"Purchase Type Selector"},{selector:o.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY,required:!1,max:1,name:"Subscription Frequency Selector"},{selector:o.PRODUCT_GROUP.ADD_TO_CART,required:!1,max:2,name:"Add to Cart Button"},{selector:o.PRODUCT_GROUP.SUBMIT_INTERCEPTOR,required:!1,max:2,name:"Submit Interceptor"},{selector:o.PRODUCT_GROUP.PRODUCT_MEDIA_GALLERY_FOR_GRIDS,required:!1,max:1,name:"Media Gallery for Grids"},{selector:o.PRODUCT_GROUP.CAROUSEL,required:!1,max:1,name:"Carousel Media"}],D=[{groupName:"Variant Selector",conditions:[[o.PRODUCT_GROUP.VARIANT],[o.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO]],message:`Either [${o.PRODUCT_GROUP.VARIANT}] or [${o.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO}] must be present.`,enabled:!0},{groupName:"Price Selector",conditions:[[o.PRODUCT_GROUP.PRICE],[o.PRODUCT_GROUP.PRICE_STATIC]],message:`Either [${o.PRODUCT_GROUP.PRICE}] or [${o.PRODUCT_GROUP.PRICE_STATIC}] must be present.`,enabled:!0},{groupName:"Add to Cart Config",conditions:[[o.PRODUCT_GROUP.ADD_TO_CART,o.PRODUCT_GROUP.SUBMIT_INTERCEPTOR],[o.PRODUCT_GROUP.GRID_SMART_INTERACTION]],message:`Either both [${o.PRODUCT_GROUP.ADD_TO_CART} and ${o.PRODUCT_GROUP.SUBMIT_INTERCEPTOR}] or [${o.PRODUCT_GROUP.GRID_ICON_SMART_ADD_TO_CART}] must be present.`,enabled:!0},{groupName:"Media Display Config",conditions:[[o.PRODUCT_GROUP.CAROUSEL],[o.PRODUCT_GROUP.PRODUCT_MEDIA_GALLERY_FOR_GRIDS]],message:`Either [${o.PRODUCT_GROUP.CAROUSEL}] or [${o.PRODUCT_GROUP.PRODUCT_MEDIA_GALLERY_FOR_GRIDS}] must be present.`,enabled:!0}];const U=new class{constructor(t,e){this.requiredRules=t,this.conditionalRules=e}getAllRules(){return{required:this.requiredRules,conditional:this.conditionalRules.filter((t=>t.enabled))}}disableConditionalAssertion(t){const e=this.conditionalRules.find((e=>e.groupName===t));e?(e.enabled=!1,console.log(`Validation: Disabled conditional assertion "${t}"`)):console.warn(`Validation: Conditional assertion "${t}" not found.`)}enableConditionalAssertion(t){const e=this.conditionalRules.find((e=>e.groupName===t));e?(e.enabled=!0,console.log(`Validation: Enabled conditional assertion "${t}"`)):console.warn(`Validation: Conditional assertion "${t}" not found.`)}}([...$],[...D]);const N={},W=Object.values(o.PRODUCT_GROUP);function L(){Object.keys(N).forEach((t=>delete N[t])),W.forEach((t=>{document.querySelectorAll(t).forEach((e=>{const o=e.getAttribute("section_id")?.trim(),n=e.getAttribute("product_group")?.trim();if(!o||!n)return void console.error(`WWAI-ERROR ‚ùå Skipping <${e.tagName.toLowerCase()}> ‚Äî Missing ${o?"":"`section_id`"}${o||n?"":" and "}${n?"":"`product_group`"}.`,e);const i=`${o}__${n}`;N[i]=N[i]||{sectionId:o,productGroup:n,elements:{}},N[i].elements[t]=N[i].elements[t]||[],N[i].elements[t].push(e)}))}));const t={};for(const e of Object.keys(N)){const{sectionId:o,productGroup:n}=N[e];t[o]=t[o]||new Set,t[o].add(n)}const e={};for(const[o,n]of Object.entries(t))e[o]=Array.from(n);return console.group("[WWAI] üß± Product Group Registry"),console.table(e),console.groupEnd(),function(t){console.group("[WWAI] üß™ Validating Product Group Registry"),Object.entries(t).forEach((([t,e])=>{const{sectionId:o,productGroup:n,elements:i}=e,{required:r,conditional:s}=U.getAllRules(),a=[];r.forEach((({selector:t,required:e,exact:o,min:n,max:r})=>{const s=(i[t]||[]).length;e&&0===s&&a.push(`Missing required selector: ${t}`),void 0!==o&&s!==o&&a.push(`Selector "${t}" must have exactly ${o}, found ${s}`),void 0!==n&&s<n&&a.push(`Selector "${t}" must have at least ${n}, found ${s}`),void 0!==r&&s>r&&a.push(`Selector "${t}" must have at most ${r}, found ${s}`)})),s.forEach((({groupName:t,conditions:e,message:o})=>{e.some((t=>t.every((t=>(i[t]||[]).length>0))))||a.push(`‚ùå [${t}]: ${o}`)})),a.length>0&&(console.group(`‚ùå [${t}] (${o} / ${n})`),a.forEach((t=>console.warn(t))),console.groupEnd())})),console.groupEnd()}(N),N}function G(t,e,o){const n=N[`${t}__${e}`];return n&&n.elements&&n.elements[o]?n.elements[o]:[]}function k(t,e,o){const n=G(t,e,o);return 0===n.length?(console.warn(`‚ö†Ô∏è No element found for selector="${o}" in group [${t} / ${e}]`),null):n.length>1?(console.error(`WWAI-ERROR ‚ùå Expected only one element for selector="${o}" but found ${n.length} in group [${t} / ${e}]`),null):n[0]}function M(t,e,o){const n=k(t,e,o);if(!n)throw new Error(`‚ùå No unique element found for selector="${o}" in [${t} / ${e}]`);if(!n.scope)throw new Error(`‚ùå Unique element for selector="${o}" in [${t} / ${e}] does not have a .scope property`);return n.scope}function q(t,e){const o=N[`${t}__${e}`];return o&&o.elements?Object.keys(o.elements):[]}function j(t,e,o){e&&t.updatePrices({price:e.price,compareAtPrice:e.compareAtPrice,discount_percent:e.discount_percent},o)}function B({sectionId:t,productGroup:e,priceObj:n,type:i}){G(t,e,o.PRODUCT_GROUP.PRICE).forEach((t=>{"function"==typeof t.updatePrices?n?j(t,n,i):console.warn(`‚ö†Ô∏è priceObj data is missing for type '${i}'.`):console.warn("‚ö†Ô∏è Skipping price selector: missing updatePrices method",t)}))}function V({sectionId:t,productGroup:e,sellingPlanId:n,sellingPlanName:i}){const r=k(t,e,o.PRODUCT_GROUP.ADD_TO_CART);r&&(r&&"function"==typeof r.updateSellingPlan?r.updateSellingPlan(n,i):console.error("WWAI-ERROR ‚ùå Could not find <product-custom-add-to-cart-button-selector> or missing .updateSellingPlan()"))}function H({sectionId:t,productGroup:e,purchaseType:n,pricesDict:i}){n===P.ONETIME?function({sectionId:t,productGroup:e,pricesDict:o}){console.log("üõí One-Time Purchase Selected ‚Üí Clearing Selling Plan ID"),V({sectionId:t,productGroup:e,sellingPlanId:"",sellingPlanName:""}),B({sectionId:t,productGroup:e,priceObj:o.oneTimePrice,type:"onetime_or_subscription"})}({sectionId:t,productGroup:e,pricesDict:i}):n===P.SUBSCRIPTION?function({sectionId:t,productGroup:e}){const n=k(t,e,o.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY);if(!n)return void console.warn(`‚ö†Ô∏è No subscription frequency selector found for [${t} / ${e}]`);const i=n.getCurrentSelectedPlan();i?(console.log("‚úÖ Current Subscription Plan Found:",i),V({sectionId:t,productGroup:e,sellingPlanId:i.selling_plan_id,sellingPlanName:i.option_name}),B({sectionId:t,productGroup:e,priceObj:{price:i.after_price,compareAtPrice:i.before_price,discount_percent:i.discount_percent},type:"onetime_or_subscription"})):console.warn(`‚ö†Ô∏è No subscription plan selected for [${t} / ${e}]`)}({sectionId:t,productGroup:e}):console.warn(`‚ö†Ô∏è Unsupported purchase type '${n}' for [${t} / ${e}]`)}class F extends e{constructor(){super(),this.subscriptionInput=null,this.onetimeInput=null,this.pricesDict=null}connectedCallback(){if(!this.sectionId||!this.productGroup)return void console.warn(`‚ö†Ô∏è <product-purchase-type-selector> missing attributes ‚Äî sectionId: ${this.sectionId}, productGroup: ${this.productGroup}`);this.querySelectorAll(`input[type="radio"][${S}]`).forEach((t=>{const e=t.getAttribute(S);e===P.SUBSCRIPTION?this.subscriptionInput=t:e===P.ONETIME&&(this.onetimeInput=t)})),this.subscriptionInput&&this.onetimeInput?this.subscriptionInput.name===this.onetimeInput.name?(this.ensureAutocompleteOff(),this.subscriptionInput.addEventListener("change",(()=>{this.subscriptionInput.checked&&(this.onetimeInput.checked=!1,this.handlePurchaseTypeChange(P.SUBSCRIPTION))})),this.onetimeInput.addEventListener("change",(()=>{this.onetimeInput.checked&&(this.subscriptionInput.checked=!1,this.handlePurchaseTypeChange(P.ONETIME))}))):console.error("WWAI-ERROR ‚ùå Purchase type radios must have the same name"):console.error("WWAI-ERROR ‚ùå Missing both purchase type radio inputs")}cachePrices(t){this.pricesDict=t}getSelectedPurchaseType(){return this.subscriptionInput?.checked?{purchaseType:P.SUBSCRIPTION}:(this.onetimeInput,{purchaseType:P.ONETIME})}setPurchaseType(t){t===P.SUBSCRIPTION?(this.subscriptionInput.checked=!0,this.onetimeInput.checked=!1):(this.subscriptionInput.checked=!1,this.onetimeInput.checked=!0)}handlePurchaseTypeChange(t){console.log(`üîÑ Purchase type changed to: ${t}`),H({sectionId:this.sectionId,productGroup:this.productGroup,purchaseType:t,pricesDict:this.pricesDict})}ensureAutocompleteOff(){[this.subscriptionInput,this.onetimeInput].forEach((t=>{t.hasAttribute("autocomplete")||t.setAttribute("autocomplete","off")}))}}customElements.define(o.PRODUCT_GROUP.PURCHASE_TYPE,F);const z="data-wwai-subscription-frequency-select",Y=`[${z}]`,J="data-wwai-product-variant-option-type",X="data-wwai-product-label",Q="data-wwai-product-variant-label",Z="data-wwai-product-variant-label-level",K="data-wwai-variant-label-text-slot",tt="product",et="product_variant";function ot({sectionId:t,productGroup:e,oneTimePrice:n,subscriptionPrice:i,purchaseType:r}){const s=G(t,e,o.PRODUCT_GROUP.PRICE);let a=function(t,e){return!!k(t,e,o.PRODUCT_GROUP.PURCHASE_TYPE)}(t,e);s.length?s.forEach((t=>{"function"==typeof t.updatePrices?(j(t,n,"one_time"),j(t,i,"subscription"),a&&(r==P.ONETIME?j(t,n,"onetime_or_subscription"):j(t,i,"onetime_or_subscription"))):console.warn("‚ö†Ô∏è Skipping price selector: missing updatePrices method",t)})):console.warn(`‚ö†Ô∏è No price selectors found for section="${t}", productGroup="${e}"`)}function nt({sectionId:t,productGroup:e,oneTimePrice:n,subscriptionPrice:i,purchaseType:r,onlySetPurchaseType:s=!1}){const a=k(t,e,o.PRODUCT_GROUP.PURCHASE_TYPE);a&&(s||(void 0===n&&void 0===i?console.error(`WWAI-ERROR ‚ùå setPurchaseTypeForGroup: Both oneTimePrice and subscriptionPrice are undefined for [${t} / ${e}]`):void 0===n&&void 0===i||"function"==typeof a.cachePrices&&a.cachePrices({oneTimePrice:n,subscriptionPrice:i})),void 0===r?console.error(`WWAI-ERROR ‚ùå setPurchaseTypeForGroup: purchaseType is undefined for [${t} / ${e}]`):"function"==typeof a.setPurchaseType?(a.setPurchaseType(r),console.log(`‚úÖ Default purchase type set for [${t} / ${e}] ‚Üí ${r}`)):console.error("WWAI-ERROR ‚ùå <product-purchase-type-selector> is missing .setPurchaseType()"))}function it({sectionId:t,productGroup:e,config:n,media:i=[],moveToIndex:r=0,isReinitializing:s=!1}){const a=k(t,e,o.PRODUCT_GROUP.CAROUSEL);if(a)if("function"==typeof a.updateCarouselMedia){if(n?.uxConfig?.imageCarouselConfig?.preInjectedMedia){let t=n?.uxConfig?.imageCarouselConfig?.useCustomImages;if(!t)throw new Error("WWAI-ERROR ‚ùå Pre injected media is not allowed when useCustomImages is true")}if(console.log("isReinitializing1:",s),s)console.log("isReinitializing3:",s),a.updateCarouselMedia(i,r);else{if(console.log("isReinitializing2:",s),n?.uxConfig?.imageCarouselConfig?.preInjectedMedia)return void console.log("using pre injected media, not updating carousel media on first init");a.updateCarouselMedia(i,r)}}else console.error("WWAI-ERROR ‚ùå <product-custom-carousel-media-selector> is missing .updateCarouselMedia()")}class rt extends e{constructor(){super(),this.sellingPlans=[],this.selectElement=null}getElementName(){return"subscription frequency selector"}connectedCallback(){const t=this.querySelectorAll(Y);0!==t.length?(t.length>1&&console.warn("‚ö†Ô∏è Multiple <select> elements found for subscription frequency. Only the first one will be used."),this.selectElement=t[0],this.selectElement.addEventListener("change",(t=>{this.handleSubscriptionPlanChange(this.getCurrentSelectedPlan())}))):console.error(`WWAI-ERROR ‚ùå No <select> element found with selector ${Y}`)}handleSubscriptionPlanChange(t){!function(t,e,o){if(!t||!e||!o)return void console.error("WWAI-ERROR ‚ùå Invalid parameters provided to updateSubscriptionPlanForGroup.");const n={price:t.after_price,compareAtPrice:t.before_price,discount_percent:t.discount_percent};nt({sectionId:e,productGroup:o,oneTimePrice:void 0,subscriptionPrice:void 0,purchaseType:P.SUBSCRIPTION,onlySetPurchaseType:!0}),["subscription","onetime_or_subscription"].forEach((t=>{B({sectionId:e,productGroup:o,priceObj:n,type:t})})),V({sectionId:e,productGroup:o,sellingPlanId:t.selling_plan_id,sellingPlanName:t.option_name}),console.log(`‚úÖ Subscription plan successfully updated for [${e} / ${o}]`)}(t,this.sectionId,this.productGroup)}updateSubscriptionOptions(t){Array.isArray(t)?(this.selectElement.innerHTML="",t.forEach((t=>{const e=document.createElement("option");e.value=t.selling_plan_id,e.textContent=t.option_name,e.dataset.beforePrice=t.before_price,e.dataset.afterPrice=t.after_price,e.dataset.discountPercent=t.discount_percent,this.selectElement.appendChild(e)})),console.log("‚úÖ Subscription options updated:",JSON.stringify(t,null,2))):console.error("WWAI-ERROR ‚ùå Invalid subscription options received.")}getSelectedPlanId(){return this.selectElement.value||null}getCurrentSelectedPlan(){const t=this.selectElement.options[this.selectElement.selectedIndex];return t?{option_name:t.textContent.trim(),selling_plan_id:t.value.trim(),before_price:t.dataset.beforePrice?.trim(),after_price:t.dataset.afterPrice?.trim(),discount_percent:t.dataset.discountPercent?.trim()}:(console.warn("‚ö†Ô∏è No plan currently selected."),null)}}customElements.define(o.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY,rt);const st="data-wwai-variant-custom-label-text",at="data-wwai-variant-custom-label-value",lt=`[${st}]`;class ct extends e{connectedCallback(){}updateCustomLabels(t){if("object"!=typeof t||!t)return void console.error("WWAI-ERROR ‚ùå Invalid label data received:",t);const e=this.querySelectorAll(`[${st}]`);e.length?e.forEach((e=>{const o=e.getAttribute(at),n=t[o];n?(e.textContent=n,console.log(`‚úÖ Updated label for ${o}:`,n)):console.warn(`‚ö†Ô∏è No label found for type: ${o} in labelData`)})):console.warn(`‚ö†Ô∏è No elements found with ${st} inside <product-variant-custom-labeled-text> (section: ${this.sectionId}, group: ${this.productGroup})`)}}function dt(t){t&&0!==t.length&&t.forEach((t=>{t.hasAttribute("autocomplete")||t.setAttribute("autocomplete","off")}))}function ut(t){return[...t].filter((t=>t.checked))}function pt(t){return t.find((t=>t.getAttribute(J)===tt))?.getAttribute(X)}function gt(t,e,o){let n=!1;return t.forEach((t=>{const o=t.getAttribute(X)?.trim(),i=o===e.trim();t.checked=i,i&&(n=!0)})),n||console.warn(`‚ùå No radio input matched product label: "${e}" in <product-variant-selector> [${o}].`),n}function ft(t,e){const o={};return t.forEach((t=>{const n=t.getAttribute(X)?.trim(),i=t.getAttribute(Z)||"option1",r=t.getAttribute(Q)?.trim();n===e.trim()&&(o[i]||(o[i]=new Set),o[i].add(r))})),o}function ht(t,e,o){let n=!0;return Object.entries(e).forEach((([e,i])=>{i.size>1&&!(e in o)&&(console.warn(`‚ùå Missing required variant option for "${e}" (multiple options exist) in product "${t}"`),n=!1)})),n}function bt(t,e,o){let n=!0;return Object.entries(o).forEach((([o,i])=>{let r=!1;const s=i.trim();t.forEach((t=>{const n=t.getAttribute(X)?.trim(),i=t.getAttribute(Z)||"option1",a=t.getAttribute(Q)?.trim();n===e.trim()&&i===o?(t.checked=a===s,a===s&&(r=!0)):n!==e.trim()&&(t.checked=!1)})),r||(console.warn(`‚ö†Ô∏è No match for [${o} = "${s}"] in product "${e.trim()}"`),n=!1)})),n}function mt(t){const e=t?t.inputs:null;if(!e||0===e.length)return console.error(`WWAI-ERROR [buildProductHierarchyFromSelector] ‚ùå No inputs found on selector: ${t}`),null;const o=new Set,n={};e.forEach((t=>{const e=t.getAttribute(J),i=t.getAttribute(X);if(i&&(o.add(i),n[i]||(n[i]={}),"product_variant"===e)){const e=t.getAttribute(Q),o=t.getAttribute(Z)||"option1";n[i][o]||(n[i][o]=new Set),n[i][o].add(e)}}));const i={productLabels:[...o],variants:{}};return Object.entries(n).forEach((([t,e])=>{i.variants[t]={},Object.entries(e).forEach((([e,o])=>{i.variants[t][e]=[...o]}))})),i}function wt({rootElement:t,variantRadios:e,inputs:o,sectionId:n,productGroup:i,uxConfig:r={}}){if(!r)return void console.warn("‚ö†Ô∏è No variant UX config provided.");const{hideSingleLengthVariants:s,onlyShowVariantsWithLabelContains:a}=r;if(!e||!e.length)return void console.warn(`‚ö†Ô∏è No variant radios found in <product-variant-selector> [${n}].`);const l=pt(ut(o)),c=mt(t);s&&(console.log(`üîß Hiding single-length variants for [${i}, ${n}]`),function(t,e,o,n){if(!n)return;console.log(`üõ†Ô∏è Hiding single size variants for product: ${e}`);const i=o.variants[e];Object.entries(i).forEach((([e,o])=>{if(1===o.length){console.log(`üîç Single variant detected at ${e}: ${o[0]}`);const n=o[0].trim();t.forEach((t=>{const o=t.getAttribute(Z)||"option1",i=t.getAttribute(Q)?.trim();if(o===e&&i===n){console.log(`üôà Hiding input for ${e} = ${n}`),t.parentElement.style.display="none",t.checked=!0;let o=t.parentElement,i=!1;for(let t=0;t<5&&o;t++){if(o.hasAttribute("data-wwai-product-variant-option-wrapper")){console.log("üéØ Found wrapper, setting display to none"),o.style.display="none",i=!0;break}o=o.parentElement}i||console.log(`‚ö†Ô∏è No wrapper found for ${n}`)}}))}}))}(e,l,c,s)),a&&(console.log(`üîß Showing only variants matching "${a}" for [${i}, ${n}]`),function(t,e){if(!e)return;const o=e.trim().toLowerCase();t.forEach((t=>{const e=t.getAttribute("data-wwai-product-variant-label-key")?.trim().toLowerCase();if(e&&e.includes(o)){"none"===t.parentElement.style.display&&(t.parentElement.style.display="");let e=t.parentElement;for(let t=0;t<5&&e;t++){if(e.hasAttribute("data-wwai-product-variant-option-wrapper")){"none"===e.style.display&&(console.log("‚Ü™Ô∏è Display was 'none', reverting back to original"),e.style.display="");break}e=e.parentElement}}else{t.parentElement.style.display="none";let e=t.parentElement;for(let t=0;t<5&&e;t++){if(e.hasAttribute("data-wwai-product-variant-option-wrapper")){e.style.display="none";break}e=e.parentElement}}}))}(e,a))}function _t(t){if("number"!=typeof t||isNaN(t))return"";const e="number"==typeof R().CURRENCY_FACTOR?R().CURRENCY_FACTOR:.01,o=R().CURRENCY||"USD",n=t*e;return new Intl.NumberFormat(void 0,{style:"currency",currency:o}).format(n)}function yt(){return window.__WWAI__SECTION_PRODUCT_DATA__&&window.__WWAI__SECTION_PRODUCT_DATA__.all_sections?window.__WWAI__SECTION_PRODUCT_DATA__.all_sections:(console.warn("‚ö†Ô∏è No data found for section: all_sections."),null)}function vt(t,e){if(e.startsWith("wwai_virtual_bundle__"))return{};const o=yt();if(!o||!o.storeData||!o.storeData.productGroups)return console.warn("‚ö†Ô∏è Invalid globalSectionData."),null;const n=o.storeData.productGroups[t];return n&&n[e]?n[e]:(console.warn(`‚ö†Ô∏è Product "${e}" not found in product group "${t}".`),null)}function Ct(...t){return t.filter((t=>null!=t)).map((t=>t.trim()))}function Ot(t,e){const o=Ct(t.option1,t.option2,t.option3);return e.length===o.length&&e.every(((t,e)=>t===o[e]))}function At(t,e){let o=(n=t,i=e,Array.isArray(window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__)&&window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__.length>0?function(t,e,o){for(const n of t){const t=n.split(":").map((t=>t.trim()));if(t[0]===e&&t[1]===o)return t[2]}return null}(window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__,n,i):null);var n,i;if(window.WWAI_VIRTUAL_BUNDLE_CONFIG&&window.WWAI_VIRTUAL_BUNDLE_CONFIG.hasOwnProperty(o)){const e=window.WWAI_VIRTUAL_BUNDLE_CONFIG[o],n=function(t,e,o){const n=`wwai_bundle - ${e.map((t=>t?.title||"Unknown")).join(" + ")}`;let i=0,r=0,s=!0;const a=[];return e.forEach(((t,e)=>{const n=o[e]?.quantity||1,l=null!=t.compare_at_price?t.compare_at_price:t.price;i+=t.price*n,r+=l*n,t.available||(s=!1),a.push({id:t.id,quantity:n})})),{id:`wwai_bundle_${t}`,title:n,available:s,price:i,compare_at_price:r,add_to_cart_payload:a}}(t,e.map((t=>It(t.handle,t.handle,...t.variantOptions))),e);return n}return null}function It(t,e,o,n=null,i=null){const r=vt(t,e);if(!r)return null;if(e.startsWith("wwai_virtual_bundle__")){let o=At(t,e);return console.log("Resolved virtual bundle:",t,e,o),o}const s=r.variants||[],a=Ct(o,n,i);if(1===a.length&&"__wwai_first__"===a[0])return window.customProductEventLoggingEnabled&&console.log("Returning first variant due to __wwai_first__ directive."),s[0];for(let t of s)if(Ot(t,a))return t;return 1===s.length?s[0]:(console.warn(`‚ö†Ô∏è No matching variant found for options [${a.join(", ")}] in product "${e}" under group "${t}".`),null)}function Et(t,e,o=null){const n=function(t,e){const o=yt();if(!o||!o.storeData||!o.storeData.variantSellingPlans)return console.warn("‚ö†Ô∏è Invalid globalSectionData or missing variantSellingPlans."),null;const n=`${t}__${e}`;return o.storeData.variantSellingPlans[n]||(console.warn(`‚ö†Ô∏è No selling plan found for productGroup="${t}" and productLabel="${e}"`),null)}(t,e);if(!n)return console.warn(`‚ùå Cannot build subscription mapping ‚Äî selling plan data missing for ${t} / ${e}`),null;const{variants:i,selling_plan_groups:r}=n;return Array.isArray(i)&&Array.isArray(r)?function(t,e,o=null){let n={};return t.forEach((t=>{const i=t.id,r=t.title,s=t.price;let a=[];const l=Array.isArray(t.selling_plan_allocations)&&t.selling_plan_allocations.length>0;(t.selling_plan_allocations||[]).forEach((t=>{const n=t.selling_plan_id,i=t.price_adjustments||[];let r=s,l=null;i.forEach((t=>{1===t.position?r=t.price:2===t.position&&(l=t.price)})),null===l&&(l=r),e.forEach((t=>{t.selling_plans.forEach((t=>{if(t.id===n){let e=t.name;o&&e.startsWith(o)&&(e=e.substring(o.length).trim()),a.push({selling_plan_id:n,delivery_option:e,base_price:s,first_order_price:r,subsequent_order_price:l})}}))}))})),n[`${i}, ${r}`]={variant_id:i,variant_title:r,has_subscription:l,selling_plans:a}})),n}(i,r,o):(console.warn("‚ùå Invalid variants or selling_plan_groups format."),null)}function Rt(t,e,o,n){if(!(t&&e&&o&&n))return console.warn("‚ùå Invalid product group, product label, variant object, or config."),null;const i=Et(t,e,n.uxConfig.variantOptionRemovePrefix),r=null==R().useMockSubscription?(console.warn("‚ö†Ô∏è Missing or invalid 'useMockSubscription' in window object."),null):R().useMockSubscription,s=function(t,e,o,n=!1){if(!t||"object"!=typeof t)return null;for(const i of Object.keys(t)){const[r,s]=i.split(", ").map((t=>t.trim()));if(n?s===o:r===String(e))return t[i]}return null}(i,o.id,o.title,r);return s}function Tt(t,e){const o={};return new Set([...Object.keys(e||{}),...Object.keys(t||{})]).forEach((n=>{const i=t?.[n],r=e?.[n];null!=i?o[n]=i:null!=r&&(o[n]=r)})),o}function St(t,e,o=null){const n=o||R().WWAI_PRODUCT_GROUP_CONFIG;if(!n||"object"!=typeof n)return console.error("WWAI-ERROR ‚ùå getWWAIConfig().WWAI_PRODUCT_GROUP_CONFIG is missing or invalid."),null;t.includes("__")?t=t.split("__")[1]:t.includes("--")&&(t=t.split("--")[1]);const i=n[t];if(!i)return console.warn(`‚ùå No config found for sectionId "${t}"`),null;const r=i[e];if(!r)return console.warn(`‚ùå No product group config found for "${e}" in section "${t}"`),null;const s=i.defaults||{};return{pricingConfig:Tt(r.pricingConfig,s.pricingConfig),uxConfig:Tt(r.uxConfig,s.uxConfig),flowConfig:Tt(r.flowConfig,s.flowConfig),variantDispatchConfig:r.variantDispatchConfig||{}}}function Pt(t,e,o,n){console.log(`üîÑ Resolving Product Data for: [${e}] - ${o}`);const i=St(t,e),r=function(t,e,o,n={}){if(o.startsWith("wwai_virtual_bundle"))return{};const i=R().WWAI_PRODUCT_VARIANT_OVERRIDES;if(!i)return console.error("WWAI-ERROR ‚ùå WWAI_PRODUCT_VARIANT_OVERRIDES not found on window."),null;let r=t;if(r.includes("__")?r=r.split("__")[1]:r.includes("--")&&(r=r.split("--")[1]),!i[r]||!i[r][e])return console.warn(`‚ùå Section "${r}" or product group "${e}" not found in overrides.`),null;const s=i[r][e][o];if(!s)return console.warn(`‚ùå Product label "${o}" not found in overrides under group "${e}".`),null;const a=[n.option1,n.option2,n.option3].filter(Boolean).map((t=>t.trim())).join(" | ");return s[a]||(console.warn(`‚ùå Variant key "${a}" not found under product "${o}".`),null)}(t,e,o,n),{product:s,variant:a}=function(t,e,o={}){console.group("[resolveVariantFromWindowProduct]"),console.log("Product Group:",t),console.log("Product Label:",e),console.log("Variant Options:",o),console.groupEnd();const n=o.option1||null,i=o.option2||null,r=o.option3||null,s=vt(t,e);return s?{product:s,variant:It(t,e,n,i,r)}:{product:null,variant:null}}(e,o,n);return s&&a?{config:i,variant_config:r,product_object:s,variant_object:a}:(console.error(`WWAI-ERROR ‚ùå Failed to resolve product or variant data for ${o}`),{config:i,variant_config:r,product_object:null,variant_object:null})}customElements.define(o.PRODUCT_GROUP.VARIANT_CUSTOM_LABEL,ct);const{PRICE:xt,VARIANT_CUSTOM_LABEL:$t,CAROUSEL:Dt,PURCHASE_TYPE:Ut,SUBSCRIPTION_FREQUENCY:Nt,ADD_TO_CART:Wt,GRID_SMART_INTERACTION:Lt,TITLE:Gt}=o.PRODUCT_GROUP;function kt({productObject:t,variantObject:e,variantConfig:o,productGroup:n,productLabel:i,config:r,purchaseType:s=null}){const a=function(t,e,o={}){if(!e||"number"!=typeof e.price)return console.error("WWAI-ERROR ‚ùå Invalid variant provided."),{price:"$0.00",compareAtPrice:"$0.00",discount_percent:"0.00"};let n=o?.discountPercent??0;null!=o?.productLabelDiscountMapping&&null!=o?.productLabelDiscountMapping[t]&&o?.productLabelDiscountMapping[t]?.discountPercent&&(n=o?.productLabelDiscountMapping[t]?.discountPercent);let i=e.price,r=e.compare_at_price||null;n>0&&(r=Math.max(e.price,e.compare_at_price||0),i=e.price-e.price*n/100),r||(r=e.price);const s=r>0?(r-i)/r*100:0,a=parseInt(s,10),l=a===s?a:s.toFixed(2);let c=r-i;return c<0&&(c=0),{price:_t(i),compareAtPrice:_t(r),discount_percent:l,savings:_t(c)}}(i,e,r.pricingConfig),l=function(t,e){if(!t||!Array.isArray(t.media))return console.warn("‚ö†Ô∏è Invalid product or media array."),[];if(!e||!e.customMediaLabel)return t.media;const o=e.customMediaLabel,n=R().WWAI_LABELED_IMAGES?.[o];return Array.isArray(n)&&0!==n.length?n:(console.warn(`‚ö†Ô∏è No labeled media found for label "${o}". Falling back to product media.`),t.media)}(t,o),c=function(t,e,o){const n=t?.redirectToMediaIndex;if("number"==typeof n&&n>=0)return n;{console.log("No index found, falling back to product media");const t=o?.featured_media?.preview_image?.src;if(!t)return void console.log("Featured media src not found in variant object.");const n=(e?.media||[]).filter((t=>t?.src)).findIndex((e=>e.src===t));return console.log("Index found, returning index",n),-1!==n?n:void console.log("No matching media found in product.")}}(o,t,e),d=function(t,e,o,n){const i=Rt(t,e,o,n);if(!i)return console.warn("Selling plan info not found. Returning."),[];const r=n?.variant_option_remove_prefix||"";let s=null;null!=n?.pricingConfig?.productLabelDiscountMapping&&(s=n?.pricingConfig?.productLabelDiscountMapping[e]?.subscriptionDiscountPercent??null);const a=null!=s?s:n?.pricingConfig?.subscriptionDiscountPercent??0;return i.selling_plans.map((t=>{const e=t.base_price;let o=t.first_order_price;a>0&&(o=Math.round(o*(1-a/100)));const n=e>0?(e-o)/e*100:0;let i=t.delivery_option||"";r&&i.startsWith(r)&&(i=i.substring(r.length).trim());let s=e-o;return s<0&&(s=0),{option_name:i,selling_plan_id:String(t.selling_plan_id),before_price:_t(e),after_price:_t(o),savings:_t(s),discount_percent:n.toFixed(2)}}))}(n,i,e,r),u=function(t,e,o){const n=e?.pricingConfig?.defaultSubscriptionOption??null,i=e?.pricingConfig?.useVariantCompareAtPriceForSubscription??!0;if(!Array.isArray(t)||0===t.length)return console.warn("‚ö†Ô∏è No valid selling plan info provided."),{sellingPlanName:null,sellingPlanId:null,sellingPlanPriceObject:null};const r=n&&t.find((t=>t.option_name===n))||t[0],s=r.option_name,a=r.selling_plan_id,l=r.after_price;let c=r.before_price;return i&&o.compare_at_price&&(c=_t(o.compare_at_price)),{sellingPlanName:s,sellingPlanId:a,sellingPlanPriceObject:{price:l,compareAtPrice:c,discount_percent:r.discount_percent,savings:r.savings}}}(d,r,e);let p=null!=s?s:r.uxConfig.defaultPurchaseType;const g=function({variantObject:t,sellingPlanId:e,sellingPlanName:o,productObject:n,defaultPurchaseType:i}){if(!t||!n)return console.warn("‚ùå Invalid variant object or product object."),null;const r=i===P.SUBSCRIPTION,s=!1!==t.available;return{variantId:t.id,variantName:`${n.title} - ${t.title}`,productHandle:n.handle,available:s,sellingPlanId:r?e:null,sellingPlanName:r?o:null}}({variantObject:e,sellingPlanId:u.sellingPlanId,sellingPlanName:u.sellingPlanName,productObject:t,defaultPurchaseType:p});return{oneTimePrice:a,media:l,mediaIndex:c,sellingPlans:d,sellingPlanDetails:u,addToCartPayload:g}}function Mt({sectionId:t,productGroup:e,productLabel:n,variantOptions:i,productObject:r,variantObject:s,variantConfig:a,config:l,isReinitializing:c=!1}){const d=kt({productObject:r,variantObject:s,variantConfig:a,productGroup:e,productLabel:n,config:l}),u=q(t,e),p=t=>u.includes(t);!function({sectionId:t,productGroup:e,productLabel:n,variantOptions:i}){const r=k(t,e,o.PRODUCT_GROUP.VARIANT);if(!r)return;if("function"!=typeof r.setSelectedProductAndOptions)return void console.error("WWAI-ERROR ‚ùå <product-variant-selector> is missing setSelectedProductAndOptions()");r.setSelectedProductAndOptions(n,i)?console.log(`‚úÖ Default variant set for [${t} / ${e}] ‚Üí ${n}`,i):console.warn(`‚ö†Ô∏è Failed to set default product/options for section="${t}", group="${e}"`)}({sectionId:t,productGroup:e,productLabel:n,variantOptions:i}),function({sectionId:t,productGroup:e,labelText:n}){const i=k(t,e,o.PRODUCT_GROUP.VARIANT);if(!i)return;const r=i.querySelector(`[${K}]`);r?(r.textContent=n,console.log(`‚úÖ Variant label text updated for [${t} / ${e}] ‚Üí ${n}`)):console.warn(`‚ö†Ô∏è No element found with ${K} in [${t} / ${e}]`)}({sectionId:t,productGroup:e,labelText:s.title||""}),p($t)&&function({sectionId:t,productGroup:e,labelData:n={}}){const i=k(t,e,o.PRODUCT_GROUP.VARIANT_CUSTOM_LABEL);i&&("function"==typeof i.updateCustomLabels?(i.updateCustomLabels(n),console.log(`‚úÖ Custom labels updated for [${t} / ${e}] ‚Üí`,n)):console.error("WWAI-ERROR ‚ùå <product-variant-custom-labeled-text-selector> is missing .updateCustomLabels()"))}({sectionId:t,productGroup:e,labelData:a?.customLabelText||{}}),p(xt)&&ot({sectionId:t,productGroup:e,oneTimePrice:d.oneTimePrice,subscriptionPrice:d.sellingPlanDetails.sellingPlanPriceObject,purchaseType:l.uxConfig.defaultPurchaseType}),p(Dt)&&it({sectionId:t,productGroup:e,config:l,media:d.media,moveToIndex:d.mediaIndex,isReinitializing:c}),p(Ut)&&nt({sectionId:t,productGroup:e,oneTimePrice:d.oneTimePrice,subscriptionPrice:d.sellingPlanDetails.sellingPlanPriceObject,purchaseType:l.uxConfig.defaultPurchaseType,onlySetPurchaseType:!1}),p(Nt)&&function({sectionId:t,productGroup:e,subscriptionOptions:n}){const i=k(t,e,o.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY);i&&("function"==typeof i.updateSubscriptionOptions?(console.log("subscriptionOptions:",n),i.updateSubscriptionOptions(n),console.log(`‚úÖ Default subscription frequency set for [${t} / ${e}] ‚Üí Selling Plan Length: ${n.length}`)):console.error("WWAI-ERROR ‚ùå <product-subscription-frequency-selector> is missing .updateSubscriptionOptions()"))}({sectionId:t,productGroup:e,subscriptionOptions:d.sellingPlans}),p(Wt)&&function({sectionId:t,productGroup:e,addToCartPayload:n}){const i=k(t,e,o.PRODUCT_GROUP.ADD_TO_CART);i&&(i&&"function"==typeof i.updateAddToCartForm?i.updateAddToCartForm(n):console.error("WWAI-ERROR ‚ùå Could not find <product-custom-add-to-cart-button-selector> or missing .updateAddToCartForm()"))}({sectionId:t,productGroup:e,addToCartPayload:d.addToCartPayload}),p(Lt)&&(console.log("üîÑ Updating Grid Smart Interaction Availability:",t,e,d.addToCartPayload),function(t,e,n){const i=G(t,e,o.PRODUCT_GROUP.GRID_SMART_INTERACTION),r=!0===n?.available;i.forEach(((t,e)=>{"function"==typeof t.updateAvailability?(t.updateAvailability(r,"Out of stock"),console.log(`üîÑ Grid Smart Interaction Button [${e}] availability set to: ${r}`)):console.warn(`‚ö†Ô∏è Grid Smart Interaction Button [${e}] is missing .updateAvailability()`)}))}(t,e,d.addToCartPayload)),p(Gt)&&function({sectionId:t,productGroup:e,title:n}){const i=k(t,e,o.PRODUCT_GROUP.TITLE);i&&("function"==typeof i.updateTitle?(i.updateTitle(n),console.log(`‚úÖ Title updated for [${t} / ${e}] ‚Üí ${n}`)):console.error("WWAI-ERROR ‚ùå <product-custom-title-selector> is missing .updateTitle()"))}({sectionId:t,productGroup:e,title:r.title})}class qt extends e{constructor(){super(),this.scope=this.getAttribute("wwai-scope")||null,this.product_helper_handle=this.getAttribute("product-helper-handle")||null,this.handlers={},this.uxConfig=null,this.inputs=null}connectedCallback(){this.initInputs(),this.bindEvents(),this.ensureAutocompleteOff()}getProductRadios(){return this.querySelectorAll(`input[type="radio"][${J}="${tt}"]`)}getVariantRadios(){return this.querySelectorAll(`input[type="radio"][${J}="${et}"]`)}initInputs(){this.inputs=this.querySelectorAll('input[type="radio"]')}ensureAutocompleteOff(){dt(this.inputs)}applyVariantUXConfig(){this.uxConfig&&this.uxConfig.variantUXConfig&&wt({rootElement:this,variantRadios:this.getVariantRadios(),inputs:this.inputs,sectionId:this.sectionId,productGroup:this.productGroup,uxConfig:this.uxConfig.variantUXConfig})}selectFirstVariantForProduct(t){for(let e of this.inputs)if(e.getAttribute(X)===t&&e.getAttribute(J)===et){console.log("üîÑ Pre selected variant not found, setting first variant as selected.",e),e.checked=!0;break}}initUXConfig(t){super.initUXConfig(t),this.applyVariantUXConfig()}handleVariantUpdate(){clearTimeout(this._debounceTimeout),this._debounceTimeout=setTimeout((()=>{const{productLabel:t,variantOptions:e}=this.getSelectedVariant();if(!t||!e)return;const o={productLabel:t,variantOptions:e};console.group("[WWAI] üîÑ Variant Change Detected"),console.log("üõí Product Label:",t),console.log("üéØ Variant Options:",e),console.groupEnd(),console.log("üîÅ Trigger handler on change or re-click"),this.triggerHandler("variantChange",o),this.uxConfig&&this.uxConfig.variantUXConfig&&!1===this.uxConfig.variantUXConfig.refreshUxOnVariantChange?console.log("üîÑ Refresh UX on variant change is disabled. Skipping reinitialization."):function(t,e,o,n){console.log(`üîÑ Reinitializing Product Group on Variant Change: [${e}] - ${o}`);const{config:i,variant_config:r,product_object:s,variant_object:a}=Pt(t,e,o,n);s&&a?(Mt({sectionId:t,productGroup:e,productLabel:o,variantOptions:n,productObject:s,variantObject:a,variantConfig:r,config:i,isReinitializing:!0}),console.log(`‚úÖ Reinitialized Product Group: ${e} for Variant ${o}`)):console.error(`WWAI-ERROR ‚ùå Unable to reinitialize product group for ${e}`)}(this.sectionId,this.productGroup,t,e)}),0)}bindEvents(){const t=this.handleVariantUpdate.bind(this);this.inputs.forEach((e=>{e.addEventListener("change",t),e.addEventListener("click",t)}))}registerHandler(t,e){t&&"function"==typeof e?(this.handlers[t]=this.handlers[t]||[],this.handlers[t].push(e),console.log(`‚úÖ Handler registered for type: ${t}`,e)):console.warn("‚ö†Ô∏è Invalid handler registration:",{type:t,callback:e})}triggerHandler(t,e){const o=this.handlers?.[t]||[];o.length&&(console.log(`‚ñ∂Ô∏è Running ${o.length} handler(s) for type: ${t}`,o),o.forEach((o=>{try{o(e)}catch(e){console.error(`WWAI-ERROR ‚ùå Error in handler for type "${t}":`,e)}})))}getSelectedVariant(){let t=ut(this.inputs);const e=pt(t);if(!e)return console.warn(`‚ö†Ô∏è No selected product label found in <product-variant-selector> [${this.sectionId}].`),null;let o=t.filter((t=>t.getAttribute(X)===e)),n=!1;o.forEach((t=>{t.getAttribute(Q)&&(n=!0)})),n||(this.selectFirstVariantForProduct(e),t=ut(this.inputs),o=t.filter((t=>t.getAttribute(X)===e)));const i=function(t,e){const o={},n={};return t.forEach((t=>{if(t.getAttribute(J)===et&&t.getAttribute(X)===e){const i=t.getAttribute(Z)||"option1",r=t.getAttribute(Q);n[i]?console.warn(`‚ùå Multiple variant options selected for "${i}" in product "${e}"`):(o[i]=r,n[i]=!0)}})),0===Object.keys(o).length?(console.warn(`‚ùå No variant options found for product "${e}", Returning default option "__wwai_first__"`),{option1:"__wwai_first__"}):o}(o,e);return{productLabel:e,variantOptions:i}}setSelectedProductAndOptions(t,e={}){const o=this.getProductRadios();if(!o.length)return console.warn(`‚ö†Ô∏è No product radio inputs found in <product-variant-selector> [${this.sectionId}].`),!1;if(!gt(o,t,this.sectionId))return!1;const n=this.getVariantRadios(),i=ht(t,ft(n,t),e);this.applyVariantUXConfig();const r=bt(n,t,e);return window.customProductEventLoggingEnabled&&console.log(`‚úÖ Set product: "${t}", selected options:`,e),i&&r}}customElements.define(o.PRODUCT_GROUP.VARIANT,qt);class jt extends e{constructor(){super()}connectedCallback(){}}function Bt(t,e){const o=document.querySelector(`product-variant-selector[section_id="${t}"][product_group="${e}"]`);return o||(console.error(`WWAI-ERROR ‚ùå No <product-variant-selector> found for section: ${t}, group: ${e}`),null)}function Vt(t,e,o){const{config:n,variant_config:i,product_object:r,variant_object:s}=Pt(e,o,t.productLabel,t.variantOptions);if(!s||!r)return console.error("WWAI-ERROR ‚ùå Variant or Product Object not found during resolution."),null;const a=r.title||"Unknown Product",l=s.title||"One-time purchase";return[{id:s.id,quantity:1,_debug:{source:"manual",variantId:s.id,quantity:1,sellingPlan:null,bundlePayload:!1,readableString:`${a} - ${l} (Qty: 1)`}}]}function Ht(t,e,o,n){const{config:i,variant_config:r,product_object:s,variant_object:a}=Pt(e,o,t.productLabel,t.variantOptions),{optionMapping:l,reversedMapping:c}=function(t,e){if(!t||!e)return console.error("WWAI-ERROR ‚ùå Product or Variant object is missing."),null;const o=t.options,n={option1:e.option1,option2:e.option2,option3:e.option3},i={},r={};return o.forEach(((t,e)=>{const o=n[`option${e+1}`];o&&(i[t]=o,r[o]=t)})),{optionMapping:i,reversedMapping:r}}(s,a);return a&&s?function(t,e,o,n){if(!t||!e||!o)return console.error("WWAI-ERROR ‚ùå One or more required objects are missing."),null;if(1!=n.length)return console.error("WWAI-ERROR ‚ùå Expected labelKeyToKeepList to have length 1."),null;const i=t.handle,r=e.id,s=n[0];if(!i||!r)return console.error("WWAI-ERROR ‚ùå Product handle or variant ID is missing."),null;let a=`/products/${i}?variant=${r}`;return Object.entries(o).forEach((([t,e])=>{if(e.replace(/\s+/g,"-").toLowerCase().includes(s.toLowerCase())){const e=t;a+=`&${s.toLowerCase()}=${e}`}})),a}(s,a,c,n):(console.error("WWAI-ERROR ‚ùå Variant or Product Object not found during resolution."),null)}function Ft(t,e,o){console.log("üü© [Direct Add Handler]"),console.log("Section ID:",t),console.log("Product Group:",e),function(t,e,o){const n=Vt(Bt(t,e).getSelectedVariant(),t,e);console.log(`üåê Triggering add to cart for Section ID: ${t} and Product Group: ${e}`),I(n,o,t,e,"local"===R().deployMode,null)}(t,e,o)}function zt(t,e,o){console.log("üîÅ [Redirect Handler]"),console.log("Section ID:",t),console.log("Product Group:",e),function(t,e,o){const n=`/products/${Bt(t,e).getSelectedVariant().productLabel}`;console.log("üõ†Ô∏è Redirecting to url:",n),C(n,o,t,e,"local"===R().deployMode)}(t,e,o)}function Yt(t,e,o,n){console.log("üîÅ [Custom Redirect Handler]"),console.log("Section ID:",t),console.log("Product Group:",e),function(t,e,o,n){const i=n;console.log("üõ†Ô∏è Redirecting to url:",i),C(i,o,t,e,"local"===R().deployMode)}(t,e,o,n.custom_url)}function Jt(t,e,o,n,i){console.log("üü¶ [Overlay Handler]"),console.log("Section ID:",t),console.log("Product Group:",e),console.log("Post-Selection Action:",n,i);const r=function(t,e){const o=document.querySelector(`product-custom-collection-options-overlay-selector[section_id="${t}"][product_group="${e}"]`);return o||(console.error(`WWAI-ERROR ‚ùå No <product-custom-collection-options-overlay-selector> found for section: ${t}, group: ${e}`),null)}(t,e);if(!r)throw console.error(`WWAI-ERROR ‚ùå Cannot open overlay ‚Äî no matching element found for sectionId=${t}, productGroup=${e}`),new Error("Overlay not found. Cannot proceed with interaction.");console.log("‚úÖ Found overlay, opening now..."),r.openOverlay();let s=null;if("redirect"===n){console.log("‚è≠ Will redirect after selection.");s=function(t,e,o,n){if(t&&e)return console.log(`üåê Triggering redirect for Section ID: ${t} and Product Group: ${e}`),i=>{if(!i)return console.error("WWAI-ERROR ‚ùå Selected variant is not provided."),null;const r=Ht(i,t,e,n);console.log("üõ†Ô∏è Redirecting to url:",r);const s=R().deployMode;C(r,o,t,e,"local"===s)};console.error("WWAI-ERROR ‚ùå Missing sectionId or productGroup.")}(t,e,o,i.redirect_variant_options)}else"add-to-cart"===n?(console.log("‚úÖ Add to cart after selection."),s=function(t,e,o){if(t&&e)return n=>{if(!n)return console.error("WWAI-ERROR ‚ùå Selected variant is not provided."),null;const i=Vt(n,t,e);console.log(`üåê Triggering add to cart for Section ID: ${t} and Product Group: ${e}`);const r=R().deployMode;I(i,o,t,e,"local"===r,null)};console.error("WWAI-ERROR ‚ùå Missing sectionId or productGroup.")}(t,e,o)):"na"===n?console.log("‚úÖ No post-selection action required."):console.warn("‚ö†Ô∏è Unknown postSelectionAction:",n);if(s){window.__WWAI_HANDLER_REGISTRY=window.__WWAI_HANDLER_REGISTRY||{};const o=`${t}_${e}_variantChange`;if(!window.__WWAI_HANDLER_REGISTRY[o]){const n=Bt(t,e);n?(n.registerHandler("variantChange",s),window.__WWAI_HANDLER_REGISTRY[o]=!0,console.log(`üîÅ Registered variantChange handler for key: ${o}`)):console.warn(`‚ö†Ô∏è Cannot register handler ‚Äî variant selector not found for sectionId=${t}, productGroup=${e}`)}}}function Xt(t,e,o,n){if(t){if(console.log("setting availability state",e,o),e)return t.disabled=!1,t.removeAttribute("data-tooltip"),void t.classList.remove("wwai-out-of-stock");n&&(!function(t,e="Out of stock"){const o=t.parentElement;if(o&&o.classList.contains("tooltip-wrapper"))return void o.setAttribute("data-tooltip",e);const n=document.createElement("div");n.classList.add("tooltip-wrapper"),n.setAttribute("data-tooltip",e),o.replaceChild(n,t),n.appendChild(t)}(t,o),t.disabled=!0,t.classList.add("wwai-out-of-stock"))}else console.log("No button found when setting availability state")}customElements.define(o.PRODUCT_GROUP.PRODUCT_MEDIA_GALLERY_FOR_GRIDS,jt);class Qt extends e{constructor(){super(),this.button=null,this.flowConfig=null,this.uxConfig=null,this.isAvailable=!0}handleSmartIntentClick(){if(!this.uxConfig||!this.uxConfig.preAddToCartFlowConfig)return void console.warn("‚ùå Missing preAddToCartFlowConfig in uxConfig inside ProductGridSmartInteractionButtonSelector");if(!this.flowConfig)return void console.warn("‚ùå Missing flowConfig inside ProductGridSmartInteractionButtonSelector");const t=this.uxConfig.preAddToCartFlowConfig,e=t.journeyType,o=t.postSelectionAction,n=t?.postSelectionActionParams||{};if("custom-redirect"!==e&&this.handleSingleVariantDirectAdd())return Ft(this.sectionId,this.productGroup,this.flowConfig),void console.log("‚úÖ Single variant product detected, proceeding with direct add for [${this.sectionId} / ${this.productGroup}]");switch(e){case"direct-add":Ft(this.sectionId,this.productGroup,this.flowConfig);break;case"redirect":zt(this.sectionId,this.productGroup,this.flowConfig);break;case"overlay":Jt(this.sectionId,this.productGroup,this.flowConfig,o,n);break;case"custom-redirect":Yt(this.sectionId,this.productGroup,this.flowConfig,n);break;default:console.warn(`‚ùå Unknown journeyType "${e}" for product group ${this.productGroup}`)}}handleSingleVariantDirectAdd(){const t=k(this.sectionId,this.productGroup,o.PRODUCT_GROUP.VARIANT);if(!t)return void console.warn(`‚ùå No variant selector found for [${this.sectionId} / ${this.productGroup}]`);const{productLabel:e,variantOptions:n}=t.getSelectedVariant();let i=null;try{i=vt(this.productGroup,e)}catch(t){return console.warn(`‚ùå Error getting product from group for [${this.sectionId} / ${this.productGroup}]:`,e,t),!1}const r=k(this.sectionId,this.productGroup,o.PRODUCT_GROUP.COLLECTION_OPTIONS_OVERLAY);if(r){const t=r.querySelector(o.PRODUCT_GROUP.VARIANT),e=r.querySelector(o.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY);if(t&&!e&&(console.log(`‚úÖ Found variant selector inside smart interaction button for [${this.sectionId} / ${this.productGroup}]`),i&&i.variants&&1===i.variants.length))return console.log(`‚úÖ Single variant product detected, proceeding with direct add for [${this.sectionId} / ${this.productGroup}]`),!0}return!1}connectedCallback(){!function(){if(document.getElementById("wwai-smart-button-styles"))return;const t=document.createElement("style");t.id="wwai-smart-button-styles",t.textContent="\n        product-grid-smart-interaction-button-selector button.wwai-out-of-stock {\n        opacity: 0.5;\n        cursor: not-allowed;\n        pointer-events: none;\n        }\n\n        product-grid-smart-interaction-button-selector .tooltip-wrapper {\n        position: relative;\n        display: inline-block;\n        }\n\n        product-grid-smart-interaction-button-selector .tooltip-wrapper::after {\n        content: attr(data-tooltip);\n        position: absolute;\n        top: -30px;\n        left: 0;\n        background-color: #333;\n        color: #fff;\n        font-size: 12px;\n        padding: 4px 8px;\n        border-radius: 4px;\n        white-space: nowrap;\n        display: none;\n        z-index: 1000;\n        }\n\n        product-grid-smart-interaction-button-selector .tooltip-wrapper:hover::after {\n        display: block;\n        }\n    ",document.head.appendChild(t)}(),this.button=this.querySelector("button"),this.button?this.button.addEventListener("click",(t=>{console.log("product-grid-smart-interaction-button-selector clicked."),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),this.handleSmartIntentClick()})):console.error("WWAI-ERROR ‚ùå No button found inside <product-grid-icon-smart-add-to-cart-button-selector>")}initUXConfig(t){super.initUXConfig(t),this.updateAvailabilityView()}updateAvailability(t,e="Out of stock"){this.isAvailable=t,this.tooltipText=e,this.updateAvailabilityView()}updateAvailabilityView(){const t=this.uxConfig?.preAddToCartFlowConfig?.journeyType;let e="direct-add"===t;"custom-redirect"!=t&&(e=e||this.handleSingleVariantDirectAdd()),Xt(this.button,this.isAvailable,this.tooltipText,e)}}customElements.define(o.PRODUCT_GROUP.GRID_SMART_INTERACTION,Qt);class Zt extends e{constructor(){super(),this.overlayBody=null,this.closeButton=null}connectedCallback(){this.overlayBody=this.querySelector("[data-wwai-collection-options-overlay-visible]"),this.overlayBody?(this.closeButton=this.querySelector("[data-wwai-collection-options-overlay-close-btn]"),this.closeButton&&this.closeButton.addEventListener("click",(()=>{this.closeOverlay()}))):console.error("WWAI-ERROR ‚ùå No overlay body found with [data-wwai-collection-options-overlay-visible]")}openOverlay(){this.setContainerVisibility(!0)}closeOverlay(){this.setContainerVisibility(!1)}setContainerVisibility(t=!0){if(!this.overlayBody)return;t?this.overlayBody.classList.add("active"):this.overlayBody.classList.remove("active");document.querySelectorAll("product-custom-collection-options-overlay-selector").forEach((t=>{if(t!==this){const e=t.querySelector("[data-wwai-collection-options-overlay-visible]");e&&e.classList.remove("active")}}))}}customElements.define(o.PRODUCT_GROUP.COLLECTION_OPTIONS_OVERLAY,Zt);class Kt extends HTMLElement{constructor(){super(),this.sectionId=this.getAttribute("section_id"),this.expectedCards=parseInt(this.getAttribute("data-expected-cards"))||0,this.equalizationReady=!1,this.expectedRoles=this.discoverRoles()}connectedCallback(){console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ connectedCallback triggered`),this.checkIfCardsAreReady("init"),this.initMutationObserver(),this.initIntersectionObserver(),this.initResizeListeners(),this.initResizeObserver(),this.initCleanupHandler()}checkIfCardsAreReady(t="manual"){const e=this.querySelectorAll("[data-wwai-container-card]"),o=Array.from(e).filter((t=>{const e=t.querySelectorAll("[data-wwai-container-card-role]");return!(e.length<this.expectedRoles.length)&&Array.from(e).some((t=>""!==t.innerHTML.trim()))}));console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] üïµÔ∏è ${t} check: found ${e.length} cards, ${o.length} with roles, expecting ${this.expectedCards}`),e.length>=this.expectedCards&&o.length>=this.expectedCards&&this.expectedCards>0?(console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] üü¢ Cards ready, triggering equalize via: ${t}`),this.equalizationReady=!0,this.equalize(t),this.mutationObserver&&this.mutationObserver.disconnect()):console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚è≥ Waiting for cards... (${t})`)}initMutationObserver(){console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] üß¨ initMutationObserver set up`),this.mutationObserver=new MutationObserver((()=>{console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ mutationObserver triggered`),this.checkIfCardsAreReady("mutation-observer")})),this.mutationObserver.observe(this,{childList:!0,subtree:!0})}initIntersectionObserver(){this.intersectionObserver=new IntersectionObserver((t=>{console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ intersectionObserver triggered`),t.some((t=>t.isIntersecting))&&this.equalizationReady&&(console.info(`[${this.sectionId}] üì° Section entered viewport, re-running equalize`),this.equalize("intersection"))}),{threshold:.1}),this.intersectionObserver.observe(this)}initResizeListeners(){window.addEventListener("resize",(()=>{console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ resizeListener triggered`),this.equalizationReady&&this.debouncedEqualize("resize")})),window.addEventListener("orientationchange",(()=>{console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ orientationchangeListener triggered`),this.equalizationReady&&this.equalize("orientationchange")}))}initResizeObserver(){this.resizeObserver=new ResizeObserver((()=>{console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ resizeObserver triggered`),this.equalizationReady&&this.equalize("resize-observer")})),this.resizeObserver.observe(this)}initCleanupHandler(){this.disconnectedCallback=()=>{console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ disconnectedCallback triggered`),window.removeEventListener("resize",this.debouncedEqualize),window.removeEventListener("orientationchange",this.equalize),this.resizeObserver.disconnect(),this.mutationObserver.disconnect()}}debouncedEqualize(t="resize"){clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout((()=>this.equalize(t)),300)}getCards(){return this.querySelectorAll("[data-wwai-container-card]")}discoverRoles(){const t=this.querySelector("[data-wwai-container-card]");return t?Array.from(t.querySelectorAll("[data-wwai-container-card-role]")).map((t=>t.getAttribute("data-wwai-container-card-role"))).filter((t=>!!t)):[]}validateCards(t){this.getCards().forEach((e=>{t.forEach((t=>{e.querySelector(`[data-wwai-container-card-role="${t}"]`)||(R().heightEqualizeLogging&&console.log(`"[${this.sectionId}]"‚ùå Missing role "${t}" in card with label:`,e.dataset.wwaiContainerCardLabel),R().heightEqualizeLogging&&console.log(e))}))}))}generateEqualizedHeightMap(){const t=this.getCards(),e=this.discoverRoles(),o={},n=new Map;t.forEach((t=>{e.forEach((e=>{const o=t.querySelector(`[data-wwai-container-card-role="${e}"]`);if(o){const t=o.offsetHeight;n.set(o,t),o.style.minHeight=""}}))})),t.forEach((t=>{const e=Math.round(t.getBoundingClientRect().top);o[e]||(o[e]=[]),o[e].push(t)}));const i=Object.keys(o).map(Number).sort(((t,e)=>t-e)),r=[];return i.forEach(((t,i)=>{const s=o[t],a={};e.forEach((t=>{let e=0;s.forEach((o=>{const i=o.querySelector(`[data-wwai-container-card-role="${t}"]`);if(i){let o=i.offsetHeight;o<5&&n.has(i)&&(o=n.get(i),R().heightEqualizeLogging&&console.log(`[${this.sectionId}] ‚ö†Ô∏è Using fallback height for role "${t}" due to suspect value: ${o}px`)),o>5&&(e=Math.max(e,o+1))}})),a[t]=e})),r.push({rowIndex:i,heights:a})})),{section_id:this.sectionId,roles:e,rowCount:r.length,rows:r}}fillMissingHeights(t){const e=t.roles;let o={};return t.rows.forEach((t=>{e.forEach((e=>{const n=t.heights[e];n&&0!==n?o[e]=t.heights[e]:t.heights[e]=o[e]||0}))})),t}applyHeightMap(t){const e=this.getCards(),o=t.roles;t=this.fillMissingHeights(t);const n={};e.forEach((t=>{const e=Math.round(t.getBoundingClientRect().top);n[e]||(n[e]=[]),n[e].push(t)}));const i=Object.keys(n).map(Number).sort(((t,e)=>t-e)).map((t=>n[t]));t.rows.forEach(((t,e)=>{const n=i[e];n&&o.forEach((e=>{const o=t.heights[e];n.forEach((t=>{const n=t.querySelector(`[data-wwai-container-card-role="${e}"]`);n&&(n.style.minHeight=`${o}px`)}))}))}))}equalize(t="unknown"){console.log(`HEIGHT_EQUALIZER: [${this.sectionId}] ‚úÖ equalize triggered with height map by: ${t}`),R().heightEqualizeLogging&&console.log(`[${this.sectionId}] ‚ö° Equalize triggered with height map by: ${t}`);const e=this.getCards(),o=this.discoverRoles();if(!e.length||!o.length)return;this.validateCards(o);const n=this.generateEqualizedHeightMap();this.applyHeightMap(n)}}customElements.define(o.OTHER.PRODUCT_GRID_HEIGHT_EQUALIZER,Kt),window.generateAllEqualizedHeightMapsForDevice=function(){const t=document.querySelectorAll("product-grid-height-equalizer-selector"),e={};t.forEach((t=>{if("function"==typeof t.generateEqualizedHeightMap){const o=t.generateEqualizedHeightMap(),n=o.section_id||"",i=n.split("__")[1]||n;e[i]={...o,section_id:i}}}));const o=window.innerWidth<768,n=o?"CACHED_HEIGHTS_MOBILE":"CACHED_HEIGHTS_DESKTOP";window[n]=e;const i=`<script>\nwindow.${n} = ${JSON.stringify(e,null,2)};\n<\/script>`;return console.log(`‚úÖ Cached height mappings generated for ${o?"mobile":"desktop"}.\nCopy-paste this into your config:`),console.log(i),e},window.applyCachedHeightsOnLoad=function(){const t=window.innerWidth<768,e=t?window.CACHED_HEIGHTS_MOBILE:window.CACHED_HEIGHTS_DESKTOP;if(!e)return void console.warn(`[Equalizer] No cached heights found for ${t?"mobile":"desktop"}. Skipping initial height application.`);document.querySelectorAll("product-grid-height-equalizer-selector").forEach((t=>{const o=t.sectionId,n=o.includes("__")?o.split("__")[1]:o.split("--")[1]||o,i=e[n];i&&"function"==typeof t.applyHeightMap&&(t.applyHeightMap(i),R().heightEqualizeLogging&&console.log(`[${n}] üöÄ Applied cached height map from config.`))}))};class te extends e{constructor(){super()}connectedCallback(){}updateTitle(t){this.querySelectorAll("[data-wwai-product-variant-title]").forEach((e=>{e.textContent=t}))}}customElements.define(o.PRODUCT_GROUP.TITLE,te);const ee="data-wwai-product-label",oe="data-wwai-product-variant-option1-label",ne="data-wwai-product-variant-option2-label",ie="data-wwai-product-variant-option3-label";class re extends HTMLElement{constructor(){super(),this.sectionId=this.getAttribute("section_id"),this.productGroup=this.getAttribute("product_group")}connectedCallback(){this.attachLinkListeners()}triggerVariantChange(t,e){const n=k(this.sectionId,this.productGroup,o.PRODUCT_GROUP.VARIANT);n?(n.setSelectedProductAndOptions(t,e),n.handleVariantUpdate()):console.warn("‚ö†Ô∏è No variant selector found for section/group:",this.sectionId,this.productGroup)}attachLinkListeners(){Array.from(this.querySelectorAll("a")).filter((t=>{const e=t.hasAttribute(ee),o=t.hasAttribute(oe),n=t.hasAttribute(ne),i=t.hasAttribute(ie);return e&&(o||n||i)})).forEach((t=>{t.addEventListener("click",(e=>{e.preventDefault();const o=t.getAttribute(ee),n=t.getAttribute(oe),i=t.getAttribute(ne),r=t.getAttribute(ie),s={};null!==n&&(s.option1=n),null!==i&&(s.option2=i),null!==r&&(s.option3=r),console.log("üîÅ Triggering variant change:",{productLabel:o,options:s}),this.triggerVariantChange(o,s)}))}))}}customElements.define(o.PRODUCT_GROUP.VARIANT_TRIGGER,re);const se="data-wwai-product-variant-option-type",ae="data-wwai-product-label",le="data-wwai-purchase-type",ce="product",de="product_variant",ue={SUBSCRIPTION:"subscription",ONE_TIME:"one_time"},pe="combo_change";function ge(t,e,n){if(!n(o.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY_STATIC))return;G(t,e,o.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY_STATIC).forEach((o=>{!function(t,e,o){const n=t.productLabel,i=t.variantOptions,{config:r,variant_config:s,product_object:a,variant_object:l}=Pt(e,o,n,i);if(null==l)throw new Error("WWAI-ERROR ‚ùå Variant object is undefined for "+n+" "+i);const c=kt({productObject:a,variantObject:l,variantConfig:s,productGroup:o,productLabel:n,config:r,purchaseType:ue.SUBSCRIPTION});t.updateSubscriptionOptionsForStaticUse(c.sellingPlans)}(o,t,e)}))}function fe(t,e,o){const n=t.productLabel,i=t.variantOptions,r=t.priceLabel,{config:s,variant_config:a,product_object:l,variant_object:c}=Pt(e,o,n,i);if(null==c)throw new Error("WWAI-ERROR ‚ùå Variant object is undefined for "+n+" "+i);!function(t,e,o,n,i){const r=e.oneTimePrice,s=e.sellingPlanDetails.sellingPlanPriceObject;if("onetime"==o)t.updatePrice(r);else{if("subscription"!=o)throw new Error("WWAI-ERROR ‚ùå Invalid price label:"+o+" for sectionId:"+n+" productGroup:"+i);t.updatePrice(s)}}(t,kt({productObject:l,variantObject:c,variantConfig:a,productGroup:o,productLabel:n,config:s,purchaseType:ue.SUBSCRIPTION}),r,e,o)}function he({sectionId:t,productGroup:e}){const n=q(t,e),i=t=>n.includes(t);i(o.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO)?(ge(t,e,i),function(t,e,n){if(!n(o.PRODUCT_GROUP.PRICE_STATIC))return;G(t,e,o.PRODUCT_GROUP.PRICE_STATIC).forEach((o=>{fe(o,t,e)}))}(t,e,i)):console.error("WWAI-ERROR ‚ùå Variant purchase type combo selector not found for sectionId:",t,"productGroup:",e)}function be({sectionId:t,productGroup:e,productLabel:n,variantOptions:i,productObject:r,variantObject:s,variantConfig:a,config:l,purchaseType:c=null,setVariantAndSubscriptionSelection:d=!0}){const u=q(t,e);!function(t,e,n){if(!n.includes(o.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO))throw console.error("WWAI-ERROR ‚ùå Variant purchase type combo selector not found for sectionId:",t,"productGroup:",e),new Error("WWAI-ERROR ‚ùå Variant purchase type combo selector not found")}(t,e,u),function(t,e,n){let i=[o.PRODUCT_GROUP.ADD_TO_CART_BUTTON,o.PRODUCT_GROUP.SUBMIT_INTERCEPTOR,o.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY_STATIC,o.PRODUCT_GROUP.PRICE_STATIC].filter((t=>!n.includes(t)));if(i=i.filter((t=>void 0!==t)),i.length>0)throw new Error("WWAI-ERROR ‚ùå Unsupported Selectors for sectionId:"+t+" productGroup:"+e+" selectors_not_in_allowed_list:"+i.join(", "))}(t,e,u);const p=function(t,e,o,n){if(null!=t){if(!Object.values(ue).includes(t))throw new Error("WWAI-ERROR ‚ùå Invalid purchase type:"+t+" for sectionId:"+o+" productGroup:"+n);return t}if(e&&e.variantDispatchConfig&&e.variantDispatchConfig.purchaseType){const t=e.variantDispatchConfig.purchaseType;if(!Object.values(ue).includes(t))throw new Error("WWAI-ERROR ‚ùå Invalid purchase type:"+t+" for sectionId:"+o+" productGroup:"+n);return t}return ue.ONE_TIME}(c,l,t,e);d&&function({sectionId:t,productGroup:e,productLabel:n,variantOptions:i,purchaseType:r}){const s=k(t,e,o.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO);if(!s)return;if("function"!=typeof s.setSelectedCombo)return void console.error("WWAI-ERROR ‚ùå <product-variant-purchase-type-combo-selector> is missing setSelectedCombo()");s.setSelectedCombo({productLabel:n,variantOptions:i,purchaseType:r})?console.log(`‚úÖ Default variant set for [${t} / ${e}] ‚Üí ${n}`,i):console.warn(`‚ö†Ô∏è Failed to set default product/options for section="${t}", group="${e}"`)}({sectionId:t,productGroup:e,productLabel:n,variantOptions:i,purchaseType:p});const g=kt({productObject:r,variantObject:s,variantConfig:a,productGroup:e,productLabel:n,config:l,purchaseType:c});!function({sectionId:t,productGroup:e,addToCartPayload:n}){const i=G(t,e,o.PRODUCT_GROUP.ADD_TO_CART);i&&0!==i.length?i.forEach(((t,e)=>{t&&"function"==typeof t.updateAddToCartForm?t.updateAddToCartForm(n):console.error(`WWAI-ERROR ‚ùå AddToCart selector at index ${e} is missing .updateAddToCartForm()`)})):console.warn(`WWAI ‚ö†Ô∏è No <product-custom-add-to-cart-button-selector> found for [${t} / ${e}]`)}({sectionId:t,productGroup:e,addToCartPayload:g.addToCartPayload});var f;f=o.PRODUCT_GROUP.CAROUSEL,u.includes(f)&&it({sectionId:t,productGroup:e,media:g.media,moveToIndex:g.mediaIndex})}class me extends e{constructor(){super(),this.inputs=[],this.handlers={},this.scope=this.getAttribute("wwai-scope")||null,this.product_helper_handle=this.getAttribute("product-helper-handle")||null,this.debounceTimer=null}connectedCallback(){this.initInputs(),this.bindEvents(),this.ensureAutocompleteOff()}initInputs(){this.inputs=this.querySelectorAll('input[type="radio"]')}bindEvents(){const t=this.debouncedComboSelection.bind(this);this.inputs.forEach((e=>{e.addEventListener("change",t),e.addEventListener("click",t)}))}ensureAutocompleteOff(){dt(this.inputs)}debouncedComboSelection(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout((()=>{this.handleComboSelection()}),10)}handleComboSelection(){console.log("üîç Combo Selection Triggered");const t=this.getSelectedCombo();this.setSelectedCombo(t),function(t,e,o,n,i){const{config:r,variant_config:s,product_object:a,variant_object:l}=Pt(t,e,o,n);a&&l?be({sectionId:t,productGroup:e,productLabel:o,variantOptions:n,productObject:a,variantObject:l,variantConfig:s,config:r,purchaseType:i,setVariantAndSubscriptionSelection:!1}):console.error(`WWAI-ERROR ‚ùå Unable to reinitialize product group for ${e}`)}(this.sectionId,this.productGroup,t.productLabel,t.variantOptions,t.purchaseType),this.triggerHandler(pe,t)}registerHandler(t,e){t&&"function"==typeof e&&(this.handlers[t]=this.handlers[t]||[],this.handlers[t].push(e))}triggerHandler(t,e){(this.handlers?.[t]||[]).forEach((o=>{try{o(e)}catch(e){console.error(`WWAI ‚ùå Error in handler for type "${t}":`,e)}}))}getProductRadiosForPurchaseType(t){return[...this.inputs].filter((e=>e.getAttribute(se)===ce&&e.getAttribute(le)===t))}getVariantRadiosForPurchaseType(t){return[...this.inputs].filter((e=>e.getAttribute(se)===de&&e.getAttribute(le)===t))}getSelectedCombo(){const t=[...this.inputs].find((t=>t.checked&&t.getAttribute(se)===ce));if(!t)return null;const e=t.getAttribute(ae),o=t.getAttribute(le),n=[...this.inputs].filter((t=>t.getAttribute(se)===de&&t.getAttribute(ae)===e&&t.getAttribute(le)===o)),i={};return n.forEach((t=>{const e=t.getAttribute("data-wwai-product-variant-label-level"),o=t.getAttribute("data-wwai-product-variant-label");e&&o&&(i[e]=o)})),{productLabel:e,variantOptions:i,purchaseType:o}}setSelectedCombo({productLabel:t,variantOptions:e,purchaseType:o}){const n=this.getProductRadiosForPurchaseType(o),i=this.getVariantRadiosForPurchaseType(o);if(!n.length)return console.warn(`‚ö†Ô∏è No product radio inputs found in <product-variant-purchase-type-combo-selector> [${this.sectionId}].`),!1;if(!gt(n,t,this.sectionId))return console.warn(`‚ö†Ô∏è Required product not found in <product-variant-purchase-type-combo-selector> [${this.sectionId}].`),!1;const r=ht(t,ft(i,t),e);if(!r)return console.warn(`‚ö†Ô∏è Required variant levels not present in <product-variant-purchase-type-combo-selector> [${this.sectionId}].`),!1;const s=bt(i,t,e),a=o==ue.SUBSCRIPTION?ue.ONE_TIME:ue.SUBSCRIPTION,l=this.getProductRadiosForPurchaseType(a),c=this.getVariantRadiosForPurchaseType(a);return l.forEach((t=>{t.checked=!1})),c.forEach((t=>{t.checked=!1})),r&&s}}customElements.define(o.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO,me);const we="data-wwai-variant-set-tab",_e="data-wwai-product-label",ye="data-wwai-product-variant-option-type",ve="product",Ce="product_variant",Oe="variant_change";class Ae extends e{constructor(){super(),this.allInputs=[],this.setTabs=[],this.activeSet=null,this.handlers={},this.debounceTimer=null}connectedCallback(){this.init()}init(){this.allInputs=[...this.querySelectorAll(`input[type="radio"]:not([${we}])`)],this.setTabs=[...this.querySelectorAll(`[${we}]`)],this.bindSetTabs(),this.activateSet(this.setTabs[1]?.getAttribute(we))}bindSetTabs(){this.setTabs.forEach((t=>{const e=t.getAttribute(we);t.addEventListener("click",(()=>{this.activateSet(e)}))}))}activateSet(t){this.activeSet=t,this.setTabs.forEach((e=>{e.checked=e.getAttribute(we)===t})),console.log("üîç Activating Set:",t),console.log("üîç Active Set:",this.activeSet),console.log("üîç Set Tabs:",this.setTabs),console.log("üîç Set Tabs Checked:",this.setTabs.map((t=>t.checked))),this.bindInputEvents()}bindInputEvents(){console.log("üîç Binding Input Events"),console.log("üîç All Inputs:",this.allInputs),this.allInputs.forEach((t=>{t.removeEventListener("change",this.handleVariantChangeBound),t.removeEventListener("click",this.handleVariantChangeBound)})),this.handleVariantChangeBound=this.handleVariantChange.bind(this);this.getActiveInputs().forEach((t=>{t.addEventListener("change",this.handleVariantChangeBound),t.addEventListener("click",this.handleVariantChangeBound)}))}getActiveInputs(){return this.allInputs.filter((t=>t.getAttribute("data-wwai-variant-set")===this.activeSet))}handleVariantChange(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout((()=>{const t=[...this.getActiveInputs()].find((t=>t.checked&&t.getAttribute(ye)===ve));if(console.log("üîç Product Input:",t),!t)return null;const e=t.getAttribute(_e),o=[...this.getActiveInputs()].find((t=>t.getAttribute(ye)===Ce&&t.getAttribute(_e)===e&&t.checked)),n=o?.getAttribute("data-wwai-product-variant-label")||null,i=o?.getAttribute("data-wwai-product-variant-label-level")||null,r={productLabel:e,variantLabel:n,variantLabelLevel:i,setName:this.activeSet};console.group("[WWAI] üß† Variant Change Triggered"),console.log("üîç Product Label:",r.productLabel),console.log("üè∑Ô∏è Variant Label:",r.variantLabel),console.log("üî¢ Variant Level:",r.variantLabelLevel),console.log("üî¢ Set Name:",r.setName),console.groupEnd(),this.triggerHandler(Oe,r)}),10)}registerHandler(t,e){t&&"function"==typeof e&&(this.handlers[t]=this.handlers[t]||[],this.handlers[t].push(e))}triggerHandler(t,e){(this.handlers?.[t]||[]).forEach((o=>{try{o(e)}catch(e){console.error(`WWAI ‚ùå Handler error for type "${t}"`,e)}}))}}customElements.define(o.PRODUCT_GROUP.VARIANT_SELECTOR_WITH_SETS,Ae);class Ie extends rt{constructor(){super(),this.productLabel=null,this.variantOptions=null}getElementName(){return"static subscription frequency selector"}connectedCallback(){super.connectedCallback(),this.init()}init(){this.productLabel=this.getAttribute(`${ee}`),this.variantOptions=this.getDefinedVariantOptions(),this.productLabel&&this.variantOptions&&0!==Object.keys(this.variantOptions).length?console.log("üîç Static Subscription Frequency Selector Initialized:",{productLabel:this.productLabel,variantOptions:this.variantOptions}):console.warn("WWAI ‚ö†Ô∏è Missing productLabel or variantOptions on <product-static-subscription-frequency-selector>.")}getDefinedVariantOptions(){const t=this.getAttribute(oe),e=this.getAttribute(ne),o=this.getAttribute(ie),n={};return t&&(n.option1=t),e&&(n.option2=e),o&&(n.option3=o),console.log("üîç Defined Variant Options:",{option1:t||"undefined",option2:e||"undefined",option3:o||"undefined",result:n}),n}handleSubscriptionPlanChange(t){console.log("üîç To be Implemented: Static Subscription Frequency Selector Plan Changed:",t)}updateSubscriptionOptionsForStaticUse(t){t&&Array.isArray(t)?this.updateSubscriptionOptions(t):console.warn(`WWAI ‚ö†Ô∏è No valid subscription options provided for ${this.productLabel} / ${this.variantOptions}`)}}customElements.define(o.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY_STATIC,Ie);class Ee extends h{constructor(){super(),this.priceLabel=null,this.productLabel=null,this.variantOptions=null}connectedCallback(){super.connectedCallback(),this.init()}init(){this.productLabel=this.getAttribute(`${ee}`),this.priceLabel=this.getAttribute("data-wwai-product-price-label"),this.productLabel&&this.priceLabel?(this.variantOptions=this.getDefinedVariantOptions(),0!==Object.keys(this.variantOptions).length?console.log("üîç Static Price Selector Initialized:",{productLabel:this.productLabel,priceLabel:this.priceLabel,variantOptions:this.variantOptions}):console.warn("WWAI ‚ö†Ô∏è Missing variantOptions on <product-static-price-selector>.")):console.warn("WWAI ‚ö†Ô∏è Missing productLabel or variantLabel or priceLabel on <product-static-price-selector>.")}getDefinedVariantOptions(){const t=this.getAttribute(oe),e=this.getAttribute(ne),o=this.getAttribute(ie),n={};return t&&(n.option1=t),e&&(n.option2=e),o&&(n.option3=o),console.log("üîç Defined Variant Options:",{option1:t||"undefined",option2:e||"undefined",option3:o||"undefined",result:n}),n}updatePrice(t){t?this.updatePrices(t,this.priceLabel):console.warn(`WWAI ‚ö†Ô∏è No pricing data provided for ${this.productLabel}`)}}function Re(t){const e=document.getElementById(t);if(!e)return console.warn(`‚ö†Ô∏è Script with ID "${t}" not found`),null;try{return JSON.parse(e.textContent)}catch(e){return console.error(`‚ùå Failed to parse JSON from script#${t}:`,e),null}}customElements.define(o.PRODUCT_GROUP.PRICE_STATIC,Ee);const Te={[o.PRODUCT_GROUP.VARIANT]:qt,[o.PRODUCT_GROUP.PRICE]:h,[o.PRODUCT_GROUP.PURCHASE_TYPE]:F,[o.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY]:rt,[o.PRODUCT_GROUP.VARIANT_CUSTOM_LABEL]:ct,[o.PRODUCT_GROUP.CAROUSEL]:l,[o.PRODUCT_GROUP.ADD_TO_CART]:r,[o.PRODUCT_GROUP.SUBMIT_INTERCEPTOR]:T,[o.PRODUCT_GROUP.PRODUCT_MEDIA_GALLERY_FOR_GRIDS]:jt,[o.PRODUCT_GROUP.GRID_SMART_INTERACTION]:Qt,[o.PRODUCT_GROUP.COLLECTION_OPTIONS_OVERLAY]:Zt,[o.PRODUCT_GROUP.TITLE]:te,[o.PRODUCT_GROUP.VARIANT_TRIGGER]:re,[o.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO]:me,[o.PRODUCT_GROUP.VARIANT_SELECTOR_WITH_SETS]:Ae,[o.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY_STATIC]:Ie,[o.PRODUCT_GROUP.PRICE_STATIC]:Ee,[o.OTHER.PRODUCT_GRID_HEIGHT_EQUALIZER]:Kt};"prod"!==R().MODE&&function(){const t=[];for(const e in o)if(Object.prototype.hasOwnProperty.call(o,e)){const n=o[e];t.push(...Object.values(n))}let e=!0;const n=[];for(const o of t)o in Te||(n.push(o),e=!1);e?console.log("ELEMENT_CLASS_REGISTRY Validation Passed: All defined selectors are registered."):console.error("WWAI-ERROR ELEMENT_CLASS_REGISTRY Validation Failed: The following selectors from `constants/selector-constants.js` are NOT registered:",n)}();const Se={"product-purchase-type-selector":40,"product-subscription-frequency-selector":30,"product-variant-custom-labeled-text":20,"product-custom-price-selector":10,"product-custom-submit-interceptor":10};function Pe(t){const e=t.dataset.debugId;if(!e)return;const o=document.querySelector(`[data-debug-for="${e}"]`);o&&o.remove()}function xe(t,e="green"){const o=t.tagName.toLowerCase(),n=Se[o]||0;if(document.querySelector(`[data-debug-for="${t.dataset.debugId}"]`))return;const i=function(t,e=32){const o=t.tagName.toLowerCase(),n=Se[o]||e,i=Array.from(t.querySelectorAll("*")).filter((t=>null!==t.offsetParent));if(0===i.length)return null;let r=1/0,s=1/0,a=-1/0,l=-1/0;if(i.forEach((t=>{const e=t.getBoundingClientRect();0!==e.width&&0!==e.height&&(r=Math.min(r,e.top),s=Math.min(s,e.left),a=Math.max(a,e.bottom),l=Math.max(l,e.right))})),r===1/0)return null;const c=window.scrollY,d=window.scrollX,u=document.documentElement.clientWidth,p=Math.max(0,s+d-n);return{top:Math.max(0,r+c-n),left:p,width:Math.min(u,l+d+n)-p,height:a-r+2*n}}(t);if(!i)return;const r=t.dataset.debugId||`${o}-debug-${Date.now()}`;t.dataset.debugId=r;const s=document.createElement("div");s.setAttribute("data-debug-for",r),s.style.position="absolute",s.style.left=`${i.left}px`,s.style.top=`${i.top+n}px`,s.style.width=`${i.width}px`,s.style.height=`${i.height}px`,s.style.border="2px dashed "+e,s.style.zIndex=9998,s.style.pointerEvents="none";const a=document.createElement("div");a.style.position="absolute",a.style.top="4px",a.style.right="4px",a.style.width="12px",a.style.height="12px",a.style.borderRadius="50%",a.style.zIndex="10001",a.style.cursor="pointer",a.style.pointerEvents="auto";const l=t.getAttribute("debug_status")||"none";a.style.background={valid:"limegreen",warning:"orange",error:"red"}[l]||"gray";const c=document.createElement("div");c.style.position="absolute",c.style.padding="10px 14px",c.style.background="#2c2c2c",c.style.color="#fff",c.style.fontSize="13px",c.style.borderRadius="6px",c.style.zIndex="10002",c.style.display="none",c.style.width="360px",c.style.boxShadow="0 4px 12px rgba(0,0,0,0.25)",c.style.lineHeight="1.5",c.style.whiteSpace="normal",c.style.wordBreak="break-word",c.style.overflowWrap="break-word",c.style.border="1px solid #444";const d=document.createElement("div");d.textContent=`<${o}>`,d.style.fontWeight="bold",d.style.fontSize="14px",d.style.marginBottom="8px",c.appendChild(d);const u=document.createElement("ul");u.style.margin=0,u.style.paddingLeft="18px",u.style.listStyle="disc",c.appendChild(u),a.addEventListener("mouseenter",(()=>{const e=t.getAttribute("debug_message")||"[]";let o=[];try{o=JSON.parse(e)}catch(t){o=[e]}Array.isArray(o)&&0!==o.length||(o=["valid"]),u.innerHTML="",o.forEach((t=>{const e=document.createElement("li");e.textContent=t,e.style.marginBottom="8px",e.style.paddingLeft="2px",u.appendChild(e)}));const{right:n}=a.getBoundingClientRect(),i=n+320>window.innerWidth;c.style.left=i?"-320px":"20px",c.style.top="0px",c.style.display="block"})),a.addEventListener("mouseleave",(()=>{c.style.display="none"})),a.appendChild(c),s.appendChild(a),document.body.appendChild(s)}const $e="[data-wwai-media-container]",De="[data-wwai-media-slide]",Ue="data-wwai-carousel-media-id";function Ne(){}function We(){}function Le(){}function Ge(t){return 1===t.length&&1===t[0].length&&"Default Title"===t[0][0]}function ke(t,e){return Array.isArray(t)&&1===t.length&&e&&1===Object.keys(e).length&&Array.isArray(e.option1)&&1===e.option1.length&&"__wwai_first__"===e.option1[0]}function Me(t){const e=t.querySelectorAll('input[type="radio"]'),o=[];if(0===e.length)return{isValid:!1,messages:["‚ùå No variant input elements (radio buttons) found in selector."]};e.forEach((t=>{const e=function(t){const e=[],o=t.getAttribute(J),n=t.getAttribute(X),i=t.getAttribute(Q);return"product"!==o&&"product_variant"!==o&&e.push(`Invalid type: "${o}". Expected "product" or "product_variant".`),n||e.push(`Missing required attribute: ${X}.`),"product_variant"!==o||i||e.push(`Missing ${Q} for product_variant input.`),{valid:0===e.length,issues:e}}(t);e.valid||o.push({input:t,debug:qe(t),issues:e.issues})}));const n=o.flatMap((({debug:t,issues:e})=>e.map((e=>`${t} : ${e}`))));return{isValid:0===o.length,messages:n}}function qe(t){return`type="${t.getAttribute(J)||"(no type)"}", product="${t.getAttribute(X)||"(no product)"}", variant="${t.getAttribute(Q)||"(no variant)"}"`}function je(t,e=!1){const o=Me(t),{inconsistencies:n,messages:i}=function(t){t.getAttribute("section_id");const e=t.querySelectorAll('input[type="radio"]'),o={};e.forEach((t=>{const e=t.getAttribute("name"),n=t.getAttribute(J);e&&n&&(o[e]=o[e]||new Set,o[e].add(n))}));const n=[],i=[];return Object.entries(o).forEach((([t,o])=>{if(o.size>1){const r=`Inconsistent option types in radio group: "${t}" (found types: ${Array.from(o).join(", ")}).`;i.push(r);const s=Array.from(e).filter((e=>e.getAttribute("name")===t));n.push({groupName:t,types:Array.from(o),inputs:s,message:r})}})),{inconsistencies:n,messages:i}}(t),{conflicts:r,messages:s}=function(t){const e=t.getAttribute("section_id")||"(unknown)",o=t.querySelectorAll('input[type="radio"]'),n=[],i=[];return o.forEach((o=>{const r=o.getAttribute("name");r&&document.querySelectorAll(`input[type="radio"][name="${r}"]`).forEach((s=>{if(!t.contains(s)){const t=`Conflict: radio group name "${r}" is used both inside (seciton id="${e}") and outside of this selector too.`;n.push({name:r,input:o,conflictingElement:s,message:t}),i.push(t)}}))})),{conflicts:n,messages:i}}(t),a=[...o.messages,...i];let l=!o.isValid,c=i.length>0;a.push(...s),r.length>0&&(l=!0);const d=l?"error":c?"warning":"valid";return e&&console.log("messages:",a),{status:d,messages:a}}function Be(t){const e=mt(t);if(!t?.productGroup)return void console.warn("[WWAI] ‚ö†Ô∏è Product group not found for selector element.");const o=function(t,e){const o=[];for(const n of e.productLabels){const i=vt(t,n);if(!i||!i.variants||0===i.variants.length){o.push(`Product "${n}" has no variants in product data.`);continue}const r=i.variants.map((t=>[t.option1,t.option2,t.option3].filter(Boolean).map((t=>t.trim()))));if(Ge(r)){console.warn(`Skipping exhaustive check for product "${n}" ‚Äî single default variant.`);continue}const s=e.variants[n];if(!s||0===Object.keys(s).length){o.push(`Product "${n}" has no variant options defined in html hierarchy.`);continue}const a=s.option1||[],l=s.option2||[null],c=s.option3||[null];for(const t of a)for(const e of l)for(const i of c){const a=[t,e,i].filter(Boolean).map((t=>t.trim()));r.some((t=>a.length===t.length&&a.every(((e,o)=>e===t[o]))))||(ke(r,s)?console.warn("WWAI-WARN: Single variant option with special label __wwai_first__ detected. Skipping mismatch push."):o.push(`Variant [${a.join(", ")}] missing for product "${n}" in product data.`))}}return o}(t.productGroup,e);console.log("mismatches:",o);let n=[];try{const e=t.getAttribute("debug_message");n=e?JSON.parse(e):[]}catch(t){n=[]}const i=(o||[]).map((t=>`Product Connect Error: ${t}`)),r=[...n,...i];t.setAttribute("debug_message",JSON.stringify(r))}function Ve(t,{beforeCount:e,afterCount:o,discountCount:n},i){const r=[];let s=!1,a=!1;(e>1||o>1)&&(s=!0,r.push(`Label "${t}" has multiple elements: ${[e>1?`beforePrice (${e})`:null,o>1?`afterPrice (${o})`:null].filter(Boolean).join(", ")}`)),0===e&&0===o?(s=!0,r.push(`Label "${t}" is missing both beforePrice and afterPrice`)):0!==e&&0!==o||(a=!0,r.push(`Label "${t}" is missing: ${[0===e?"beforePrice":null,0===o?"afterPrice":null].filter(Boolean).join(", ")}`)),n>1&&(s=!0,r.push(`Label "${t}" has multiple discountPercentage elements (${n})`));const l=function(t,e){const o=[];let n=!1;const i=[{type:"before",el:d.BEFORE,wrapper:u},{type:"after",el:d.AFTER,wrapper:p},{type:"discount",el:d.DISCOUNT,wrapper:g}];for(const{type:r,el:s,wrapper:a}of i){const i=e.querySelector(`[${s}][${c}="${t}"]`);i&&!i.closest(`[${a}]`)&&(n=!0,o.push(`Label "${t}" has ${r} element not inside [${a}]`))}return{hasWarning:n,messages:o}}(t,i);return r.push(...l.messages),l.hasWarning&&(a=!0),{hasError:s,hasWarning:a,messages:r}}function He(t,e="<product-custom-price-selector>"){const o=t.querySelectorAll(`[${c}], [${d.BEFORE}], [${d.AFTER}], [${d.DISCOUNT}]`),n=t.querySelectorAll(`[${c}]`),i=[],r=function(t,e="<product-custom-price-selector>"){const o=[];return t.forEach(((t,n)=>{const i=t.getAttribute(c)?.trim();if(!i){const i=t.outerHTML.split("\n")[0].trim().slice(0,100);o.push(`Element ${n} inside ${e} is missing required ${c}: ${i}...`)}})),o}(o,e),s=r.length>0;if(i.push(...r),!n.length)return i.push(`No price-labeled elements found inside ${e}`),{status:"none",messages:i};const a=function(t){const e={};return t.forEach((t=>{const o=t.getAttribute(c)?.trim();o&&(e[o]||(e[o]={beforeCount:0,afterCount:0,discountCount:0}),t.hasAttribute(d.BEFORE)&&(e[o].beforeCount+=1),t.hasAttribute(d.AFTER)&&(e[o].afterCount+=1),t.hasAttribute(d.DISCOUNT)&&(e[o].discountCount+=1))})),e}(n),{messages:l,status:u}=function(t,e){const o=[];let n=!1,i=!1;for(const[r,s]of Object.entries(t)){const t=Ve(r,s,e);o.push(...t.messages),t.hasError&&(n=!0),t.hasWarning&&(i=!0)}return{status:n?"error":i?"warning":"valid",messages:o}}(a,t);i.push(...l);return{status:s?"error":u,messages:i}}function Fe(t,e,o){const{beforeCount:n,afterCount:i,discountCount:r}=e,s=[];let a=!1,l=!1;(n>1||i>1)&&(a=!0,s.push(`Label "${t}" has multiple elements: ${[n>1?`beforePrice (${n})`:null,i>1?`afterPrice (${i})`:null].filter(Boolean).join(", ")}`)),0===n&&0===i?(a=!0,s.push(`Label "${t}" is missing both beforePrice and afterPrice`)):0!==n&&0!==i||(l=!0,s.push(`Label "${t}" is missing: ${[0===n?"beforePrice":null,0===i?"afterPrice":null].filter(Boolean).join(", ")}`)),r>1&&(a=!0,s.push(`Label "${t}" has multiple discountPercentage elements (${r})`));const f=function(t,e){const o=[];let n=!1;const i=[{type:"before",el:d.BEFORE,wrapper:u},{type:"after",el:d.AFTER,wrapper:p},{type:"discount",el:d.DISCOUNT,wrapper:g}];for(const{type:r,el:s,wrapper:a}of i){const i=e.querySelector(`[${s}][${c}="${t}"]`);i&&!i.closest(`[${a}]`)&&(n=!0,o.push(`Label "${t}" has ${r} element not inside [${a}]`))}return{hasWarning:n,messages:o}}(t,o);return s.push(...f.messages),f.hasWarning&&(l=!0),{hasError:a,hasWarning:l,messages:s}}function ze(t,e="<product-static-price-selector>"){const o=t.querySelectorAll(`[${c}], [${d.BEFORE}], [${d.AFTER}], [${d.DISCOUNT}]`),n=t.querySelectorAll(`[${c}]`),i=[],r=function(t,e){const o=[];return t.forEach(((t,n)=>{const i=t.getAttribute(c)?.trim();if(!i){const i=t.outerHTML.split("\n")[0].trim().slice(0,100);o.push(`Element ${n} inside ${e} is missing required ${c}: ${i}...`)}})),o}(o,e),s=r.length>0;if(i.push(...r),!n.length)return i.push(`No price-labeled elements found inside ${e}`),{status:"none",messages:i};const a=function(t){const e={};return t.forEach((t=>{const o=t.getAttribute(c)?.trim();o&&(e[o]||(e[o]={beforeCount:0,afterCount:0,discountCount:0}),t.hasAttribute(d.BEFORE)&&(e[o].beforeCount+=1),t.hasAttribute(d.AFTER)&&(e[o].afterCount+=1),t.hasAttribute(d.DISCOUNT)&&(e[o].discountCount+=1))})),e}(n),{messages:l,status:u}=function(t,e){const o=[];let n=!1,i=!1;for(const[r,s]of Object.entries(t)){const t=Fe(r,s,e);o.push(...t.messages),t.hasError&&(n=!0),t.hasWarning&&(i=!0)}return{status:n?"error":i?"warning":"valid",messages:o}}(a,t);i.push(...l);return{status:s?"error":u,messages:i}}function Ye(){const t=[o.PRODUCT_GROUP.VARIANT,o.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO].filter(Boolean).join(", "),e=document.querySelectorAll(t),n={},i=[];return e.forEach((t=>{const e=t.sectionId,o=function(t){const e=t.getAttribute("product_group"),o=t.getAttribute("product-helper-handle");if(!e||!o)return console.warn("[getProductMappingJSON] Missing product_group or product-helper-handle."),null;const n=t.querySelectorAll(`input[type="radio"][${J}="${tt}"]`),i={};return n.forEach((t=>{const e=t.getAttribute(X);e&&(i[e]=`${o}`)})),{product_group:e,products:i}}(t);if(!e||!o)return;n[e]||(n[e]={},i.includes(e)||i.push(e));const r=o.product_group;n[e][r]=o.products})),{mapping:n,sectionOrder:i}}function Je(t=!1){const{mapping:e,sectionOrder:o}=Ye(),n={},i=new Map,r={},s={};let a=0;return o.forEach((o=>{const l=e[o];Object.entries(l).forEach((([e,l])=>{const c=function(t){return JSON.stringify(t,Object.keys(t).sort())}(l);if(function(t,e,o,n){if(t.has(e))return t.get(e)!==o&&console.warn(`‚ö†Ô∏è Conflict: Product group "${e}" has different mappings in section "${n}".`),!0;return!1}(i,e,c,o))return;i.set(e,c),n[e]=l;const{wasAddedToLiquid:d,newTotal:u}=function({productGroup:t,mapping:e,renderWithLiquid:o,totalHandles:n,liquid_loaded:i}){const r=Object.keys(e).length;return o&&n<20&&n+r<=20?(i[t]=e,{wasAddedToLiquid:!0,newTotal:n+r}):{wasAddedToLiquid:!1,newTotal:n}}({productGroup:e,mapping:l,renderWithLiquid:t,totalHandles:a,liquid_loaded:r});a=u,d||(s[e]=l)}))})),{merged:n,liquid_loaded:r,js_loaded:s}}function Xe(t){return t&&"object"==typeof t&&!Array.isArray(t)&&0===Object.keys(t).length}function Qe(t,e,o,n,i,r=!1){const s=function(t){const e=(o=t,`{%- assign product_mapping_str = "\n${Object.entries(o).flatMap((([t,e])=>Object.entries(e).map((([e,o])=>`  ${t}:${e}:${o}`)))).join(",\n")}\n" -%}`);var o;return`\n    ${e}\n  `}(t),a=function(t,e,o,n,i=!0){return`window.__WWAI__ = window.__WWAI__ || {};\n  \n// Environment + Mode Config\n// Use metafield-based subscription in sandbox/local\nwindow.__WWAI__.useMockSubscription = true;\n\n// Options: "local" | "sandbox" | "prod"\nwindow.__WWAI__.deployMode = "local";\n\n// Enables dev/debugger mode, values are dev, prod\nwindow.__WWAI__.MODE = "dev";\n\n// Controls Liquid-product rendering\nwindow.__WWAI__.RENDER_WITH_LIQUID = true;\n\n// Which connector to use for hydration\nwindow.__WWAI__.CONNECTOR_TYPE = "shopify";\n\n// Enable logging for grid height debugging\nwindow.__WWAI__.heightEqualizeLogging = true;\n\n// Currency Config\n// Active currency from Shopify\nwindow.__WWAI__.CURRENCY = Shopify.currency.active;\n\n// Currency conversion factor\nwindow.__WWAI__.CURRENCY_FACTOR = 0.01;\n\n// Product mapping object\nwindow.__WWAI__.JS_PRODUCT_MAPPING_OBJECT = ${JSON.stringify(t,null,2)};\n\n// Product group config\nwindow.__WWAI__.WWAI_PRODUCT_GROUP_CONFIG = ${JSON.stringify(e,null,2)};\n\n// Variant overrides\nwindow.__WWAI__.WWAI_PRODUCT_VARIANT_OVERRIDES = ${JSON.stringify(o,null,2)};\n\n// Labeled images\nwindow.__WWAI__.WWAI_LABELED_IMAGES = ${i?"{}":JSON.stringify(n,null,2)};\n\n// Action buttons\nwindow.__WWAI__.ACTION_BUTTONS = {};\n`}(e,o,n,i);!function(t,e){if(!document.getElementById("variantDevPopup")){const e=document.createElement("style");e.textContent="\n      #variantDevButton {\n        position: fixed;\n        top: 12px;\n        right: 12px;\n        z-index: 10000;\n        background: #111;\n        color: white;\n        padding: 8px 12px;\n        font-size: 13px;\n        border: 1px solid #666;\n        cursor: pointer;\n        border-radius: 4px;\n      }\n      #variantDevPopup {\n        position: fixed;\n        top: 60px;\n        right: 12px;\n        width: 600px;\n        max-height: 80vh;\n        overflow: auto;\n        background: #1e1e1e;\n        color: #eee;\n        padding: 16px;\n        z-index: 9999;\n        border: 1px solid #555;\n        font-family: monospace;\n        display: none;\n      }\n      #variantDevPopup pre {\n        white-space: pre-wrap;\n        background: #222;\n        padding: 12px;\n        overflow-x: auto;\n        margin: 12px 0 0;\n      }\n      #variantDevPopup .control-buttons {\n        display: flex;\n        gap: 8px;\n        margin-bottom: 12px;\n      }\n      #variantDevPopup button {\n        padding: 6px 12px;\n        background: #444;\n        color: white;\n        border: none;\n        cursor: pointer;\n      }\n      #variantDevPopup button.active {\n        background: #666;\n      }\n    ",document.head.appendChild(e);const o=document.createElement("button");o.id="variantDevButton",o.textContent="PDP Config",o.onclick=()=>{document.getElementById("variantDevPopup").style.display="block"},document.body.appendChild(o);const n=document.createElement("div");n.id="variantDevPopup";const i=document.createElement("div");i.className="control-buttons";const r=document.createElement("pre");r.id="variantDevOutputBlock";const s=document.createElement("button");s.textContent="Copy",s.onclick=()=>{navigator.clipboard.writeText(r.textContent),s.textContent="Copied!",setTimeout((()=>s.textContent="Copy"),1500)};const a=document.createElement("button");a.textContent="Close",a.onclick=()=>n.style.display="none";const l={};["Liquid Integration","JS Config"].forEach((e=>{const o=document.createElement("button");o.textContent=e,o.onclick=()=>{Object.values(l).forEach((t=>t.classList.remove("active"))),o.classList.add("active"),r.textContent=t[e]},i.appendChild(o),l[e]=o})),n.appendChild(i),n.appendChild(s),n.appendChild(a),n.appendChild(r),document.body.appendChild(n)}setTimeout((()=>{document.getElementById("variantDevOutputBlock");const t=document.querySelector("#variantDevPopup .control-buttons button");t&&t.click(),e&&(document.getElementById("variantDevPopup").style.display="block")}),0)}({"Liquid Integration":s,"JS Config":a},r)}function Ze(t){const{merged:e,liquid_loaded:n,js_loaded:i}=Je(t);Qe(n,i,function(){const t=[o.PRODUCT_GROUP.VARIANT,o.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO].filter(Boolean).join(", "),e=document.querySelectorAll(t),n={},i={pricingConfig:{discountPercent:0,subscriptionDiscountPercent:0,defaultSubscriptionOption:null,useVariantCompareAtPriceForSubscription:!0,discountCodeToApply:[],roundDiscount:!0,addOffSuffixToDiscount:!1},uxConfig:{variantOptionRemovePrefix:"Every",defaultPurchaseType:"onetime",imageCarouselConfig:{useCustomImages:!1},variantUXConfig:{hideSingleLengthVariants:!1,onlyShowVariantsWithLabelContains:null,refreshUxOnVariantChange:!0},preAddToCartFlowConfig:{journeyType:"overlay",overlayContents:[],postSelectionAction:"na",postSelectionActionParams:{custom_url:null,redirect_variant_options:null}}},flowConfig:{destination:"side-cart",loader:"add-to-cart-submit-button",showSuccessNotification:!1,showErrorNotification:!1,sideCartLabel:"",successNotificationMessage:"‚úÖ Added to cart!",errorNotificationMessage:"Oops, couldn't add item.",notificationOptions:{backgroundColor:"#E8DDFA",textColor:"#000000",borderColor:"transparent",fontFamily:"sans-serif"}}};return e.forEach((t=>{const e=t.productGroup,o=t.sectionId;let r=o;o.includes("__")?r=o.split("__")[1]:o.includes("--")&&(r=o.split("--")[1]);const s=mt(t),a=s.productLabels?.[0]?.trim()||null,l=s.variants?.[a]||{},c={option1:new Set,option2:new Set,option3:new Set};for(const t of s.productLabels||[]){const e=s.variants?.[t]||{};["option1","option2","option3"].forEach((t=>{(e[t]||[]).forEach((e=>c[t].add(e.trim())))}))}const d=t=>[...t].join(" | ")||"",u={defaultProduct:a,defaultVariantOption1:l.option1?.[0]?.trim()||null,defaultVariantOption2:l.option2?.[0]?.trim()||null,defaultVariantOption3:l.option3?.[0]?.trim()||null,allProducts:(s.productLabels||[]).map((t=>t.trim())).join(" | "),allOptions:{option1:d(c.option1),option2:d(c.option2),option3:d(c.option3)}};n[r]=n[r]||{defaults:JSON.parse(JSON.stringify(i))},n[r][e]={pricingConfig:null,uxConfig:null,flowConfig:null,variantDispatchConfig:u}})),n}(),function(){const t=[o.PRODUCT_GROUP.VARIANT,o.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO].filter(Boolean).join(", "),e=document.querySelectorAll(t),n=document.querySelectorAll("product-variant-custom-labeled-text-selector"),i={};return e.forEach((t=>{const e=t.getAttribute("product_group"),o=t.sectionId;let r=o;o.includes("__")?r=o.split("__")[1]:o.includes("--")&&(r=o.split("--")[1]);const s=mt(t);i[r]||(i[r]={}),i[r][e]||(i[r][e]={}),s.productLabels.forEach((t=>{const o=s.variants[t]||{};i[r][e][t]||(i[r][e][t]={});const a=[];(o.option1||[]).forEach((t=>{const e=o.option2?.length?o.option2:[""],n=o.option3?.length?o.option3:[""];e.forEach((e=>{n.forEach((o=>{const n=[t,e,o].filter(Boolean).map((t=>t.trim())).join(" | ");a.push(n)}))}))}));const l={},c=Array.from(n).find((t=>{let o=t.getAttribute("section_id")||"";return o.includes("__")?o=o.split("__")[1]:o.includes("--")&&(o=o.split("--")[1]),o===r&&t.getAttribute("product_group")===e}));c&&c.querySelectorAll(lt).forEach((t=>{const e=t.getAttribute(at),o=t.textContent.trim();e&&(l[e]=o)})),a.forEach((o=>{i[r][e][t][o]={customMediaLabel:null,redirectToMediaIndex:null,customLabelText:{...l}}}))}))})),i}(),function(){const t=document.querySelectorAll("product-custom-carousel-media-selector"),e={};return t.forEach((t=>{const o=t.getAttribute("section_id")||"",n=t.getAttribute("product_group")||"",i=`${o}__${n}`,r=t.querySelectorAll("main-slider-slide"),s=[];r.forEach(((t,e)=>{const i=t.querySelector("img"),r=t.id||t.getAttribute("id");if(i&&i.src){let t;try{const e=new URL(i.src,window.location.origin);e.searchParams.delete("v"),t=e.toString()}catch{t=i.src}const a=i.src.match(/[?&]width=(\d+)/),l=a?parseInt(a[1],10):i.width||0,c=i.width,d=i.height,u=c&&d?+(c/d).toFixed(3):1,p=l&&u?Math.round(l/u):0,g=`${o}__${n}__${e+1}`,f=parseInt(r?.split("_").pop(),10),h=isNaN(f)?g:f;s.push({alt:i.getAttribute("alt")||null,id:h,position:e+1,preview_image:{aspect_ratio:u,height:p,width:l,src:t},aspect_ratio:u,height:p,media_type:"image",src:t,width:l})}})),e[i]=s})),e}())}const Ke=[];function to(t){if(Ke.push(t),!window._hasFunctionalityDebugToggleSetup){let t=!0;Object.defineProperty(window,"FUNCTIONALITY_DEBUG_MODE",{set(e){this._FUNCTIONALITY_DEBUG_MODE=e,console.log(`FUNCTIONALITY_DEBUG_MODE set to: ${e}`),Ke.forEach((o=>o(e,{isFirstSet:t}))),t=!1},get(){return this._FUNCTIONALITY_DEBUG_MODE},configurable:!0}),window._hasFunctionalityDebugToggleSetup=!0}}function eo(t=!1){to(((e,{isFirstSet:o})=>{!0===e?Ze(t):!1!==e||o||function(){const t=document.getElementById("variantDevPopup"),e=document.getElementById("variantDevButton");t&&(t.remove(),console.log("üßπ Removed #variantDevPopup")),e&&(e.remove(),console.log("üßπ Removed #variantDevButton"))}()}))}function oo({HighlighterClass:t,validateFn:e,extraOnEnable:o=null,extraOnDisable:n=null}){return function(i){if(!i)return void console.warn("‚ö†Ô∏è makeDebugHandler was called with an empty or invalid selector.",i);const r=new t(i);e(i),to(((t,{isFirstSet:e})=>{!0===t?(r.enableDebugging(),o&&o()):!1!==t||e?console.log("FUNCTIONALITY_DEBUG_MODE is null. Skipping debug action."):(r.disableDebugging(),n&&n())}))}}const no=oo({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(!function(t){const e=t.querySelectorAll('input[type="radio"]');let o=document.querySelector("#wwai-debug-tooltip");o||(o=document.createElement("div"),o.id="wwai-debug-tooltip",Object.assign(o.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none"}),document.body.appendChild(o)),e.forEach((e=>{const n=e.getAttribute(J),i=e.getAttribute(X)||"",r=e.getAttribute(Q)||"",s=e.getAttribute(Z)||"",a="product"===n,l="product_variant"===n,c=Boolean(i);let d="";a?d=`Product Selector for "${i}"`:l&&(d=`Variant Selector for "${i}"\n${s}: ${r}`);const u=c&&(a||l&&r)?"2px solid limegreen":"2px solid red";e.style.outline=u;const p=t.querySelector(`label[for="${e.id}"]`);p&&(p.style.outline=u,p.addEventListener("mouseover",(t=>{o.textContent=d,o.style.display="block",o.style.left=`${t.pageX+10}px`,o.style.top=`${t.pageY+10}px`})),p.addEventListener("mousemove",(t=>{o.style.left=`${t.pageX+10}px`,o.style.top=`${t.pageY+10}px`})),p.addEventListener("mouseout",(()=>{o.style.display="none"}))),e.addEventListener("mouseover",(t=>{o.textContent=d,o.style.display="block",o.style.left=`${t.pageX+10}px`,o.style.top=`${t.pageY+10}px`})),e.addEventListener("mousemove",(t=>{o.style.left=`${t.pageX+10}px`,o.style.top=`${t.pageY+10}px`})),e.addEventListener("mouseout",(()=>{o.style.display="none"}))}))}(this.selector),xe(this.selector))}disableDebugging(){!function(t){console.log("clearHighlighting called"),t.querySelectorAll('input[type="radio"]').forEach((e=>{e.style.outline="";const o=e.cloneNode(!0);e.replaceWith(o);const n=t.querySelector(`label[for="${e.id}"]`);if(n){n.style.outline="";const t=n.cloneNode(!0);n.replaceWith(t)}}));const e=document.getElementById("wwai-debug-tooltip");e&&(e.style.display="none"),t.initInputs(),t.bindEvents()}(this.selector),Pe(this.selector)}},validateFn:function(t){const{status:e,messages:o}=je(t);t.setAttribute("debug_status",e),t.setAttribute("debug_message",JSON.stringify(o))}}),io=oo({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=Object.values(d).map((t=>`[${t}]`)).join(", "),o=t.querySelectorAll(e);let n=document.querySelector("#wwai-debug-tooltip-price");n||(n=document.createElement("div"),n.id="wwai-debug-tooltip-price",Object.assign(n.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none"}),document.body.appendChild(n)),o.forEach((t=>{const e=t.getAttribute(c)||"(missing)";let o="";t.hasAttribute(d.BEFORE)?o="beforePrice":t.hasAttribute(d.AFTER)?o="afterPrice":t.hasAttribute(d.DISCOUNT)?o="discountPercentage":t.hasAttribute(d.SAVINGS)&&(o="savings");const i="(missing)"!==e?"2px solid limegreen":"2px solid red";t.style.outline=i;const r=`Label: ${e}\nType: ${o}`;t.addEventListener("mouseover",(t=>{n.textContent=r,n.style.display="block",n.style.left=`${t.pageX+10}px`,n.style.top=`${t.pageY+10}px`})),t.addEventListener("mousemove",(t=>{n.style.left=`${t.pageX+10}px`,n.style.top=`${t.pageY+10}px`})),t.addEventListener("mouseout",(()=>{n.style.display="none"}))}))}(this.selector))}disableDebugging(){Pe(this.selector),function(t){console.log("clearPriceHighlighting called");const e=Object.values(d).map((t=>`[${t}]`)).join(", ");t.querySelectorAll(e).forEach((t=>{t.style.outline="";const e=t.cloneNode(!0);t.replaceWith(e)}));const o=document.getElementById("wwai-debug-tooltip-price");o&&(o.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const{status:o,messages:n}=He(t,"<product-custom-price-selector>");e&&(console.log("Status:",o),console.log("Messages:",n),console.groupEnd()),t.setAttribute("debug_status",o),t.setAttribute("debug_message",JSON.stringify(n))}}),ro=oo({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=t.querySelectorAll(x);let o=document.querySelector("#wwai-debug-tooltip-purchase-type");o||(o=document.createElement("div"),o.id="wwai-debug-tooltip-purchase-type",Object.assign(o.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none"}),document.body.appendChild(o)),e.forEach((e=>{const n=e.getAttribute(S),i=`Type: ${n}\nName: ${e.getAttribute("name")||"(none)"}`,r=[P.ONETIME,P.SUBSCRIPTION].includes(n)?"2px solid limegreen":"2px solid red";e.style.outline=r,e.addEventListener("mouseover",(t=>{o.textContent=i,o.style.display="block",o.style.left=`${t.pageX+10}px`,o.style.top=`${t.pageY+10}px`})),e.addEventListener("mousemove",(t=>{o.style.left=`${t.pageX+10}px`,o.style.top=`${t.pageY+10}px`})),e.addEventListener("mouseout",(()=>{o.style.display="none"}));const s=e.id;if(s){const e=t.querySelector(`label[for="${s}"]`);e&&(e.style.outline=r,e.addEventListener("mouseover",(t=>{o.textContent=i,o.style.display="block",o.style.left=`${t.pageX+10}px`,o.style.top=`${t.pageY+10}px`})),e.addEventListener("mousemove",(t=>{o.style.left=`${t.pageX+10}px`,o.style.top=`${t.pageY+10}px`})),e.addEventListener("mouseout",(()=>{o.style.display="none"})))}}))}(this.selector))}disableDebugging(){Pe(this.selector),function(t){t.querySelectorAll(x).forEach((e=>{e.style.outline="";const o=e.cloneNode(!0);e.replaceWith(o);const n=e.id;if(n){const e=t.querySelector(`label[for="${n}"]`);if(e){e.style.outline="";const t=e.cloneNode(!0);e.replaceWith(t)}}}));const e=document.querySelector("#wwai-debug-tooltip-purchase-type");e&&(e.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const o=[];let n=!1,i=!1;const r=t.querySelectorAll(x),s=new Set,a={[P.ONETIME]:0,[P.SUBSCRIPTION]:0};r.forEach((t=>{const e=t.getAttribute(S)?.trim(),o=t.getAttribute("name");o&&s.add(o),e===P.ONETIME?a.onetime+=1:e===P.SUBSCRIPTION&&(a.subscription+=1)})),0!==a.onetime&&0!==a.subscription||(n=!0,o.push(`Missing purchase types: ${[0===a.onetime?P.ONETIME:null,0===a.subscription?P.SUBSCRIPTION:null].filter(Boolean).join(", ")}`)),(a.onetime>1||a.subscription>1)&&(n=!0,o.push(`Multiple radios found for: ${[a.onetime>1?`onetime (${a.onetime})`:null,a.subscription>1?`subscription (${a.subscription})`:null].filter(Boolean).join(", ")}`)),s.size>1&&(i=!0,o.push(`Radios inside use multiple "name" attributes: [${[...s].join(", ")}]`));const l=[...s][0];if(l){const e=document.querySelectorAll(`input[type="radio"][name="${l}"]`);Array.from(e).filter((e=>!t.contains(e))).length>0&&(n=!0,o.push(`Radio "name" conflict: "${l}" is reused elsewhere in the document`))}const c=n?"error":i?"warning":"valid";return t.setAttribute("debug_status",c),t.setAttribute("debug_message",JSON.stringify(o)),e&&(console.group("[ProductPurchaseTypeSelector] Validation Output"),console.log("Status:",c),console.log("Messages:",o),console.groupEnd()),{status:c,messages:o}}}),so=oo({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=t.querySelector(Y);if(!e)return;let o=document.getElementById("wwai-subscription-tooltip");o||(o=document.createElement("div"),o.id="wwai-subscription-tooltip",Object.assign(o.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",pointerEvents:"none"}),document.body.appendChild(o));const n=`Subscription Frequency Select\nname: ${e.getAttribute("name")||"[no name]"}\noptions: ${e.querySelectorAll("option").length}`;e.style.outline="2px solid limegreen";const i=()=>{const t=e.getBoundingClientRect();o.textContent=n,o.style.left=`${t.left+window.scrollX}px`,o.style.top=`${t.bottom+window.scrollY+6}px`,o.style.display="block"},r=()=>{o.style.display="none"};e._tooltipHandlers={mouseOverHandler:i,mouseOutHandler:r},e.addEventListener("mouseover",i),e.addEventListener("mouseout",r)}(this.selector))}disableDebugging(){Pe(this.selector),function(t){const e=t.querySelector(Y);if(!e)return;e.style.outline="";const o=e._tooltipHandlers;o&&(e.removeEventListener("mouseover",o.mouseOverHandler),e.removeEventListener("mouseout",o.mouseOutHandler),delete e._tooltipHandlers);const n=document.getElementById("wwai-subscription-tooltip");n&&(n.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const o=[];let n=!1;const i=t.querySelectorAll(Y);0===i.length?(n=!0,o.push(`Missing <select> with [${z}]`)):i.length>1&&(n=!0,o.push(`Multiple <select> elements with [${z}] found (${i.length}) ‚Äî only one allowed.`));const r=i[0];if(r){"select"!==r.tagName.toLowerCase()&&(n=!0,o.push(`Element with [${z}] must be a <select>, found <${r.tagName.toLowerCase()}>`));const t=r.getAttribute("name");if(t){const e=document.querySelectorAll(`input[name="${t}"], select[name="${t}"]`),i=Array.from(e).filter((t=>t!==r));i.length>0&&(n=!0,o.push(`Name "${t}" is not unique ‚Äî found ${i.length} other input/select(s) using this name`))}else n=!0,o.push('Select element must have a "name" attribute')}const s=n?"error":"valid";return t.setAttribute("debug_status",s),t.setAttribute("debug_message",JSON.stringify(o)),e&&(console.group("[ProductSubscriptionFrequencySelector] Validation Output"),console.log("Status:",s),console.log("Messages:",o),console.groupEnd()),{status:s,messages:o}}}),ao=oo({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=t.querySelector(Y);if(!e)return;let o=document.getElementById("wwai-static-subscription-tooltip");o||(o=document.createElement("div"),o.id="wwai-static-subscription-tooltip",Object.assign(o.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",pointerEvents:"none"}),document.body.appendChild(o));const n=t.getAttribute(ee)||"[no product label]",i={option1:t.getAttribute(oe),option2:t.getAttribute(ne),option3:t.getAttribute(ie)},r=`Static Subscription Frequency Selector\nProduct: ${n}\n${Object.entries(i).filter((([t,e])=>!!e)).map((([t,e])=>`${t}: ${e}`)).join("\n")||"[no variant options]"}\nOptions: ${e.querySelectorAll("option").length}`;e.style.outline="2px solid orange";const s=()=>{const t=e.getBoundingClientRect();o.textContent=r,o.style.left=`${t.left+window.scrollX}px`,o.style.top=`${t.bottom+window.scrollY+6}px`,o.style.display="block"},a=()=>{o.style.display="none"};e._tooltipHandlers={mouseOverHandler:s,mouseOutHandler:a},e.addEventListener("mouseover",s),e.addEventListener("mouseout",a)}(this.selector))}disableDebugging(){Pe(this.selector),function(t){const e=t.querySelector("select");if(!e)return;e.style.outline="";const o=e._tooltipHandlers;o&&(e.removeEventListener("mouseover",o.mouseOverHandler),e.removeEventListener("mouseout",o.mouseOutHandler),delete e._tooltipHandlers);const n=document.getElementById("wwai-static-subscription-tooltip");n&&(n.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const o=[];let n=!1;const i=t.querySelectorAll("select");0===i.length?(n=!0,o.push("Missing <select> element inside static frequency selector")):i.length>1&&(n=!0,o.push(`Multiple <select> elements found (${i.length}) ‚Äî only one allowed.`));const r=i[0];if(r){"select"!==r.tagName.toLowerCase()&&(n=!0,o.push(`Expected a <select> element but found <${r.tagName.toLowerCase()}>`));const t=r.getAttribute("name");if(t){const e=document.querySelectorAll(`input[name="${t}"], select[name="${t}"]`),i=Array.from(e).filter((t=>t!==r));i.length>0&&(n=!0,o.push(`Name "${t}" is not unique ‚Äî found ${i.length} other input/select(s) using this name`))}else n=!0,o.push('Select element must have a "name" attribute')}t.getAttribute(ee)||(n=!0,o.push(`Missing required attribute [${ee}]`));const s=t.getAttribute(oe),a=t.getAttribute(ne),l=t.getAttribute(ie);s||a||l||(n=!0,o.push(`At least one variant option attribute must be defined ([${oe}], etc.)`));const c=n?"error":"valid";return t.setAttribute("debug_status",c),t.setAttribute("debug_message",JSON.stringify(o)),e&&(console.group("[ProductStaticSubscriptionFrequencySelector] Validation Output"),console.log("Status:",c),console.log("Messages:",o),console.groupEnd()),{status:c,messages:o}}}),lo=oo({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=Object.values(d).map((t=>`[${t}]`)).join(", "),o=t.querySelectorAll(e);if(!o.length)return;let n=document.getElementById("wwai-static-price-tooltip");n||(n=document.createElement("div"),n.id="wwai-static-price-tooltip",Object.assign(n.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",pointerEvents:"none"}),document.body.appendChild(n));const i=t.getAttribute(ee)||"(missing)",r={option1:t.getAttribute(oe),option2:t.getAttribute(ne),option3:t.getAttribute(ie)},s=Object.entries(r).filter((([t,e])=>e)).map((([t,e])=>`${t}: ${e}`)).join("\n");o.forEach((t=>{const e=t.getAttribute(c)||"(missing)";let o="";t.hasAttribute(d.BEFORE)?o="beforePrice":t.hasAttribute(d.AFTER)?o="afterPrice":t.hasAttribute(d.DISCOUNT)?o="discountPercentage":t.hasAttribute(d.SAVINGS)&&(o="savings");const r="(missing)"!==e;t.style.outline=r?"2px solid limegreen":"2px solid red";const a=`Static Price Selector\nLabel: ${e}\nType: ${o}\nProduct: ${i}\n${s}`;t.addEventListener("mouseover",(t=>{n.textContent=a,n.style.display="block",n.style.left=`${t.pageX+10}px`,n.style.top=`${t.pageY+10}px`})),t.addEventListener("mousemove",(t=>{n.style.left=`${t.pageX+10}px`,n.style.top=`${t.pageY+10}px`})),t.addEventListener("mouseout",(()=>{n.style.display="none"}))}))}(this.selector))}disableDebugging(){Pe(this.selector),function(t){const e=Object.values(d).map((t=>`[${t}]`)).join(", ");t.querySelectorAll(e).forEach((t=>{t.style.outline="";const e=t.cloneNode(!0);t.replaceWith(e)}));const o=document.getElementById("wwai-static-price-tooltip");o&&(o.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const{status:o,messages:n}=ze(t,"<product-static-price-selector>");e&&(console.group("[ProductStaticPriceSelector] Validation Output"),console.log("Status:",o),console.log("Messages:",n),console.groupEnd()),t.setAttribute("debug_status",o),t.setAttribute("debug_message",JSON.stringify(n))}}),co=oo({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(!function(t){const e=t.querySelectorAll(lt);if(!e.length)return;let o=document.getElementById("wwai-variant-custom-label-tooltip");o||(o=document.createElement("div"),o.id="wwai-variant-custom-label-tooltip",Object.assign(o.style,{position:"fixed",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",pointerEvents:"none"}),document.body.appendChild(o)),e.forEach((t=>{const e=`Custom Variant Label Text\nLabel: ${t.getAttribute(at)||"[missing label]"}\nText: ${t.textContent?.trim()||"[empty text]"}`;t.style.outline="2px solid limegreen";const n=t=>{o.textContent=e,o.style.display="block",o.style.left=`${t.clientX+10}px`,o.style.top=`${t.clientY+10}px`},i=t=>{o.style.left=`${t.clientX+10}px`,o.style.top=`${t.clientY+10}px`},r=()=>{o.style.display="none"};t._tooltipHandlers={onMouseOver:n,onMouseMove:i,onMouseOut:r},t.addEventListener("mouseover",n),t.addEventListener("mousemove",i),t.addEventListener("mouseout",r)}))}(this.selector),xe(this.selector))}disableDebugging(){!function(t){const e=t.querySelectorAll(lt);if(!e.length)return;e.forEach((t=>{t.style.outline="";const e=t._tooltipHandlers;e&&(t.removeEventListener("mouseover",e.onMouseOver),t.removeEventListener("mousemove",e.onMouseMove),t.removeEventListener("mouseout",e.onMouseOut),delete t._tooltipHandlers)}));const o=document.getElementById("wwai-variant-custom-label-tooltip");o&&(o.style.display="none")}(this.selector),Pe(this.selector)}},validateFn:function(t,e=!1){const o=[];let n=!1,i=!1;const r=t.querySelectorAll(lt);0===r.length&&(i=!0,o.push(`No element found with [${lt}]`));const s=new Set;r.forEach(((t,e)=>{const r=t.getAttribute(at)?.trim(),a=(t.textContent||"").trim();r?s.has(r)?(n=!0,o.push(`Duplicate label value "${r}" found`)):s.add(r):(n=!0,o.push(`Element #${e+1} is missing [${at}]`)),a||(i=!0,o.push(`Element #${e+1} has no visible text content`))}));const a=n?"error":i?"warning":"valid";return t.setAttribute("debug_status",a),t.setAttribute("debug_message",JSON.stringify(o)),e&&(console.group("[VariantCustomLabelText] Validation Output"),console.log("Status:",a),console.log("Messages:",o),console.groupEnd()),{status:a,messages:o}}}),uo=oo({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=t.querySelector(s);if(!e)return;let o=document.getElementById("wwai-carousel-tooltip");o||(o=document.createElement("div"),o.id="wwai-carousel-tooltip",Object.assign(o.style,{position:"fixed",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",pointerEvents:"none"}),document.body.appendChild(o)),e.style.outline="2px solid limegreen";const n=a.map((t=>`${t}: ${"function"==typeof e[t]?"yes":"no"}`)).join("\n"),i=`<${s}> found\nMethods:\n${n}`,r=t=>{o.textContent=i,o.style.display="block",o.style.transform=`translate(${t.clientX+10}px, ${t.clientY+10}px)`},l=t=>{o.style.transform=`translate(${t.clientX+10}px, ${t.clientY+10}px)`},c=()=>{o.style.display="none"};e._tooltipHandlers={onMouseOver:r,onMouseMove:l,onMouseOut:c},e.addEventListener("mouseover",r),e.addEventListener("mousemove",l),e.addEventListener("mouseout",c)}(this.selector))}disableDebugging(){Pe(this.selector),function(t){const e=t.querySelector(s);if(!e)return;e.style.outline="";const o=e._tooltipHandlers;o&&(e.removeEventListener("mouseover",o.onMouseOver),e.removeEventListener("mousemove",o.onMouseMove),e.removeEventListener("mouseout",o.onMouseOut),delete e._tooltipHandlers);const n=document.getElementById("wwai-carousel-tooltip");n&&(n.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const o=[];let n=!1;const i=t.querySelectorAll(s);if(0===i.length?(n=!0,o.push(`Missing <${s}> inside <product-custom-carousel-media-selector>.`)):i.length>1&&(n=!0,o.push(`Multiple <${s}> elements found (${i.length}). Only one is allowed.`)),1===i.length){const t=i[0];a.forEach((e=>{"function"!=typeof t[e]&&(n=!0,o.push(`Missing required method: "${e}" on <${s}>.`))}))}const r=n?"error":"valid";return t.setAttribute("debug_status",r),t.setAttribute("debug_message",JSON.stringify(o)),e&&(console.group("[CustomCarouselMediaSelector] Validation Output"),console.log("Status:",r),console.log("Messages:",o),console.groupEnd()),{status:r,messages:o}}}),po=oo({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=t.querySelector("form");if(!e)return;let o=document.getElementById("wwai-addtocart-tooltip");o||(o=document.createElement("div"),o.id="wwai-addtocart-tooltip",Object.assign(o.style,{position:"fixed",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",pointerEvents:"none"}),document.body.appendChild(o)),t.style.outline="2px solid limegreen";const n=e.querySelectorAll('input[type="hidden"]'),r=`Custom Add to Cart\nHidden Inputs: ${Array.from(n).map((t=>t.name)).join(", ")||"[none]"}\nSubmit Button: ${e.querySelector('button[type="submit"]')?"yes":"no"}\n[+Text]: ${e.querySelector(`[${i.ADD_TO_CART_TEXT_ATTR}]`)?"yes":"no"} | [Sold]: ${e.querySelector(`[${i.SOLD_OUT_TEXT_ATTR}]`)?"yes":"no"}`,s=t=>{o.textContent=r,o.style.display="block",o.style.transform=`translate(${t.clientX+12}px, ${t.clientY+12}px)`},a=t=>{o.style.transform=`translate(${t.clientX+12}px, ${t.clientY+12}px)`},l=()=>{o.style.display="none"};t._tooltipHandlers={onMouseOver:s,onMouseMove:a,onMouseOut:l},t.addEventListener("mouseover",s),t.addEventListener("mousemove",a),t.addEventListener("mouseout",l)}(this.selector))}disableDebugging(){Pe(this.selector),function(t){t.style.outline="";const e=t._tooltipHandlers;e&&(t.removeEventListener("mouseover",e.onMouseOver),t.removeEventListener("mousemove",e.onMouseMove),t.removeEventListener("mouseout",e.onMouseOut),delete t._tooltipHandlers);const o=document.getElementById("wwai-addtocart-tooltip");o&&(o.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const o=[];let r=!1,s=!1;const a=t.querySelector("form");if(a){const t=new Set;Array.from(a.querySelectorAll("input")).forEach((e=>{const n=e.getAttribute("name");n&&(t.has(n)&&(r=!0,o.push(`‚ùå Duplicate hidden input name: "${n}"`)),t.add(n))})),n.forEach((({name:t,label:e})=>{a.querySelector(`input[name="${t}"]`)||(r=!0,o.push(`‚ùå Missing hidden input for: ${e} (name="${t}")`))}));const e=a.querySelector('button[type="submit"]');if(e){const t=e.querySelector(`[${i.ADD_TO_CART_TEXT}]`),n=e.querySelector(`[${i.SOLD_OUT_TEXT}]`);t&&n||(s=!0,o.push("‚ö†Ô∏è Missing span(s) inside button: "+(t?"":`[${i.ADD_TO_CART_TEXT}] `)+(n?"":`[${i.SOLD_OUT_TEXT}]`)))}else r=!0,o.push("‚ùå No <button type='submit'> found inside form.")}else r=!0,o.push("‚ùå No <form> found inside <product-custom-add-to-cart-button>.");const l=r?"error":s?"warning":"valid";return t.setAttribute("debug_status",l),t.setAttribute("debug_message",JSON.stringify(o)),e&&(console.group("[AddToCartButton Validation]"),console.log("Status:",l),console.log("Messages:",o),console.groupEnd()),{status:l,messages:o}}}),go=oo({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){if(!t)return;let e=document.getElementById("wwai-submit-interceptor-tooltip");e||(e=document.createElement("div"),e.id="wwai-submit-interceptor-tooltip",Object.assign(e.style,{position:"fixed",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",pointerEvents:"none",maxWidth:"300px"}),document.body.appendChild(e));const n="Submit Interceptor\nATC Exists: "+(t.querySelector(o.PRODUCT_GROUP.ADD_TO_CART)?"‚úÖ Yes":"‚ùå No");t.style.outline="2px solid orange";const i=t=>{e.textContent=n,e.style.display="block",e.style.transform=`translate(${t.clientX+10}px, ${t.clientY+10}px)`},r=t=>{e.style.transform=`translate(${t.clientX+10}px, ${t.clientY+10}px)`},s=()=>{e.style.display="none"};t._tooltipHandlers={mouseOver:i,mouseMove:r,mouseOut:s},t.addEventListener("mouseover",i),t.addEventListener("mousemove",r),t.addEventListener("mouseout",s)}(this.selector))}disableDebugging(){Pe(this.selector),function(t){if(!t)return;t.style.outline="";const e=t._tooltipHandlers;e&&(t.removeEventListener("mouseover",e.mouseOver),t.removeEventListener("mousemove",e.mouseMove),t.removeEventListener("mouseout",e.mouseOut),delete t._tooltipHandlers);const o=document.getElementById("wwai-submit-interceptor-tooltip");o&&(o.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const n=[];let i=!1;t.querySelector(o.PRODUCT_GROUP.ADD_TO_CART)||(i=!0,n.push("‚ùå Missing <${ADD_TO_CART_SELECTOR}> inside submit interceptor."));const r=i?"error":"valid";return t.setAttribute("debug_status",r),t.setAttribute("debug_message",JSON.stringify(n)),e&&(console.group("[ProductCustomSubmitInterceptor] Validation Output"),console.log("Status:",r),console.log("Messages:",n),console.groupEnd()),{status:r,messages:n}}}),fo=oo({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){const e=t.querySelectorAll(De);let o=document.querySelector("#wwai-debug-tooltip-media");o||(o=document.createElement("div"),o.id="wwai-debug-tooltip-media",Object.assign(o.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none"}),document.body.appendChild(o)),e.forEach((t=>{const e=t.getAttribute(Ue)||"(missing)",n="(missing)"!==e?"2px solid limegreen":"2px solid red",i=t.querySelector("img");i?i.style.outline=n:t.style.outline=n;const r=`Media ID: ${e}`;t.addEventListener("mouseover",(t=>{o.textContent=r,o.style.display="block",o.style.left=`${t.pageX+10}px`,o.style.top=`${t.pageY+10}px`})),t.addEventListener("mousemove",(t=>{o.style.left=`${t.pageX+10}px`,o.style.top=`${t.pageY+10}px`})),t.addEventListener("mouseout",(()=>{o.style.display="none"}))}))}(this.selector))}disableDebugging(){Pe(this.selector),function(t){console.log("clearMediaHighlighting called"),t.querySelectorAll(De).forEach((t=>{t.style.outline="";const e=t.cloneNode(!0);t.replaceWith(e)}));const e=document.getElementById("wwai-debug-tooltip-media");e&&(e.style.display="none")}(this.selector)}},validateFn:function(t,e=!1){const o=[];let n=!1;const i=t.getAttribute("section_id"),r=t.getAttribute("product_group");i||(n=!0,o.push("‚ö†Ô∏è Missing attribute [section_id]")),r||(n=!0,o.push("‚ö†Ô∏è Missing attribute [product_group]"));const s=t.querySelector($e);s||(n=!0,o.push(`‚ö†Ô∏è Missing main media container [${$e}]`));const a=s?s.querySelector(De):null;if(a){a.querySelector("img")||(n=!0,o.push("‚ö†Ô∏è Missing <img> element inside the first slide")),a.hasAttribute(Ue)||(n=!0,o.push(`‚ö†Ô∏è First slide is missing required attribute [${Ue}]`))}else n=!0,o.push(`‚ö†Ô∏è Missing initial slide [${De}] in container`);const l=n?"error":"valid";return t.setAttribute("debug_status",l),t.setAttribute("debug_message",JSON.stringify(o)),e&&(console.group("[ProductMediaGalleryForGrids] Validation Output"),console.log("Status:",l),console.log("Messages:",o),console.groupEnd()),{status:l,messages:o}}}),ho=oo({HighlighterClass:class{constructor(t){if(!t)throw new Error("Selector element is required");this.selector=t}enableDebugging(){window.FUNCTIONALITY_DEBUG_MODE&&(xe(this.selector),function(t){if(!t)return void console.error("WWAI-ERROR ‚ùå Selector element not found for hover panel initialization.");let e=document.querySelector("#wwai-flow-config-panel");e||(e=document.createElement("div"),e.id="wwai-flow-config-panel",Object.assign(e.style,{position:"absolute",zIndex:"9999",background:"#333",color:"#fff",padding:"8px 10px",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-line",display:"none",maxWidth:"400px",overflowWrap:"break-word",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.2)"}),document.body.appendChild(e)),t.addEventListener("mouseover",(o=>{const n=t.uxConfig?.preAddToCartFlowConfig,i=`${n?.journeyType||"-"} - ${n?.postSelectionAction||"-"} | ${Array.isArray(n?.overlayContents)?n.overlayContents.join(", "):"-"}`;e.textContent=`${i}`,e.style.display="block"})),t.addEventListener("mousemove",(t=>{e.style.left=`${t.pageX+15}px`,e.style.top=`${t.pageY+15}px`})),t.addEventListener("mouseout",(()=>{e.style.display="none"}))}(this.selector))}disableDebugging(){Pe(this.selector),function(t){if(!t)return void console.warn("‚ö†Ô∏è No selector element provided for panel removal.");const e=document.getElementById("wwai-flow-config-panel");e&&(e.remove(),console.log("‚úÖ Hover panel successfully removed from the DOM.")),t.removeEventListener("mouseover",Ne),t.removeEventListener("mousemove",We),t.removeEventListener("mouseout",Le),console.log("‚úÖ Event listeners successfully removed.")}(this.selector)}},validateFn:function(t,e=!1){const o=[];let n=!1;const i=t.querySelector(":scope > button");if(i){i.textContent.trim().length>0&&(n=!0,o.push("‚ö†Ô∏è Button should not contain text, only an icon."))}else n=!0,o.push(`‚ö†Ô∏è Expected an immediate child <button> element inside <${t.tagName.toLowerCase()}>`);const r=n?"error":"valid";return t.setAttribute("debug_status",r),t.setAttribute("debug_message",JSON.stringify(o)),e&&(console.group("[validateProductGridIconSmartInteractionButton] Validation Output"),console.log("Status:",r),console.log("Messages:",o),console.groupEnd()),{status:r,messages:o}}}),bo={[o.PRODUCT_GROUP.VARIANT]:t=>no(t),[o.PRODUCT_GROUP.PRICE]:io,[o.PRODUCT_GROUP.PURCHASE_TYPE]:ro,[o.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY]:so,[o.PRODUCT_GROUP.VARIANT_CUSTOM_LABEL]:co,[o.PRODUCT_GROUP.CAROUSEL]:uo,[o.PRODUCT_GROUP.ADD_TO_CART]:po,[o.PRODUCT_GROUP.SUBMIT_INTERCEPTOR]:go,[o.PRODUCT_GROUP.PRODUCT_MEDIA_GALLERY_FOR_GRIDS]:fo,[o.PRODUCT_GROUP.GRID_SMART_INTERACTION]:ho,[o.PRODUCT_GROUP.SUBSCRIPTION_FREQUENCY_STATIC]:ao,[o.PRODUCT_GROUP.PRICE_STATIC]:lo};const mo=Object.values(o.PRODUCT_GROUP);function wo(t){const e=[];for(const[o,n]of Object.entries(t)){const t=document.getElementById(o);if(!t)continue;const i=Array.from(n),r=`‚úÖ Product groups in this section: ${i.length} /  ${i.join(", ")}`,s=(()=>{try{return JSON.parse(t.getAttribute("debug_message"))||[]}catch{return[]}})(),a=Array.from(new Set([...s,r]));t.setAttribute("debug_status","valid"),t.setAttribute("debug_message",JSON.stringify(a)),e.push(t)}var o;(o=e)&&o.length&&to(((t,{isFirstSet:e})=>{o.forEach((o=>{!0===t?xe(o):!1!==t||e||Pe(o)}))}))}function _o(){const t=function(){const t={};return mo.forEach((e=>{document.querySelectorAll(e).forEach((e=>{const o=e.getAttribute("section_id")?.trim(),n=e.getAttribute("product_group")?.trim(),i=o&&!!document.getElementById(o),r=[];let s=!1;o?i||(s=!0,r.push(`No element found in DOM with id="${o}".`)):(s=!0,r.push("Missing `section_id` attribute.")),n||(s=!0,r.push("Missing `product_group` attribute."));const a=(()=>{try{return JSON.parse(e.getAttribute("debug_message"))||[]}catch{return[]}})(),l=e.getAttribute("debug_status")||"valid",c=s||"error"===l?"error":l,d=Array.from(new Set([...a,...r]));e.setAttribute("debug_status",c),e.setAttribute("debug_message",JSON.stringify(d)),!s&&o&&n&&(t[o]=t[o]||new Set,t[o].add(n))}))})),t}();wo(t);const e={};for(const[o,n]of Object.entries(t))e[o]=Array.from(n);return e}const yo={mock:async t=>(console.log(`[MOCK] Simulated fetch for: /products/${t}.js`),{handle:t,title:`Mock Product for ${t}`,variants:[{id:`${t}-variant-1`,title:"Default Variant",available:!0}],selling_plan_groups:[],images:[],description:"Mock product.",vendor:"MockVendor",product_type:"MockType"}),shopify:async t=>{try{const e=await fetch(`/products/${t}.js`);return e.ok?await e.json():(console.error(`WWAI-ERROR ‚ùå Fetch failed for /products/${t}.js ‚Äî HTTP ${e.status}`),null)}catch(e){return console.error(`WWAI-ERROR ‚ùå Error fetching ${t}:`,e),null}}};function vo(t){let e=0,o=0;return Object.entries(t.productGroups||{}).forEach((([t,n])=>{e++,o+=Object.keys(n).length})),{groupCount:e,totalLabels:o}}function Co(t,e){const o=function(t){return"object"==typeof R().JS_PRODUCT_MAPPING_OBJECT&&null!==R().JS_PRODUCT_MAPPING_OBJECT&&Object.keys(R().JS_PRODUCT_MAPPING_OBJECT).length>0?(console.log("Using preloaded getWWAIConfig().JS_PRODUCT_MAPPING_OBJECT to hydrate via JS."),R().JS_PRODUCT_MAPPING_OBJECT):"object"==typeof jsObj&&null!==jsObj&&0===Object.keys(jsObj).length?(t&&(console.warn("‚ö†Ô∏è getWWAIConfig().JS_PRODUCT_MAPPING_OBJECT is defined but empty."),console.warn("üí° This likely means your JS assignment didn‚Äôt populate product mappings correctly.")),{}):(console.error("WWAI-ERROR [ERROR]: getWWAIConfig().JS_PRODUCT_MAPPING_OBJECT is undefined"),{})}(e);if(0==Object.keys(o).length)return;const n=function({createIfMissing:t=!1}={}){if(!window.__WWAI__SECTION_PRODUCT_DATA__){if(!t)throw new Error("window.__WWAI__SECTION_PRODUCT_DATA__ not found.");window.__WWAI__SECTION_PRODUCT_DATA__={}}if(!window.__WWAI__SECTION_PRODUCT_DATA__.all_sections){if(!t)throw new Error("window.__WWAI__SECTION_PRODUCT_DATA__['all_sections'] not found.");window.__WWAI__SECTION_PRODUCT_DATA__.all_sections={}}if(!window.__WWAI__SECTION_PRODUCT_DATA__.all_sections.storeData){if(!t)throw new Error("SECTION_DATA.storeData not initialized. Make sure Liquid block ran before this.");window.__WWAI__SECTION_PRODUCT_DATA__.all_sections.storeData={productGroups:{},variantSellingPlans:{},variantSubscriptionMapping:{}}}return window.__WWAI__SECTION_PRODUCT_DATA__.all_sections.storeData}({createIfMissing:"mock"==t}),i=vo(n),{toFetch:r,grouped:s}=function(t,e){const o=new Set,n={};return Object.entries(t).forEach((([t,i])=>{e.productGroups[t]=e.productGroups[t]||{},n[t]=[],Object.entries(i).forEach((([i,r])=>{e.productGroups[t][i]?console.info(`Skipping already loaded: [${t}] ${i} (${r})`):(n[t].push({label:i,handle:r}),o.add(r))}))})),{toFetch:o,grouped:n}}(o,n);return function(t,e="mock"){const o=yo[e];if(!o)throw new Error(`‚ùå Unknown connector type: "${e}"`);return Promise.all(t.map((t=>o(t))))}([...r],t).then((t=>{const e=function(t){const e={};return t.forEach((t=>{t&&(e[t.handle]=t)})),e}(t);!function({grouped:t,handleToProduct:e,storeData:o}){window.__WWAI_PRODUCT_AVAILABILITY__=window.__WWAI_PRODUCT_AVAILABILITY__||{},Object.entries(t).forEach((([t,n])=>{n.forEach((({label:n,handle:i})=>{const r=e[i],s=`${t}__${n}`;r?(o.productGroups[t][n]=r,o.variantSellingPlans[s]={variants:r.variants||[],selling_plan_groups:r.selling_plan_groups||[]},o.variantSubscriptionMapping=o.variantSubscriptionMapping||{},o.variantSubscriptionMapping[s]={},window.__WWAI_PRODUCT_AVAILABILITY__[i]=!0,console.log(`‚úÖ Loaded: Product using connector ${R().CONNECTOR_TYPE} - ${i}`)):(window.__WWAI_PRODUCT_AVAILABILITY__[i]=!1,console.warn(`‚ö†Ô∏è Failed to fetch: ${i}`))}))}))}({grouped:s,handleToProduct:e,storeData:n});const o=vo(n),r=o.totalLabels-i.totalLabels;console.log(`Hydrated ${r} new product label(s) across ${o.groupCount} group(s).`)}))}function Oo(t=!0){if(Array.isArray(window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__)&&window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__.length>0)return console.log("‚ö° Using preloaded window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__ to init product availability."),e=window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__,window.__WWAI_PRODUCT_AVAILABILITY__=window.__WWAI_PRODUCT_AVAILABILITY__||{},void e.forEach((t=>{const e=t.split(":").map((t=>t.trim()))[2];e&&(window.__WWAI_PRODUCT_AVAILABILITY__[e]=!0)}));var e;Array.isArray(window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__)&&0===window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__.length?t&&(console.warn("‚ö†Ô∏è Detected has_static_loaded_products is set but window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__ is defined and empty."),console.warn("üí° This likely means your Liquid block did not assign `product_mapping_array` correctly.")):console.log("[ERROR]: window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__ undefined")}function Ao({sectionId:t,productGroup:e,config:n={}}){console.log(`üîÑ Initializing Config for [${t} / ${e}]`),function({sectionId:t,productGroup:e,flowConfig:n={}}){Object.values(o.PRODUCT_GROUP).forEach((o=>{const i=G(t,e,o);i.length&&i.forEach(((t,e)=>{if("function"==typeof t.initFlowConfig)try{t.initFlowConfig(n)}catch(t){console.error(`WWAI-ERROR ‚ùå Error initializing flow config for [${o} - index ${e}]`,t)}}))}))}({sectionId:t,productGroup:e,flowConfig:n.flowConfig}),function({sectionId:t,productGroup:e,uxConfig:n={}}){Object.values(o.PRODUCT_GROUP).forEach((o=>{const i=G(t,e,o);i.length&&i.forEach(((t,e)=>{if("function"==typeof t.initUXConfig)try{t.initUXConfig(n)}catch(t){console.error(`WWAI-ERROR ‚ùå Error initializing UX config for [${o} - index ${e}]`,t)}}))}))}({sectionId:t,productGroup:e,uxConfig:n.uxConfig}),function({sectionId:t,productGroup:e,pricingConfig:n={}}){Object.values(o.PRODUCT_GROUP).forEach((o=>{const i=G(t,e,o);i.length&&i.forEach(((t,e)=>{if("function"==typeof t.initPricingConfig)try{t.initPricingConfig(n)}catch(t){console.error(`WWAI-ERROR ‚ùå Error initializing Pricing config for [${o} - index ${e}]`,t)}}))}))}({sectionId:t,productGroup:e,pricingConfig:n.pricingConfig})}function Io(t,e,o){console.log("üîÑ Disabling unavailable options:",t,e),t.forEach((t=>{if(t.getAttribute(J)===et){const n=t.getAttribute(Z)||"option1",i=t.getAttribute(Q);let r=e[n]?.has(i.trim());1==o&&1==e[n].size&&(r=!0);const s=document.querySelector(`label[for="${t.id}"]`);t.disabled=!r,t.style.opacity=r?"":"0.5",t.style.pointerEvents=r?"":"none",t.style.cursor=r?"":"not-allowed",s&&(s.style.color=r?"":"#aaa",s.style.cursor=r?"":"not-allowed")}}))}function Eo(t,e=!0){const o=t?.option3;if(!o||o.size<=1)return;const n=Array.from(o),i=n[Math.random()>.5?0:n.length-1];o.delete(i),e&&console.log(`üîÑ Removed "${i}" from option3`)}function Ro(t){const e={option1:new Set,option2:new Set,option3:new Set};return t.forEach((t=>{t.available&&(t.option1&&e.option1.add(t.option1.trim()),t.option2&&e.option2.add(t.option2.trim()),t.option3&&e.option3.add(t.option3.trim()))})),e}async function To(t,e=!0){try{if(e){const e=await async function(t){try{const e=document.querySelector("script[id='shopify-features']"),o=JSON.parse(e.innerHTML),n=await fetch(`${Shopify.routes.root}cart.js`).then((t=>t.json())),i={Authorization:"Basic "+btoa(o.accessToken),Accept:"*/*","Content-Type":"application/json"},r={checkout:{line_items:n.items,discount_code:t,country:Shopify.country,presentment_currency:n.currency}},s=await fetch("/wallets/checkouts/",{method:"POST",headers:i,body:JSON.stringify(r),referrerPolicy:"no-referrer"}),a=await s.json();return a.errors&&a.errors.discount_code?{isValid:!1,error:a.errors.discount_code[0].message}:{isValid:!0}}catch(t){return console.error("WWAI-ERROR Error in validateDiscountCode:",t),{isValid:!1,error:"Unable to validate discount code"}}}(t);if(!e.isValid)return void console.error(`WWAI-ERROR Failed to activate discount code "${t}" because: ${e.error}`)}const o=await async function(t){try{const e=await fetch(`/discount/${t}`);return{success:!0,html:await e.text()}}catch(t){return console.error("WWAI-ERROR Discount activation failed (/discount):",t),{success:!1,error:"Unable to activate discount"}}}(t);o.success?console.log(`Discount code "${t}" activated successfully.`):console.error(`WWAI-ERROR Failed to activate discount code "${t}" because: ${o.error}`)}catch(e){console.error(`WWAI-ERROR Error activating discount code "${t}":`,e)}}function So(t){(t?.pricingConfig?.discountCodeToApply||[]).filter((t=>"string"==typeof t&&t.trim())).forEach((t=>async function(t,e=!0){const o=t.trim().toUpperCase();if(window.__wwai_discount_codes_applied.has(o))console.warn(`Discount code "${o}" has already been applied.`);else try{await To(o,e),window.__wwai_discount_codes_applied.add(o)}catch(t){console.error(`WWAI-ERROR ‚ùå Error applying discount code "${o}":`,t.message)}}(t.trim(),!1)))}function Po(t,e,o){if(!t||!t.variantDispatchConfig)return console.error("WWAI-ERROR ‚ùå No config found for sectionId:",e,"productGroup:",o),{productLabel:null,variantOptions:null};return{productLabel:t.variantDispatchConfig.defaultProduct,variantOptions:function(t){const e={};return t.defaultVariantOption1&&(e.option1=t.defaultVariantOption1),t.defaultVariantOption2&&(e.option2=t.defaultVariantOption2),t.defaultVariantOption3&&(e.option3=t.defaultVariantOption3),e}(t.variantDispatchConfig)}}function xo({sectionId:t,productGroup:e,variantSelector:o}){const n=St(t,e),{productLabel:i,variantOptions:r}=Po(n,t,e);if(!i||!r)return{config:null,variant_config:null,product_object:null,variant_object:null,productLabel:null,variantOptions:null};const{config:s,variant_config:a,product_object:l,variant_object:c}=Pt(t,e,i,r);return Ao({sectionId:t,productGroup:e,config:s}),So(s),function(t,e,o={}){const{mock:n=!1}=o;if(!e||!e.inputs)return void console.warn("‚ö†Ô∏è Invalid or missing variant selector element.");let i=[];e.inputs.forEach((t=>{i.push(t.getAttribute(X))})),i=[...new Set(i)],console.log("üîÑ Variant available product labels:",i);for(const o of i){console.log("üîÑ Variant Availability Product label:",o);const i=vt(t,o);if(!i?.variants||!Array.isArray(i.variants))return void console.warn("‚ö†Ô∏è Product object does not contain variants.");const r=Ro(i.variants);let s=i.variants.length;console.log("üîÑ Available options:",r),n&&Eo(r,!0),console.log("üîÑ Available options after mock:",r);let a=[];e.inputs.forEach((t=>{t.getAttribute(X)===o&&a.push(t)})),console.log("üîÑ Variant options for selected product:",o,a,r),Io(a,r,s)}}(e,o,{mock:!0}),{config:s,variant_config:a,product_object:l,variant_object:c,productLabel:i,variantOptions:r}}function $o(t,e,n,i){const r=M(t,e,o.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO),s=St(t,e),{productLabel:a,variantOptions:l}=Po(s,t,e),{config:c,variant_config:d,product_object:u,variant_object:p}=Pt(t,e,a,l);Ao({sectionId:t,productGroup:e,config:c}),So(c),c&&d&&u&&p?function({scope:t,sectionId:e,productGroup:o,productLabel:n,variantOptions:i,product_object:r,variant_object:s,variant_config:a,config:l}){if("pdp"!==t)throw new Error("WWAI-ERROR ‚ùå Unknown scope type:",t);be({sectionId:e,productGroup:o,productLabel:n,variantOptions:i,productObject:r,variantObject:s,variantConfig:a,config:l}),he({sectionId:e,productGroup:o})}({scope:r,sectionId:t,productGroup:e,productLabel:a,variantOptions:l,product_object:u,variant_object:p,variant_config:d,config:s}):console.error("WWAI-ERROR ‚ùå No config, variant_config, product_object, or variant_object found for sectionId:",t,"productGroup:",e)}function Do({scope:t,sectionId:e,productGroup:n,productLabel:i,variantOptions:r,product_object:s,variant_object:a,variant_config:l,config:c}){switch(t){case"collection":case"pdp":Mt({sectionId:e,productGroup:n,productLabel:i,variantOptions:r,productObject:s,variantObject:a,variantConfig:l,config:c});break;case"virtual_bundle":!function({sectionId:t,productGroup:e,bundlePayload:n}){const i=k(t,e,o.PRODUCT_GROUP.ADD_TO_CART);i&&("function"==typeof i.updateAddToCartFormWithBundlePayload?(console.log("üõí Bundle AddToCart Payload to be set:",n),i.updateAddToCartFormWithBundlePayload(n)):console.error("WWAI-ERROR ‚ùå <product-custom-add-to-cart-button-selector> is missing .updateAddToCartFormWithBundlePayload()"))}({sectionId:e,productGroup:n,bundlePayload:a});break;default:throw new Error("WWAI-ERROR ‚ùå Unknown scope type:",t)}}function Uo(){window.addEventListener("pageshow",(t=>{t.persisted?(console.log("üîÅ Page restored from bfcache ‚Äî cleaning up loaders..."),_()):console.log("‚úÖ Page shown normally (not from bfcache).")})),window.addEventListener("load",(()=>{console.log("üì¶ Full page load ‚Äî running loader cleanup just in case..."),_()})),console.group("[WWAI] üîß Initializing Product Groups");Object.values(N).map((({sectionId:t,productGroup:e})=>({sectionId:t,productGroup:e}))).forEach(((t,e)=>function({sectionId:t,productGroup:e},n){console.group(`‚úÖ [${n+1}] Init: section="${t}", product_group="${e}"`);const i=k(t,e,o.PRODUCT_GROUP.VARIANT),r=k(t,e,o.PRODUCT_GROUP.VARIANT_PURCHASE_TYPE_COMBO);if(i&&r)throw new Error("WWAI-ERROR ‚ùå Both variant and variant purchase type combo selectors found for sectionId:",t,"productGroup:",e);if(r)return void $o(t,e);const s=M(t,e,o.PRODUCT_GROUP.VARIANT),{config:a,variant_config:l,product_object:c,variant_object:d,productLabel:u,variantOptions:p}=xo({sectionId:t,productGroup:e,variantSelector:i});a&&l&&c&&d?(Do({scope:s,sectionId:t,productGroup:e,productLabel:u,variantOptions:p,product_object:c,variant_object:d,variant_config:l,config:a}),console.groupEnd()):console.error("WWAI-ERROR ‚ùå No config, variant_config, product_object, or variant_object found for sectionId:",t,"productGroup:",e)}(t,e))),console.log("üîÑ Starting height equalization on load."),document.querySelectorAll(o.OTHER.PRODUCT_GRID_HEIGHT_EQUALIZER).forEach((t=>{const e=t.getBoundingClientRect();e.top<window.innerHeight&&e.bottom>0&&(console.log(`[${t.sectionId}] üü¢ Detected in view, running equalize now.`),t.equalize("immediate-on-load"))})),console.groupEnd()}function No(){console.log("üîÑ Initializing product data from JSON scripts..."),function(){const t=Re("wwai-static-product-section-data"),e=Re("wwai-static-liquid-product-mapping-array");window.__WWAI__SECTION_PRODUCT_DATA__=window.__WWAI__SECTION_PRODUCT_DATA__||{},window.__WWAI__SECTION_PRODUCT_DATA__.all_sections?console.warn("‚ö†Ô∏è SECTION_DATA.all_sections is already initialized. Skipping overwrite."):window.__WWAI__SECTION_PRODUCT_DATA__.all_sections=t,window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__=window.__WWAI__LIQUID_STATIC_PRODUCT_MAPPING_ARRAY__||e}(),function(t=window.__WWAI__){const e=[],o={useMockSubscription:"boolean",deployMode:["local","sandbox","prod"],MODE:["dev","prod"],RENDER_WITH_LIQUID:"boolean",CONNECTOR_TYPE:["shopify"],heightEqualizeLogging:"boolean"};for(const[n,i]of Object.entries(o)){const o=t[n];Array.isArray(i)?i.includes(o)||e.push(`‚ùå ${n} must be one of [${i.join(", ")}], got "${o}"`):typeof o!==i&&e.push(`‚ùå ${n} must be of type ${i}, got ${typeof o}`)}if("string"!=typeof t.CURRENCY&&e.push("‚ùå CURRENCY must be a string, got "+typeof t.CURRENCY),"number"!=typeof t.CURRENCY_FACTOR&&e.push("‚ùå CURRENCY_FACTOR must be a number, got "+typeof t.CURRENCY_FACTOR),E(t.JS_PRODUCT_MAPPING_OBJECT)||e.push("‚ùå JS_PRODUCT_MAPPING_OBJECT must be an object"),E(t.WWAI_PRODUCT_GROUP_CONFIG)||e.push("‚ùå WWAI_PRODUCT_GROUP_CONFIG must be an object"),E(t.WWAI_PRODUCT_VARIANT_OVERRIDES)||e.push("‚ùå WWAI_PRODUCT_VARIANT_OVERRIDES must be an object"),E(t.WWAI_LABELED_IMAGES)||e.push("‚ùå WWAI_LABELED_IMAGES must be an object"),0===Object.keys(t.WWAI_PRODUCT_VARIANT_OVERRIDES||{}).length&&console.warn("‚ö†Ô∏è WWAI_PRODUCT_VARIANT_OVERRIDES is empty"),e.length>0)throw console.group("‚ùå WWAI Config Validation Failed:"),e.forEach((t=>console.warn(t))),console.groupEnd(),new Error("WWAI config validation failed");console.log("‚úÖ WWAI config validated successfully.")}(),console.log("‚úÖ Product data initialization complete")}function Wo(){Object.entries(Te).forEach((([t,e])=>{document.querySelectorAll(t).forEach((o=>{o instanceof e||console.warn(`[WWAI] Element <${t}> is NOT an instance of its expected class.`)}))}));const t=function(){const t={};for(const e in o.PRODUCT_GROUP)if(Object.prototype.hasOwnProperty.call(o.PRODUCT_GROUP,e)){const n=o.PRODUCT_GROUP[e];bo[n]?t[n]=bo[n]:console.warn(`No debug function mapped for selector: ${n}`)}return t}();var e;e=t,Object.entries(e).forEach((([t,e])=>{document.querySelectorAll(t).forEach((t=>{e(t)}))})),eo(R().RENDER_WITH_LIQUID),_o();const n=R();window.FUNCTIONALITY_DEBUG_MODE=n.MODE&&"dev"==n.MODE,window.FUNCTIONALITY_DEBUG_MODE&&console.log("üîß Functionality Debug Mode Enabled")}function Lo(){console.log("üöÄ Running Dispatch Logic..."),L();const t=document.querySelector(o.PRODUCT_VARIANT_SELECTOR);(async()=>{const{has_static_loaded_liquid_products:e,has_js_loaded_products:o}=function(t){const{merged:e,liquid_loaded:o,js_loaded:n}=Je(t);return{has_static_loaded_liquid_products:!Xe(o),has_js_loaded_products:!Xe(n)}}(R().RENDER_WITH_LIQUID);await async function(t,e,o){if(Oo(e),_storeDataApiInitialized)console.info("‚ö†Ô∏è initializeStoreDataViaApiCall() skipped (already initialized).");else{if(window._storeDataApiInitialized=!0,o)return console.log("Hydrating product group(s) via JS..."),void await Co(t,o);console.log("No additional JS-based product groups to hydrate.")}}(R().CONNECTOR_TYPE,e,o),Be(t),Uo(),console.log("Running Grid equalization from cache."),window.applyCachedHeightsOnLoad(),console.log("‚úÖ Product Groups Initialized Successfully")})()}function Go(t,e,o=null){const n=Object.entries(t||{}).map((([t,e])=>function(t,e){if("object"==typeof e&&null!==e)return`\n      <details style="margin-bottom: 8px; border: 1px solid #eee; border-radius: 4px;" data-config-key="${t}">\n        <summary style="padding: 8px; cursor: pointer; font-weight: bold; background-color: #f8f9fa;">\n          ${t}\n        </summary>\n        <div style="padding: 8px;">\n          <textarea rows="4" data-config-field style="\n            width: 100%;\n            font-family: monospace;\n            font-size: 12px;\n            padding: 8px;\n            border: 1px solid #ccc;\n            border-radius: 4px;\n            resize: vertical;\n            background-color: #fafafa;\n          ">${JSON.stringify(e,null,2)}</textarea>\n        </div>\n      </details>\n    `;let o="";return o="string"==typeof e?`<input type="text" data-config-field value="${e}" style="width: 300px; padding: 6px 10px; font-family: monospace; font-size: 12px;" />`:"number"==typeof e?`<input type="number" data-config-field value="${e}" style="width: 150px; padding: 6px 10px; font-family: monospace; font-size: 12px;" />`:"boolean"==typeof e?`\n      <select data-config-field style="padding: 6px 10px; font-family: monospace; font-size: 12px;">\n        <option value="true" ${e?"selected":""}>true</option>\n        <option value="false" ${e?"":"selected"}>false</option>\n      </select>\n    `:'<span style="color: red;">Unsupported type</span>',`\n    <div style="margin-bottom: 12px; display: flex; align-items: center; gap: 12px;" data-config-key="${t}">\n      <label style="font-weight: bold; font-family: monospace; font-size: 12px; min-width: 200px;">${t}</label>\n      ${o}\n    </div>\n  `}(t,e))).join("");return o&&(window.wwaiConfigSnapshots=window.wwaiConfigSnapshots||{},window.wwaiConfigSnapshots[o]=structuredClone(t)),n||`<p style="color: #888; text-align: center; padding: 20px;">${e}</p>`}function ko(t){const e=document.querySelector(t),o={};return e?(e.querySelectorAll("[data-config-key]").forEach((t=>{const e=t.getAttribute("data-config-key"),n=t.querySelector("[data-config-field]");if(n)if("TEXTAREA"===n.tagName)try{o[e]=JSON.parse(n.value)}catch(t){console.warn(`Invalid JSON in field for key: ${e}`),o[e]=null}else"SELECT"===n.tagName?o[e]="true"===n.value:"number"===n.type?o[e]=parseFloat(n.value):o[e]=n.value})),o):o}function Mo(t){return ko(t)}function qo(t,e){const o=window.wwaiConfigSnapshots[t]||{},n=ko(e),i={};for(const t of new Set([...Object.keys(o),...Object.keys(n)])){JSON.stringify(o[t])!==JSON.stringify(n[t])&&(i[t]={before:o[t],after:n[t]})}return i}function jo(t,e){const o=ko(e);window.wwaiConfigSnapshots[t]=structuredClone(o)}function Bo(t){const e=function(t){const e=document.querySelectorAll('[id*="shopify-section-template"]');for(const o of e)if(o.id.includes(t))return o;return null}(t);e?(e.scrollIntoView({behavior:"smooth",block:"start"}),e.style.transition="background-color 0.3s ease",e.style.backgroundColor="#fff3cd",setTimeout((()=>{e.style.backgroundColor=""}),2e3),console.log(`‚úÖ Scrolled to section: ${t}`)):(console.warn(`‚ö†Ô∏è Section not found: ${t}`),alert(`Section "${t}" not found on the page.`))}window._storeDataApiInitialized=window._storeDataApiInitialized||!1,window.__wwai_discount_codes_applied=window.__wwai_discount_codes_applied||new Set,window.wwaiConfigSnapshots=window.wwaiConfigSnapshots||{},window.wwaiConfigPanelGetGeneralConfig=function(){const t=Mo("#tab-content-general");return console.log("üõ† Updated Config:",t),t},window.wwaiDiffGeneralConfig=function(){const t=qo("general-config","#tab-content-general");return console.log("ü™Ñ Config Diff:",t),t},window.wwaiSaveGeneralConfig=function(){jo("general-config","#tab-content-general"),console.log("‚úÖ Saved updated config for snapshot: general-config")},window.wwaiConfigPanelGetProductMappingConfig=function(){const t=Mo("#tab-content-mapping");return console.log("üó∫Ô∏è Updated Product Mapping Config:",t),t},window.wwaiDiffProductMappingConfig=function(){const t=qo("product-mapping","#tab-content-mapping");return console.log("ü™Ñ Product Mapping Diff:",t),t},window.wwaiSaveProductMappingConfig=function(){jo("product-mapping","#tab-content-mapping"),console.log("‚úÖ Saved updated config for snapshot: product-mapping")},window.scrollToSection=Bo;const Vo={discountPercent:"number",subscriptionDiscountPercent:"number",defaultSubscriptionOption:"string|null",discountCodeToApply:"array<string>",roundDiscount:"boolean",addOffSuffixToDiscount:"boolean"},Ho={destination:["checkout","cart","side-cart"],loader:["add-to-cart-submit-button","media-gallery"],showSuccessNotification:"boolean",showErrorNotification:"boolean",sideCartLabel:["","littlewords","rco","nwkw","kitsch","puracy","drmtlgy","dose"],successNotificationMessage:"string",errorNotificationMessage:"string",notificationOptions:{backgroundColor:"string",textColor:"string",borderColor:"string",fontFamily:"string"}},Fo={variantOptionRemovePrefix:"string",defaultPurchaseType:["onetime","subscription"],variantUXConfig:{hideSingleLengthVariants:"boolean",onlyShowVariantsWithLabelContains:["string","null"],refreshUxOnVariantChange:"boolean"},preAddToCartFlowConfig:{journeyType:["custom-redirect","direct-add","redirect","overlay","na"],overlayContents:["array<string>","null"],postSelectionAction:["add-to-cart","redirect","na"],postSelectionActionParams:{custom_url:["string","null"],redirect_variant_options:["array<string>","null"]}}},zo={defaultProduct:"string",defaultVariantOption1:["string","null"],defaultVariantOption2:["string","null"],defaultVariantOption3:["string","null"],allProducts:"string",allOptions:{option1:"string",option2:"string",option3:"string"}};function Yo(t,e){return"string"===e?"string"==typeof t:"number"===e?"number"==typeof t:"boolean"===e?"boolean"==typeof t:"null"===e?null===t:"string|null"===e?"string"==typeof t||null===t:"array<string>"===e&&(Array.isArray(t)&&t.every((t=>"string"==typeof t)))}function Jo(t){if(!Array.isArray(t))return!1;const e=["string","number","boolean","null","array<string>"];return t.every((t=>e.includes(t)))}function Xo(t){if(!Array.isArray(t))return!1;const e=["string","number","boolean","null","array<string>"];return t.every((t=>!e.includes(t)))}function Qo(t,e){return 0===t.length?`<div style="color: green; font-weight: bold; margin-bottom: 8px;">${e} is valid.</div>`:`<div style="color: red; font-weight: bold; margin-bottom: 8px;">Invalid ${e}:<br>${t.join("<br>")}</div>`}function Zo(t,e,o=""){const n=[];if(t&&"object"==typeof t)for(const i in t)if(!(i in e)){const t=o?`${o}.${i}`:i;n.push(`${t} is not a valid field in the schema`)}for(const i in e){const r=o?`${o}.${i}`:i,s=e[i],a=t?.[i];if(Array.isArray(s))if(Jo(s)){s.some((t=>Yo(a,t)))||n.push(`${r} must be one of types: ${s.join(", ")}`)}else if(Xo(s)){s.includes(a)||n.push(`${r} must be one of: ${s.join(", ")}`)}else{s.includes(a)||n.push(`${r} must be one of: ${s.join(", ")}`)}else"string"==typeof s?Yo(a,s)||n.push(`${r} must be of type ${s}`):"object"==typeof s&&("object"!=typeof a||null==a?n.push(`${r} must be an object`):n.push(...Zo(a,s,r)))}return n}function Ko(t,e,o,n=!1){return`\n        <div style="margin-bottom: 10px;">\n            <label style="font-weight: bold; font-size: 12px;">${t}:</label>\n            <input type="text" value="${o??""}" data-config-path="${e}" data-allow-null="${n}" onchange="window.wwaiProductGroupConfigOnChangeHandler(this)" />\n        </div>\n    `}function tn(t,e,o,n=!1,i=""){return`\n        <div style="margin-bottom: 10px;">\n            <label style="font-weight: bold; font-size: 12px;">${t}:</label>\n            <input type="text" value="${o?o.join(", "):""}" data-config-path="${e}" data-allow-null="${n}" data-is-array="true" onchange="window.wwaiProductGroupConfigOnChangeHandler(this)" />\n            ${i?`<div style="font-size: 11px; color: #666;">${i}</div>`:""}\n        </div>\n    `}function en(t,e,o,n={}){const i=[];for(const[a,l]of Object.entries(t||{})){const t=e[a];if(t)if("object"!=typeof t||Array.isArray(t))i.push(on(a,l,e,o));else if(l){const e=en(l,t,`${o}.${a}`,n);i.push((r=a,s=e.join(""),`\n        <fieldset style="margin-top: 12px; padding: 8px; border: 1px dashed #999;">\n            <legend><strong>${r}</strong></legend>\n            ${s}\n        </fieldset>\n    `))}}var r,s;return i}function on(t,e,o,n){const i=`${n}.${t}`,r=o[t];if("string"==typeof r){const o={string:()=>Ko(t,i,e),number:()=>`\n        <div style="margin-bottom: 10px;">\n            <label style="font-weight: bold; font-size: 12px;">${t}:</label>\n            <input type="number" value="${e}" data-config-path="${i}" onchange="window.wwaiProductGroupConfigOnChangeHandler(this)" />\n        </div>\n    `,boolean:()=>{return`\n        <div style="margin-bottom: 10px;">\n            <label style="font-weight: bold; font-size: 12px;">${t}:</label>\n            <select data-config-path="${i}" onchange="window.wwaiProductGroupConfigOnChangeHandler(this)">\n                <option value="true" ${(o=e)?"selected":""}>true</option>\n                <option value="false" ${o?"":"selected"}>false</option>\n            </select>\n        </div>\n    `;var o},"string|null":()=>Ko(t,i,e,!0),"array<string>":()=>tn(t,i,e,!1,"Comma-separated list")};return o[r]?o[r]():Ko(t,i,e)}if(Array.isArray(r)){const o=["string","number","boolean","null","array<string>","string|null"];if(r.every((t=>o.includes(t)))){return"array<string>"===r.find((t=>"null"!==t))?tn(t,i,e,!0):Ko(t,i,e,!0)}return s=e,`\n        <div style="margin-bottom: 10px;">\n            <label style="font-weight: bold; font-size: 12px;">${t}:</label>\n            <select data-config-path="${i}" onchange="window.wwaiProductGroupConfigOnChangeHandler(this)">\n                ${r.map((t=>`<option value="${t}" ${t===s?"selected":""}>${t||"(empty)"}</option>`)).join("")}\n            </select>\n        </div>\n    `}return"object"==typeof r?function(t,e,o){return`\n        <div style="margin-bottom: 10px;">\n            <label style="font-weight: bold; font-size: 12px;">${t}:</label>\n            <textarea rows="3" data-config-path="${e}" onchange="window.wwaiProductGroupConfigOnChangeHandler(this)">${JSON.stringify(o,null,2)}</textarea>\n        </div>\n    `}(t,i,e):Ko(t,i,e);var s}function nn(t,e){const o=Qo(Zo(t,Vo),"Pricing config"),n=function(t,e){return en(t,Vo,e).join("")}(t,e);return o+n}function rn(t,e){const o=Qo(Zo(t,Fo),"UX config"),n=function(t,e){const o=[],n=en(t,Fo,e);return o.push(...n),o.join("")}(t,e);return o+n}function sn(t,e){const o=Qo(Zo(t,Ho),"Flow config"),n=function(t,e){return en(t,Ho,e).join("")}(t,e);return o+n}function an(t,e,o){return`\n        <details style="margin-top: 10px; border: 1px solid #ddd; border-radius: 4px; padding: 8px;">\n            <summary style="cursor: pointer; font-weight: bold; padding: 4px 0;">\n                Defaults\n            </summary>\n            <div style="margin-top: 8px;">\n                ${function(t,e,o,n){const i=`${e}-${o}`;return`\n    <div class="wwai-config-tabs" style="margin-top: 12px;">\n    <div style="display: flex; gap: 12px; margin-bottom: 12px;">\n        <button onclick="window.showConfigTab('${e}', '${o}', 'pricing')">Pricing</button>\n        <button onclick="window.showConfigTab('${e}', '${o}', 'ux')">UX</button>\n        <button onclick="window.showConfigTab('${e}', '${o}', 'flow')">Flow</button>\n    </div>\n\n    <div id="tab-${i}-pricing">\n        ${nn(t.pricingConfig||{},`${n}.pricingConfig`)}\n    </div>\n    <div id="tab-${i}-ux" style="display: none;">\n        ${rn(t.uxConfig||{},`${n}.uxConfig`)}\n    </div>\n    <div id="tab-${i}-flow" style="display: none;">\n        ${sn(t.flowConfig||{},`${n}.flowConfig`)}\n    </div>\n    </div>\n    `}(e,t,"default",o)}\n            </div>\n        </details>\n    `}function ln(t,e,o,n){const i=JSON.stringify(n??{},null,2),r=null!=e?JSON.stringify(e,null,2):"";return`\n    <div style="margin-top: 8px;">\n      <span style="font-weight: bold; cursor: pointer;">${t}</span>\n\n      ${null==e?`<button onclick="window.copyDefaultToTextarea(this)" data-defaults="${i.replace(/"/g,"&quot;")}" style="margin-bottom: 8px;">Copy defaults to override</button>`:""}\n\n      <textarea\n        data-config-path="${o}"\n        data-is-json="true"\n        oninput="window.wwaiProductGroupConfigOnChangeHandler(this)"\n        style="width: 100%; min-height: 140px; font-family: monospace; font-size: 13px;"\n      >${r}</textarea>\n    </div>\n  `}function cn(t,e){const o=Qo(Zo(t,zo),"Variant Dispatch config"),n=function(t,e){return en(t,zo,e).join("")}(t,e);return o+n}function dn(t,e,o){const n=t.map((([t,n])=>`\n    <details style="margin-bottom: 12px; border: 1px solid #ccc; border-radius: 6px; padding: 8px;">\n      <summary style="cursor: pointer; font-weight: bold;">\n        Product Group: <code>${t}</code>\n      </summary>\n      ${function(t,e,o,n){const i=`group-${o.replace(/[^a-zA-Z0-9]/g,"-")}`;return`\n        <div style="margin-top: 12px; padding: 8px; border: 1px dashed #ccc; border-radius: 4px;">\n            <div style="font-weight: bold; margin-bottom: 12px;">Product Group: <code>${t}</code></div>\n            \n            <div style="border-bottom: 1px solid #ddd; margin-bottom: 12px;">\n                <button class="tab-button active" onclick="window.switchTabForProductGroupConfig('${i}', 'variant-dispatch')" data-tab="variant-dispatch" style="background: #0070f3; color: white; border: none; padding: 8px 16px; margin-right: 4px; border-radius: 4px 4px 0 0; cursor: pointer;">Variant Dispatch</button>\n                <button class="tab-button" onclick="window.switchTabForProductGroupConfig('${i}', 'pricing')" data-tab="pricing" style="background: #f0f0f0; color: #333; border: none; padding: 8px 16px; margin-right: 4px; border-radius: 4px 4px 0 0; cursor: pointer;">Pricing</button>\n                <button class="tab-button" onclick="window.switchTabForProductGroupConfig('${i}', 'ux')" data-tab="ux" style="background: #f0f0f0; color: #333; border: none; padding: 8px 16px; margin-right: 4px; border-radius: 4px 4px 0 0; cursor: pointer;">UX</button>\n                <button class="tab-button" onclick="window.switchTabForProductGroupConfig('${i}', 'flow')" data-tab="flow" style="background: #f0f0f0; color: #333; border: none; padding: 8px 16px; margin-right: 4px; border-radius: 4px 4px 0 0; cursor: pointer;">Flow</button>\n            </div>\n            \n            <div id="${i}-variant-dispatch" class="tab-content" style="display: block;">\n                ${cn(e.variantDispatchConfig,o+".variantDispatchConfig")}\n            </div>\n\n            <div id="${i}-pricing" class="tab-content" style="display: none;">\n                ${ln("pricingConfig",e.pricingConfig,o+".pricingConfig",n.pricingConfig)}\n            </div>\n            \n            <div id="${i}-ux" class="tab-content" style="display: none;">\n                ${ln("uxConfig",e.uxConfig,o+".uxConfig",n.uxConfig)}\n            </div>\n            \n            <div id="${i}-flow" class="tab-content" style="display: none;">\n                ${ln("flowConfig",e.flowConfig,o+".flowConfig",n.flowConfig)}\n            </div>\n        </div>\n    `}(t,n,`${e}.${t}`,o)}\n    </details>\n    `)).join("");return`\n    <div style="margin-top: 16px;">\n      <strong>Product Groups</strong>\n      ${n||'<p style="color: #888;">No product group overrides defined.</p>'}\n    </div>\n  `}function un(t={}){const e=function(t){return new Set([...Object.keys(t||{})])}(t);return[...e].map(((e,o)=>function(t,e,o,n){const i=e.defaults||{},r=Object.entries(e).filter((([t])=>"defaults"!==t));return`\n      <details style="margin-bottom: 16px; border: 1px solid #eee; padding: 12px; border-radius: 6px;">\n        <summary style="cursor: pointer; font-weight: bold; font-size: 15px;">\n          ${function(t,e){return`\n    <div style="display: flex; align-items: center; flex-wrap: wrap; gap: 8px; font-family: 'Inter', sans-serif;">\n      <span style="background-color: #0070f3; color: white; padding: 4px 8px; border-radius: 999px; font-size: 12px; font-weight: 500;">\n        #${e}\n      </span>\n      <code style="background-color: #f5f5f5; padding: 2px 6px; border-radius: 4px; font-size: 13px; font-family: monospace;">\n        ${t}\n      </code>\n      ${function(t){return`\n      <button \n        onclick="window.scrollToSection('${t}')" \n        style="\n          margin-left: 8px; \n          padding: 2px 6px; \n          font-size: 10px; \n          background-color: #0070f3; \n          color: white; \n          border: none; \n          border-radius: 3px; \n          cursor: pointer;\n          vertical-align: middle;\n        "\n        title="Go to section on page"\n      >\n        Go\n      </button>\n    `}(t)}\n    </div>\n  `}(t,o)}\n        </summary>\n        ${an(t,i,n+".defaults")}\n        ${dn(r,t,i)}\n      </details>\n    `}(e,t[e]||{},o+1,e))).join("\n")}function pn(t={}){return window.wwaiConfigSnapshots=window.wwaiConfigSnapshots||{},window.wwaiConfigSnapshots["grouped-section-config"]=structuredClone(t),`<div id="tab-content-group" class="wwai-tab-content" style="display: none;">\n      <div style="margin-bottom: 20px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">\n        <div style="font-weight: bold; margin-bottom: 12px; color: #495057;">Configuration Actions</div>\n        <div style="display: flex; gap: 8px; flex-wrap: wrap;">\n          <button onclick="console.log('üìä Current Config:', window.wwaiConfigPanelGetGroupedSectionConfig())" \n                  style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n            Log Config\n          </button>\n          <button onclick="window.wwaiSaveGroupedSectionConfig()" \n                  style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n            Save Changes\n          </button>\n          <button onclick="console.log('üîç Changes Diff:', window.wwaiDiffGroupedSectionConfig())" \n                  style="background: #ffc107; color: #212529; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n            Show Diff\n          </button>\n        </div>\n      </div>\n      ${un(t)}\n    </div>`}function gn(t){const e=JSON.stringify(t,null,2);return window.wwaiConfigSnapshots=window.wwaiConfigSnapshots||{},window.wwaiConfigSnapshots["labeled-images"]=structuredClone(t),`\n        <div id="tab-content-images" class="wwai-tab-content" style="display: none;">\n        <button onclick="window.wwaiConfigPanelGetLabeledImagesConfig()">Log Config</button>\n        <button onclick="window.wwaiDiffLabeledImagesConfig()">Diff</button>\n        <button onclick="window.wwaiSaveLabeledImagesConfig()">Save Config</button>\n        <div style="margin: 20px 0;">\n            <label for="wwai-labeled-images-textarea" style="display: block; margin-bottom: 10px; font-weight: bold;">Labeled Images Configuration (JSON):</label>\n            <textarea \n                id="wwai-labeled-images-textarea" \n                style="width: 100%; height: 400px; font-family: monospace; padding: 10px; border: 1px solid #ccc; border-radius: 4px;"\n                placeholder="Enter labeled images configuration as JSON..."\n            >${e}</textarea>\n        </div>\n        </div>\n    `}function fn(t,e,o,n){const i=Object.entries(t),r=i.map((([t,i])=>function(t,e,o){return`\n        <div style="margin-top: 8px; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; background: #fafafa;">\n            <div style="font-weight: bold; margin-bottom: 8px; color: #333;">\n                Configuration for: <code>${t}</code>\n            </div>\n            <textarea \n                data-config-path="${o}"\n                data-is-json="true"\n                oninput="window.wwaiVariantOverridesConfigOnChangeHandler(this)"\n                style="width: 100%; min-height: 120px; font-family: monospace; font-size: 12px; padding: 8px; border: 1px solid #ccc; border-radius: 4px;"\n                placeholder="Enter variant override configuration as JSON..."\n            >${JSON.stringify(e,null,2)}</textarea>\n        </div>\n    `}(t,i,`${e}.${o}.${n}.${t}`))).join("");return`\n        <details style="margin-bottom: 12px; border: 1px solid #e0e0e0; border-radius: 6px; padding: 8px;">\n            <summary style="cursor: pointer; font-weight: bold; color: #666;">\n                Variants (${i.length})\n            </summary>\n            <div style="margin-top: 12px;">\n                ${r||'<p style="color: #888; font-style: italic;">No product label configurations defined.</p>'}\n            </div>\n        </details>\n    `}function hn(t,e,o){const n=Object.entries(e).map((([e,o])=>function(t,e,o){const n=Object.entries(e).map((([e,n])=>fn(n,o,t,e))).join("");return`\n        <details style="margin-bottom: 12px; border: 1px solid #ddd; border-radius: 6px; padding: 8px;">\n            <summary style="cursor: pointer; font-weight: bold; color: #555;">\n                Product Group: <code>${t}</code>\n            </summary>\n            <div style="margin-top: 12px;">\n                ${n||'<p style="color: #888; font-style: italic;">No product label overrides defined.</p>'}\n            </div>\n        </details>\n    `}(e,o,t))).join("");return`\n        <details style="margin-bottom: 16px; border: 1px solid #eee; padding: 12px; border-radius: 6px;">\n            <summary style="cursor: pointer; font-weight: bold; font-size: 15px;">\n                <div style="display: flex; align-items: center; gap: 8px;">\n                    <span style="background-color: #0070f3; color: white; padding: 4px 8px; border-radius: 999px; font-size: 12px; font-weight: 500;">\n                        #${o}\n                    </span>\n                    <code style="background-color: #f5f5f5; padding: 2px 6px; border-radius: 4px; font-size: 13px; font-family: monospace;">\n                        ${t}\n                    </code>\n                </div>\n            </summary>\n            <div style="margin-top: 12px;">\n                ${n||'<p style="color: #888; font-style: italic;">No product group overrides defined for this section.</p>'}\n            </div>\n        </details>\n    `}function bn(t){return window.wwaiConfigSnapshots=window.wwaiConfigSnapshots||{},window.wwaiConfigSnapshots["variant-overrides"]=structuredClone(t),`\n        <div id="tab-content-variant_overrides" class="wwai-tab-content" style="display: none;">\n            <div style="margin-bottom: 20px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">\n                <div style="font-weight: bold; margin-bottom: 12px; color: #495057;">Configuration Actions</div>\n                <div style="display: flex; gap: 8px; flex-wrap: wrap;">\n                    <button onclick="window.wwaiConfigPanelLogVariantOverridesConfig()" \n                            style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n                        Log Config\n                    </button>\n                    <button onclick="window.wwaiDiffVariantOverridesConfig()" \n                            style="background: #ffc107; color: #212529; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n                        Show Diff\n                    </button>\n                    <button onclick="window.wwaiSaveVariantOverridesConfig()" \n                            style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n                        Save Changes\n                    </button>\n                </div>\n            </div>\n            <div style="margin-top: 16px;">\n                ${function(t={}){const e=Object.entries(t);return 0===e.length?'<p style="color: #888; font-style: italic; text-align: center; padding: 20px;">No variant overrides configured.</p>':e.map((([t,e],o)=>hn(t,e,o+1))).join("")}(t)}\n            </div>\n        </div>\n    `}function mn(){const t={groupedSectionConfig:window.wwaiConfigPanelGetGroupedSectionConfig(),productMappingConfig:window.wwaiConfigPanelGetProductMappingConfig(),labeledImagesConfig:window.wwaiConfigPanelGetLabeledImagesConfig(),variantOverridesConfig:window.wwaiConfigPanelGetVariantOverridesConfig(),generalConfig:window.wwaiConfigPanelGetGeneralConfig()};return{JS_PRODUCT_MAPPING_OBJECT:t.productMappingConfig,WWAI_PRODUCT_GROUP_CONFIG:t.groupedSectionConfig,WWAI_PRODUCT_VARIANT_OVERRIDES:t.variantOverridesConfig,WWAI_LABELED_IMAGES:t.labeledImagesConfig,...t.generalConfig}}function wn(){return{groupedSectionConfig:window.wwaiDiffGroupedSectionConfig(),productMappingConfig:window.wwaiDiffProductMappingConfig(),labeledImagesConfig:window.wwaiDiffLabeledImagesConfig(),variantOverridesConfig:window.wwaiDiffVariantOverridesConfig(),generalConfig:window.wwaiDiffGeneralConfig()}}function _n(){window.wwaiSaveGroupedSectionConfig(),window.wwaiSaveProductMappingConfig(),window.wwaiSaveLabeledImagesConfig(),window.wwaiSaveVariantOverridesConfig(),window.wwaiSaveGeneralConfig();const t=mn();return window.__WWAI__=t,No(),Lo(),!0}function yn(t){const e=Object.entries(t),o=e.some((([t,e])=>e&&Object.keys(e).length>0)),n=o?e.map((([t,e])=>{if(!e||0===Object.keys(e).length)return"";const o=Object.entries(e).map((([t,e])=>{const{before:o,after:n}=e;let i="";if(void 0===o&&void 0!==n)i=`Added: ${JSON.stringify(n,null,2)}`;else if(void 0!==o&&void 0===n)i=`Removed: ${JSON.stringify(o,null,2)}`;else{if(JSON.stringify(o)===JSON.stringify(n))return"";i=`Modified: ${JSON.stringify(o,null,2)} => ${JSON.stringify(n,null,2)}`}return`\n            <div style="margin-bottom: 8px; padding: 8px; border-radius: 4px; background-color: #f8f9fa; border-left: 3px solid #0070f3;">\n                <strong style="color: #0070f3;">${t}</strong>\n                <div style="margin-top: 4px; font-family: monospace; font-size: 11px; color: #666;">\n                ${i}\n                </div>\n            </div>\n            `})).filter((t=>""!==t)).join("");return""===o?"":`\n        <div style="margin-bottom: 16px; border: 1px solid #e0e0e0; border-radius: 6px; padding: 12px;">\n            <h4 style="margin: 0 0 12px 0; color: #333; font-size: 14px; font-weight: bold;">\n                ${function(t){return{groupedSectionConfig:"Group & Variant Config",productMappingConfig:"Product Mapping",labeledImagesConfig:"Labeled Images",variantOverridesConfig:"Variant Overrides",generalConfig:"General Config"}[t]||t}(t)}\n            </h4>\n            ${o}\n        </div>\n        `})).filter((t=>""!==t)).join(""):'<p style="color: #666; text-align: center; padding: 20px;">No changes detected - configs are identical</p>';return`\n        <div id="wwai-diff-modal" style="\n        position: fixed; \n        top: 50%; \n        left: 50%; \n        transform: translate(-50%, -50%); \n        background: white; \n        border: 1px solid #ddd; \n        border-radius: 8px; \n        padding: 20px; \n        width: 800px; \n        max-height: 80vh; \n        overflow-y: auto; \n        z-index: 10003;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n        ">\n        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">\n            <h3 style="margin: 0;">Config Management</h3>\n            <button id="wwai-close-diff" style="background: none; border: none; font-size: 18px; cursor: pointer; padding: 4px;">&times;</button>\n        </div>\n        \n        \x3c!-- Tab Navigation --\x3e\n        <div style="display: flex; gap: 4px; border-bottom: 1px solid #eee; padding: 8px 0; margin-bottom: 16px;">\n            <button id="wwai-tab-diff" class="wwai-modal-tab-btn active" style="background: #0070f3; color: white; border: none; padding: 8px 16px; border-radius: 4px 4px 0 0; cursor: pointer; font-size: 13px;">Diff & Save</button>\n            <button id="wwai-tab-config" class="wwai-modal-tab-btn" style="background: #f0f0f0; color: #333; border: none; padding: 8px 16px; border-radius: 4px 4px 0 0; cursor: pointer; font-size: 13px;">Config String</button>\n        </div>\n        \n        \x3c!-- Diff Tab Content --\x3e\n        <div id="wwai-tab-content-diff" class="wwai-modal-tab-content">\n            <div style="margin-bottom: 16px;">\n                <strong>Total Changes: ${e.reduce(((t,[e,o])=>o?t+Object.keys(o).length:t),0)}</strong>\n            </div>\n            \n            <div style="margin-bottom: 20px; max-height: 400px; overflow-y: auto;">\n                ${n}\n            </div>\n            \n            <div style="display: flex; gap: 8px; justify-content: flex-end;">\n                <button id="wwai-cancel-diff" style="padding: 8px 16px; background-color: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer;">Close</button>\n                ${o?'<button id="wwai-confirm-diff" style="padding: 8px 16px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">Apply Changes</button>':""}\n            </div>\n        </div>\n        \n        \x3c!-- Config String Tab Content --\x3e\n        <div id="wwai-tab-content-config" class="wwai-modal-tab-content" style="display: none;">\n            <div style="margin-bottom: 16px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">\n                <div style="font-weight: bold; margin-bottom: 12px; color: #495057;">Config String Actions</div>\n                <div style="display: flex; gap: 8px; flex-wrap: wrap;">\n                    <button id="wwai-copy-config-string" \n                            style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n                        Copy to Clipboard\n                    </button>\n                    <button id="wwai-log-config-string" \n                            style="background: #ffc107; color: #212529; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 13px;">\n                        Log to Console\n                    </button>\n                </div>\n            </div>\n            \n            <div style="margin-top: 16px;">\n                <label for="wwai-config-string-textarea" style="display: block; margin-bottom: 10px; font-weight: bold;">Current Config String:</label>\n                <textarea \n                    id="wwai-config-string-textarea" \n                    style="width: 100%; height: 400px; font-family: monospace; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 11px;"\n                    readonly\n                >${function(){const t=mn(),e=window.wwaiConfigPanelGetGeneralConfig?window.wwaiConfigPanelGetGeneralConfig():{},o={useMockSubscription:"Use metafield-based subscription in sandbox/local",deployMode:'Options: "local" | "sandbox" | "prod"',MODE:"Enables dev/debugger mode, values are dev, prod",RENDER_WITH_LIQUID:"Controls Liquid-product rendering",CONNECTOR_TYPE:"Which connector to use for hydration",heightEqualizeLogging:"Enable logging for grid height debugging",CURRENCY:"Active currency from Shopify",CURRENCY_FACTOR:"Currency conversion factor"},n=["useMockSubscription","deployMode","MODE","RENDER_WITH_LIQUID","CONNECTOR_TYPE","heightEqualizeLogging","CURRENCY","CURRENCY_FACTOR"].map((n=>{let i;return"CURRENCY"===n?i="Shopify.currency.active":(i=e[n]??t[n],i=JSON.stringify(i)),`// ${o[n]}\nwindow.__WWAI__.${n} = ${i};`}));return`window.__WWAI__ = window.__WWAI__ || {};\n    \n// Environment + Mode Config\n${n.slice(0,6).join("\n\n")}\n\n// Currency Config\n${n.slice(6).join("\n\n")}\n\n// Product mapping object\nwindow.__WWAI__.JS_PRODUCT_MAPPING_OBJECT = ${JSON.stringify(t.JS_PRODUCT_MAPPING_OBJECT,null,2)};\n\n// Product group config\nwindow.__WWAI__.WWAI_PRODUCT_GROUP_CONFIG = ${JSON.stringify(t.WWAI_PRODUCT_GROUP_CONFIG,null,2)};\n\n// Variant overrides\nwindow.__WWAI__.WWAI_PRODUCT_VARIANT_OVERRIDES = ${JSON.stringify(t.WWAI_PRODUCT_VARIANT_OVERRIDES,null,2)};\n\n// Labeled images\nwindow.__WWAI__.WWAI_LABELED_IMAGES = ${JSON.stringify(t.WWAI_LABELED_IMAGES,null,2)};\n\n// Action buttons\nwindow.__WWAI__.WWAI_ACTION_BUTTONS = ${JSON.stringify(window.__WWAI__.WWAI_ACTION_BUTTONS,null,2)};\n`}()}</textarea>\n            </div>\n        </div>\n        </div>\n        <div id="wwai-diff-overlay" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 10002;"></div>\n    `}function vn(t,e){const o=yn(t);document.body.insertAdjacentHTML("beforeend",o);const n=document.getElementById("wwai-diff-modal"),i=document.getElementById("wwai-diff-overlay");!function(){const t=document.querySelectorAll(".wwai-modal-tab-btn"),e=document.querySelectorAll(".wwai-modal-tab-content");t.forEach((o=>{o.onclick=()=>{const n=o.getAttribute("id").replace("wwai-tab-","");t.forEach((t=>{t.style.background="#f0f0f0",t.style.color="#333"})),o.style.background="#0070f3",o.style.color="white",e.forEach((t=>{t.style.display=t.id===`wwai-tab-content-${n}`?"block":"none"}))}}))}();const r=()=>{n&&n.remove(),i&&i.remove()},s=document.getElementById("wwai-close-diff");s&&(s.onclick=r);const a=document.getElementById("wwai-cancel-diff");a&&(a.onclick=r);const l=document.getElementById("wwai-confirm-diff");l&&(l.onclick=()=>{if(e()){r();const t=document.querySelector("#wwai-save-status");t&&(t.textContent="‚úÖ Applied successfully!",t.style.color="#28a745",setTimeout((()=>{t.textContent=""}),3e3))}});const c=document.getElementById("wwai-copy-config-string");c&&(c.onclick=()=>{const t=document.getElementById("wwai-config-string-textarea");if(t){t.select(),t.setSelectionRange(0,99999);try{document.execCommand("copy"),console.log("‚úÖ Config string copied to clipboard");const t=c.textContent;c.textContent="Copied!",c.style.background="#28a745",setTimeout((()=>{c.textContent=t,c.style.background="#007bff"}),2e3)}catch(t){console.error("‚ùå Failed to copy to clipboard:",t)}}});const d=document.getElementById("wwai-log-config-string");d&&(d.onclick=()=>{const t=document.getElementById("wwai-config-string-textarea");t&&console.log("üìã Current Config String:",t.value)}),i&&(i.onclick=r);const u=t=>{"Escape"===t.key&&(r(),document.removeEventListener("keydown",u))};document.addEventListener("keydown",u)}function Cn(){console.log("üîÑ Printing all selectors grouped by section ID and product group...");const t={...o.PRODUCT_GROUP,...o.OTHER};console.log("üìã All available selectors:",t);const e={};Object.entries(t).forEach((([t,o])=>{const n=document.querySelectorAll(o);0===n.length||n.forEach(((o,n)=>{const i=o.sectionId,r=o.productGroup;i&&r&&(e[i]||(e[i]={}),e[i][r]||(e[i][r]={selectors:[],count:0}),e[i][r].selectors.includes(t)||(e[i][r].selectors.push(t),e[i][r].count++))}))})),console.log("\nDEBUG_SELECTORS: GROUPED RESULTS BY SECTION ID AND PRODUCT GROUP:"),console.log("=".repeat(80)),0===Object.keys(e).length?console.log("DEBUG_SELECTORS: No elements found with section_id and product_group"):Object.entries(e).forEach((([t,e])=>{console.group(`DEBUG_SELECTORS: SECTION ID: ${t}`),Object.entries(e).forEach((([t,e])=>{console.group(`DEBUG_SELECTORS: PRODUCT GROUP: ${t} | Total Selectors: ${e.count}`),console.log(`DEBUG_SELECTORS: Selector Names: ${e.selectors.join(", ")}`);const n=function(t){const e=document.querySelectorAll(o.PRODUCT_GROUP.VARIANT);for(const o of e)if(o.productGroup===t)try{let e=null,n=null,i=null,r=null,s=null;try{let{productLabel:e,variantOptions:n}=o.getSelectedVariant();i=vt(t,e),r=It(t,e,n?.option1,n?.option2,n?.option3)}catch(e){console.log(`DEBUG_SELECTORS: Error getting variant for ${t}:`,e)}return s=o.inputs,{productLabel:e,variantOptions:n,product:i,product_variant:r,inputs:s,hasVariantData:!0}}catch(e){return console.log(`DEBUG_SELECTORS: Error getting variant for ${t}:`,e),{productLabel:null,variantOptions:null,product:null,product_variant:null,inputs:null,hasVariantData:!1,error:e.message}}return{productLabel:null,variantOptions:null,hasVariantData:!1,error:"No variant selector found for this product group"}}(t);console.log("DEBUG_SELECTORS: Variant Info:",n),console.groupEnd()})),console.groupEnd()}))}function On(){function t(t){t.querySelector("#wwai-close-btn").onclick=()=>t.remove(),function(t){const e=t.querySelectorAll(".wwai-tab-btn"),o=t.querySelectorAll(".wwai-tab-content");e.forEach((t=>{t.onclick=()=>{const n=t.getAttribute("data-tab");o.forEach((t=>{t.style.display=t.id===`tab-content-${n}`?"block":"none"})),e.forEach((t=>t.classList.remove("active-tab"))),t.classList.add("active-tab")}})),e[0].click()}(t),function(t,e,o,n){const i=t.querySelector("#wwai-save-btn"),r=t.querySelector("#wwai-save-status");i.onclick=()=>{r.textContent="Analyzing changes...",r.style.color="#0070f3";try{const t=window.__WWAI__||{},i=n();console.log("Old config:",t),console.log("New config:",i);const s=o();console.log("Diff result:",s),r.textContent="",vn(s,e)}catch(t){console.error("Error analyzing config:",t),r.textContent="‚ùå Error: "+t.message,r.style.color="#dc3545"}}}(t,_n,wn,mn);const o=t.querySelector("#wwai-button-highlight-toggle"),n=t.querySelector("#wwai-highlight-status");o&&n&&(o.checked=!!window.wwaiIsButtonHighlightingActive&&window.wwaiIsButtonHighlightingActive(),e(n,o.checked),o.addEventListener("change",(t=>{const o=t.target.checked;window.wwaiToggleButtonHighlighting&&(window.wwaiToggleButtonHighlighting(o),e(n,o))})))}function e(t,e){t&&(t.textContent=e?"üü¢ Active":"‚ö™ Inactive",t.style.color=e?"#28a745":"#666")}function o(){if(document.getElementById("wwai-config-side-panel"))return;const e=document.createElement("div");e.id="wwai-config-side-panel",Object.assign(e.style,{position:"fixed",top:"0",right:"0",width:"480px",height:"100vh",backgroundColor:"#fff",boxShadow:"-2px 0 8px rgba(0, 0, 0, 0.1)",zIndex:"10002",padding:"0",fontFamily:"sans-serif",fontSize:"14px",color:"#333",borderLeft:"1px solid #e0e0e0",display:"flex",flexDirection:"column"});const o=function(){const{JS_PRODUCT_MAPPING_OBJECT:t,WWAI_PRODUCT_GROUP_CONFIG:e,WWAI_PRODUCT_VARIANT_OVERRIDES:o,WWAI_LABELED_IMAGES:n,...i}=R()||{};return{JS_PRODUCT_MAPPING_OBJECT:t,WWAI_PRODUCT_GROUP_CONFIG:e,WWAI_PRODUCT_VARIANT_OVERRIDES:o,WWAI_LABELED_IMAGES:n,filteredConfig:i}}();e.innerHTML=function(t){const e=[(n=t.filteredConfig,`\n        <div id="tab-content-general" class="wwai-tab-content" style="display: none;">\n            <button onclick="window.wwaiConfigPanelGetGeneralConfig()">Log Config</button>\n            <button onclick="window.wwaiDiffGeneralConfig()"> Diff</button>\n            <button onclick="window.wwaiSaveGeneralConfig()">Save Config</button>\n        ${Go(n,"No general config data available.","general-config")}\n        </div>\n    `),(o=t.JS_PRODUCT_MAPPING_OBJECT,`\n        <div id="tab-content-mapping" class="wwai-tab-content" style="display: none;">\n        <button onclick="window.wwaiConfigPanelGetProductMappingConfig()">Log Config</button>\n        <button onclick="window.wwaiDiffProductMappingConfig()">Diff</button>\n        <button onclick="window.wwaiSaveProductMappingConfig()">Save Config</button>\n        ${Go(o,"No product mapping data available.","product-mapping")}\n        </div>\n    `),pn(t.WWAI_PRODUCT_GROUP_CONFIG),gn(t.WWAI_LABELED_IMAGES),bn(t.WWAI_PRODUCT_VARIANT_OVERRIDES)].join("");var o,n;return`\n        \n      <div style="padding: 16px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee;">\n        <strong>WWAI Config Panel</strong>\n        <button id="wwai-close-btn" style="background: none; border: none; font-size: 18px; cursor: pointer;">&times;</button>\n      </div>\n    \n        \n        <div style="display: flex; gap: 4px; border-bottom: 1px solid #eee; padding: 8px 16px;">\n        ${[{id:"general",label:"General Config"},{id:"mapping",label:"Product Mapping"},{id:"group",label:"Group + Variant Config"},{id:"images",label:"Labeled Images"},{id:"variant_overrides",label:"Variant Overrides"}].map((t=>`<button data-tab="${t.id}" class="wwai-tab-btn">${t.label}</button>`)).join("")}\n        </div>\n    \n        <div id="wwai-tab-container" style="flex: 1; padding: 16px; overflow-y: auto;">\n        ${e}\n        </div>\n        \n        <div style="padding: 16px; border-top: 1px solid #eee;">\n            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">\n                <div style="display: flex; align-items: center; gap: 8px;">\n                    <label style="font-size: 14px; font-weight: 500; cursor: pointer;">\n                        <input type="checkbox" id="wwai-button-highlight-toggle" style="margin-right: 6px;">\n                        Button Highlighting\n                    </label>\n                </div>\n                <span id="wwai-highlight-status" style="font-size: 12px; color: #666;"></span>\n            </div>\n            <button id="wwai-save-btn" style="padding: 8px 12px; background-color: #0070f3; color: white; border: none; border-radius: 4px; cursor: pointer;">Preview Changes</button>\n            <span id="wwai-save-status" style="margin-left: 10px; font-size: 12px; color: #666;"></span>\n        </div>\n    \n    `}(o),t(e),document.body.appendChild(e)}if(!document.getElementById("wwai-toggle-panel-button")){const t=function(){const t=document.createElement("button");return t.id="wwai-toggle-panel-button",t.innerText="Config",Object.assign(t.style,{position:"fixed",bottom:"20px",right:"20px",zIndex:"10001",padding:"10px 14px",backgroundColor:"#333",color:"#fff",border:"none",borderRadius:"6px",cursor:"pointer",boxShadow:"0 2px 6px rgba(0,0,0,0.15)",fontSize:"14px",fontFamily:"sans-serif"}),t}();t.onclick=()=>o(),document.body.appendChild(t)}if(!document.getElementById("wwai-bottom-left-button")){const t=function(){const t=document.createElement("button");return t.textContent="Debug Button",t.style.cssText="\n      position: fixed;\n      bottom: 20px;\n      left: 20px;\n      z-index: 10000;\n      padding: 10px 15px;\n      background-color: #007bff;\n      color: white;\n      border: none;\n      border-radius: 5px;\n      cursor: pointer;\n      font-size: 14px;\n      box-shadow: 0 2px 5px rgba(0,0,0,0.2);\n    ",t.onclick=()=>{Cn()},t}();t.id="wwai-bottom-left-button",document.body.appendChild(t)}}function An(){const t=window.__WWAI__?.WWAI_ACTION_BUTTONS||{};let e=!0;"prod"===window.__WWAI__.deployMode&&(e=!1);const o=e?t:function(t){const e=t=>t.replace(/\/\/div\[@id="shopify-section-template--\d+__([^"]+)"\]/g,((t,e)=>`//div[@id="shopify-section-template--${e}"]`)),o={};for(const[n,i]of Object.entries(t)){const t=e(n),r="scroll-to"===i.actionType&&"string"==typeof i.value?i.value.replace(/shopify-section-template--\d+__/,"shopify-section-template--"):i.value;o[t]={actionType:i.actionType,value:r}}return o}(t);console.log("ACTION_BUTTONS: Applying actions:",o);Object.entries(o).forEach((([t,{actionType:e,value:o}])=>{const n=(t=>{try{return document.evaluate(t,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}catch(e){return console.warn("ACTION_BUTTONS: Invalid XPath:",t),null}})(t);if(!n)return void console.log("ACTION_BUTTONS: No element found for xpath:",t);const i=()=>!0===window.wwaiIsButtonHighlightingActive?.();i()?console.log("ACTION_BUTTONS: Skipping action:",e,o):(console.log("ACTION_BUTTONS: Applying action:",e,o),"no-action"===e?(n.setAttribute("href","javascript:void(0)"),n.onclick=t=>{i()||t.preventDefault()}):"custom-url"===e?(n.setAttribute("href",o),n.onclick=t=>{i()}):"scroll-to"===e&&(n.setAttribute("href","javascript:void(0)"),n.onclick=t=>{if(i())return;t.preventDefault();const e=document.getElementById(o);e&&e.scrollIntoView({behavior:"smooth"})}))}))}window.showConfigTab=function(t,e,o){["pricing","ux","flow"].forEach((n=>{const i=document.getElementById(`tab-${t}-${e}-${n}`);i&&(i.style.display=n===o?"block":"none")}))},window.copyDefaultToTextarea=function(t){const e=t.nextElementSibling,o=t.getAttribute("data-defaults");o&&(e.value=o,e.dispatchEvent(new Event("input",{bubbles:!0})),t.remove())},window.switchTabForProductGroupConfig=function(t,e){document.querySelectorAll(`[id^="${t}-"]`).forEach((t=>{t.style.display="none"}));const o=document.getElementById(`${t}-${e}`);o&&(o.style.display="block");document.querySelectorAll(`[onclick*="${t}"]`).forEach((t=>{t.getAttribute("data-tab")===e?(t.style.background="#0070f3",t.style.color="white"):(t.style.background="#f0f0f0",t.style.color="#333")}))},window._wwaiProductGroupConfigChanges={},window.wwaiProductGroupChangeHandler=function(t,e){window._wwaiProductGroupConfigChanges[t]=e,console.log("[ChangeTracker]",t,"=>",e)},window.wwaiProductGroupConfigOnChangeHandler=function(t){const e=t.getAttribute("data-config-path"),o="true"===t.getAttribute("data-is-array"),n="true"===t.getAttribute("data-is-json"),i="true"===t.getAttribute("data-allow-null"),r=t.value;if(i&&""===r)return window.wwaiProductGroupChangeHandler(e,null);let s;try{s=n?JSON.parse(r):o?r.split(",").map((t=>t.trim())):""!==r.trim()&&!isNaN(r)&&Number.isInteger(Number(r))?Number(r):r,window.wwaiProductGroupChangeHandler(e,s)}catch(t){console.warn("Parsing failed for",e,t)}},window.wwaiDiffGroupedSectionConfig=function(){const t="grouped-section-config",e=window.wwaiConfigSnapshots?.[t],o=window._wwaiProductGroupConfigChanges||{};if(!e)return console.warn("No snapshot found for",t),{};const n={};return Object.entries(o).forEach((([t,o])=>{let i=null;try{const o=t.split(".");let n=e;for(let t=0;t<o.length;t++){if(!n||"object"!=typeof n||!(o[t]in n)){n=void 0;break}n=n[o[t]]}i=n}catch(e){console.warn("Could not get original value for path:",t)}i!==o&&(n[t]={before:i,after:o})})),n},window.wwaiConfigPanelGetGroupedSectionConfig=function(){const t="grouped-section-config",e=window.wwaiConfigSnapshots?.[t],o=window._wwaiProductGroupConfigChanges||{};if(!e)return console.warn("No snapshot found for",t),{};const n=structuredClone(e);return Object.entries(o).forEach((([t,e])=>{try{const o=t.split(".");let i=n;for(let t=0;t<o.length-1;t++){const e=o[t];e in i||(i[e]={}),i=i[e]}i[o[o.length-1]]=e,console.log(`Applied change: ${t} =`,e)}catch(e){console.error(`Failed to apply change for path: ${t}`,e)}})),n},window.wwaiSaveGroupedSectionConfig=function(){const t="grouped-section-config",e=window.wwaiConfigPanelGetGroupedSectionConfig();window.wwaiConfigSnapshots[t]=structuredClone(e),window._wwaiProductGroupConfigChanges={},console.log("‚úÖ Saved grouped section config changes to snapshot"),console.log("üìä Updated snapshot:",window.wwaiConfigSnapshots[t])},window.wwaiConfigPanelGetLabeledImagesConfig=function(){const t=document.getElementById("wwai-labeled-images-textarea");if(!t)return console.error("‚ùå Labeled images textarea not found"),{};try{const e=JSON.parse(t.value);return console.log("üñºÔ∏è Updated Labeled Images Config:",e),e}catch(t){console.error("‚ùå Invalid JSON in labeled images textarea:",t)}return{}},window.wwaiDiffLabeledImagesConfig=function(){const t=document.getElementById("wwai-labeled-images-textarea");if(t)try{const e=JSON.parse(t.value),o=window.wwaiConfigSnapshots?.["labeled-images"]||{};if(JSON.stringify(o)!==JSON.stringify(e)){const t={images:{before:o,after:e}};return console.log("ü™Ñ Labeled Images Diff:",t),t}return console.log("ü™Ñ No changes in labeled images"),{}}catch(t){console.error("‚ùå Invalid JSON in labeled images textarea:",t)}else console.error("‚ùå Labeled images textarea not found")},window.wwaiSaveLabeledImagesConfig=function(){const t=document.getElementById("wwai-labeled-images-textarea");if(t)try{const e=JSON.parse(t.value);window.wwaiConfigSnapshots||(window.wwaiConfigSnapshots={}),window.wwaiConfigSnapshots["labeled-images"]=e,console.log("‚úÖ Saved updated config for snapshot: labeled-images",e)}catch(t){console.error("‚ùå Invalid JSON in labeled images textarea:",t)}else console.error("‚ùå Labeled images textarea not found")},window._wwaiVariantOverridesConfigChanges={},window.wwaiVariantOverridesConfigOnChangeHandler=function(t){const e=t.getAttribute("data-config-path"),o="true"===t.getAttribute("data-is-json"),n=t.value;let i;try{i=o?JSON.parse(n):n,window._wwaiVariantOverridesConfigChanges[e]=i,console.log("[VariantOverrides ChangeTracker]",e,"=>",i)}catch(t){console.warn("Parsing failed for",e,t)}},window.wwaiConfigPanelLogVariantOverridesConfig=function(){const t=window.wwaiConfigPanelGetVariantOverridesConfig();console.log("üéõÔ∏è Updated Variant Overrides Config:",t)},window.wwaiDiffVariantOverridesConfig=function(){const t="variant-overrides",e=window.wwaiConfigSnapshots?.[t],o=window._wwaiVariantOverridesConfigChanges||{};if(!e)return console.warn("No snapshot found for",t),{};const n={};return Object.entries(o).forEach((([t,o])=>{let i=null;try{const o=t.split(".");let n=e;for(let t=0;t<o.length;t++){if(!n||"object"!=typeof n||!(o[t]in n)){n=void 0;break}n=n[o[t]]}i=n}catch(e){console.warn("Could not get original value for path:",t)}JSON.stringify(i)!==JSON.stringify(o)&&(n[t]={before:i,after:o})})),Object.keys(n).length>0?console.log("ü™Ñ Variant Overrides Diff:",n):console.log("ü™Ñ No changes in variant overrides"),n},window.wwaiConfigPanelGetVariantOverridesConfig=function(){const t="variant-overrides",e=window.wwaiConfigSnapshots?.[t],o=window._wwaiVariantOverridesConfigChanges||{};if(!e)return console.warn("No snapshot found for",t),{};const n=structuredClone(e);return Object.entries(o).forEach((([t,e])=>{try{const o=t.split(".");let i=n;for(let t=0;t<o.length-1;t++){const e=o[t];e in i||(i[e]={}),i=i[e]}i[o[o.length-1]]=e,console.log(`Applied variant override change: ${t} =`,e)}catch(e){console.error(`Failed to apply change for path: ${t}`,e)}})),n},window.wwaiSaveVariantOverridesConfig=function(){const t="variant-overrides",e=window.wwaiConfigPanelGetVariantOverridesConfig();window.wwaiConfigSnapshots[t]=structuredClone(e),window._wwaiVariantOverridesConfigChanges={},console.log("‚úÖ Saved variant overrides config changes to snapshot"),console.log("üìä Updated snapshot:",window.wwaiConfigSnapshots[t])},(()=>{let t=!1,e=new Map;function o(){t||(window.wwaiHighlighter&&window.wwaiHighlighter.isActive&&window.wwaiHighlighter.isActive()?console.log("‚ö†Ô∏è Cannot enable button highlighting - highlighter is active"):(console.log("üîç Enabling button highlighting..."),t=!0,document.querySelectorAll("a").forEach((t=>{t.style.outline="2px solid red",t.style.backgroundColor="yellow"})),document.querySelectorAll("a").forEach((t=>{const o=e=>(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),function(t){window.__WWAI__=window.__WWAI__||{},window.__WWAI__.WWAI_ACTION_BUTTONS=window.__WWAI__.WWAI_ACTION_BUTTONS||{};const e=t.innerText.trim()||"(no text)",o=t.getAttribute("href")||"(no href)",n=function(t){let e=t.closest('div[id^="shopify-section-template--"], section[id^="shopify-section-template--"]');if(!e)return"(no Shopify section found)";const o=e.getAttribute("id"),n=[];let i=t;for(;i&&i!==e;){let t=1,e=i.previousSibling;for(;e;)1===e.nodeType&&e.nodeName===i.nodeName&&t++,e=e.previousSibling;n.unshift(`${i.nodeName.toLowerCase()}[${t}]`),i=i.parentNode}return`//div[@id="${o}"]//${n.join("/")}`}(t),i=window.__WWAI__.WWAI_ACTION_BUTTONS[n],r=document.createElement("div");r.className="wwai-modal-backdrop",Object.assign(r.style,{position:"fixed",inset:"0",backgroundColor:"rgba(0,0,0,0.4)",zIndex:9998});const s=document.createElement("div");s.className="wwai-action-modal",Object.assign(s.style,{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 5px 15px rgba(0,0,0,0.3)",zIndex:9999,width:"90%",maxWidth:"600px",fontFamily:"monospace",maxHeight:"80vh",overflowY:"auto"}),s.innerHTML=`\n            <h2 style="margin-top:0;">Link Action Configuration</h2>\n            <div style="margin-bottom: 15px;">\n                <strong>Text:</strong> ${e}<br>\n                <strong>Current Href:</strong> ${o}\n            </div>\n            \n            <div style="margin-bottom: 15px;">\n                <strong>XPath:</strong><br>\n                <code style="word-break: break-all; background: #f5f5f5; padding: 8px; display: block; margin: 5px 0;">${n}</code>\n                <button id="wwai-copy-xpath" style="margin-top: 5px; padding: 4px 8px; font-size: 12px;">Copy XPath</button>\n            </div>\n            \n            <div style="margin-bottom: 15px;">\n                <strong>Action Type:</strong>\n                <select id="wwai-action-type" style="width: 100%; padding: 6px; margin-top: 5px;">\n                    <option value="no-action">No Action (Prevent Default)</option>\n                    <option value="custom-url">Custom URL</option>\n                    <option value="scroll-to">Scroll to Element</option>\n                    <option value="console-log">Console Log</option>\n                    <option value="alert">Alert Message</option>\n                </select>\n            </div>\n            \n            <div id="wwai-action-input" style="margin-bottom: 15px;"></div>\n\n            <div style="display: flex; gap: 10px;">\n                <button id="wwai-apply-action" style="padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 4px;">Apply Action</button>\n                <button id="wwai-close-modal" style="padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 4px;">Close</button>\n            </div>\n        `;const a=s.querySelector("#wwai-action-input"),l=s.querySelector("#wwai-action-type"),c=()=>{a.innerHTML="";const t=l.value;if("custom-url"===t)a.innerHTML='\n                    <strong>Custom URL:</strong><br>\n                    <input id="wwai-custom-url" placeholder="https://example.com" style="width:100%; padding:6px; margin-top: 5px;">\n                ';else if("scroll-to"===t){const t=Array.from(document.querySelectorAll('[id^="shopify-section-template--"]')).map((t=>t.id));if(0===t.length)a.innerHTML='<p style="color: #666;">No matching Shopify section IDs found on this page.</p>';else{const e=t.map((t=>`<option value="${t}">${t}</option>`)).join("");a.innerHTML=`\n                        <strong>Scroll to Section:</strong><br>\n                        <select id="wwai-scroll-target" style="width:100%; padding:6px; margin-top: 5px;">\n                            ${e}\n                        </select>\n                    `}}else"console-log"===t?a.innerHTML='\n                    <strong>Console Message:</strong><br>\n                    <input id="wwai-console-message" placeholder="Message to log" style="width:100%; padding:6px; margin-top: 5px;">\n                ':"alert"===t&&(a.innerHTML='\n                    <strong>Alert Message:</strong><br>\n                    <input id="wwai-alert-message" placeholder="Message to show" style="width:100%; padding:6px; margin-top: 5px;">\n                ')};c(),l.addEventListener("change",c),i?.actionType&&(l.value=i.actionType,c());if(i?.value){setTimeout((()=>{const t=l.value;if("custom-url"===t){const t=s.querySelector("#wwai-custom-url");t&&(t.value=i.value)}else if("scroll-to"===t){const t=s.querySelector("#wwai-scroll-target");t&&(t.value=i.value)}else if("console-log"===t){const t=s.querySelector("#wwai-console-message");t&&(t.value=i.value)}else if("alert"===t){const t=s.querySelector("#wwai-alert-message");t&&(t.value=i.value)}}),50)}s.querySelector("#wwai-copy-xpath").addEventListener("click",(()=>{navigator.clipboard.writeText(n).then((()=>{const t=s.querySelector("#wwai-copy-xpath");t.textContent="Copied!",setTimeout((()=>t.textContent="Copy XPath"),2e3)}))})),s.querySelector("#wwai-apply-action").addEventListener("click",(()=>{const e=l.value;if("no-action"===e)t.setAttribute("href","javascript:void(0)"),t.onclick=t=>t.preventDefault();else if("custom-url"===e){const e=s.querySelector("#wwai-custom-url")?.value.trim();e&&(t.setAttribute("href",e),t.onclick=null)}else if("scroll-to"===e){const e=s.querySelector("#wwai-scroll-target")?.value;e&&(t.setAttribute("href","javascript:void(0)"),t.onclick=t=>{t.preventDefault();const o=document.getElementById(e);o&&o.scrollIntoView({behavior:"smooth"})})}else if("console-log"===e){const e=s.querySelector("#wwai-console-message")?.value.trim()||"Link clicked";t.setAttribute("href","javascript:void(0)"),t.onclick=t=>{t.preventDefault(),console.log(e)}}else if("alert"===e){const e=s.querySelector("#wwai-alert-message")?.value.trim()||"Link clicked";t.setAttribute("href","javascript:void(0)"),t.onclick=t=>{t.preventDefault(),alert(e)}}let o=null;"custom-url"===e?o=s.querySelector("#wwai-custom-url")?.value.trim():"scroll-to"===e?o=s.querySelector("#wwai-scroll-target")?.value:"console-log"===e?o=s.querySelector("#wwai-console-message")?.value.trim():"alert"===e&&(o=s.querySelector("#wwai-alert-message")?.value.trim()),window.__WWAI__.WWAI_ACTION_BUTTONS[n]={actionType:e,value:o||null},s.remove(),r.remove()})),s.querySelector("#wwai-close-modal").addEventListener("click",(()=>{s.remove(),r.remove()})),r.addEventListener("click",(()=>{s.remove(),r.remove()})),document.body.appendChild(r),document.body.appendChild(s)}(t),!1);e.set(t,o),t.addEventListener("click",o,!0)})),console.log("‚úÖ Button highlighting enabled - Click any link to configure actions")))}function n(){t&&(console.log("üîç Disabling button highlighting..."),t=!1,document.querySelectorAll("a").forEach((t=>{t.style.outline="",t.style.backgroundColor=""})),e.forEach(((t,e)=>{e.removeEventListener("click",t,!0)})),e.clear(),document.querySelectorAll(".wwai-action-modal, .wwai-modal-backdrop").forEach((t=>t.remove())),console.log("‚úÖ Button highlighting disabled"))}window.wwaiToggleButtonHighlighting=function(t){t?o():n()},window.wwaiIsButtonHighlightingActive=function(){return t},setInterval((()=>{t&&window.wwaiHighlighter&&window.wwaiHighlighter.isActive&&window.wwaiHighlighter.isActive()&&(console.log("üîÑ Auto-disabling button highlighting - highlighter is active"),n())}),1e3),n()})();let In=!1,En=Date.now();function Rn(){if(!window.__WWAI_HAS_DISPATCHED__){if(!In){const t=Date.now()-En;if(!(t>5e3))return console.log(`‚è≥ Waiting for product data initialization (${t}ms elapsed)...`),void setTimeout(Rn,100);console.warn(`‚ö†Ô∏è Product data initialization timeout after ${t}ms - proceeding with dispatch anyway`),In=!0}window.__WWAI_HAS_DISPATCHED__=!0,window.runDispatch(),console.log("Applying actions"),An()}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{No(),In=!0})):(No(),In=!0),window.addEventListener("DOMContentLoaded",(()=>{In||(console.log("üîÑ DOMContentLoaded fired before data initialization, ensuring data is ready..."),No(),In=!0),Wo(),"dev"===window.__WWAI__.MODE&&On()})),window.runDispatch=Lo,window.__WWAI_HAS_DISPATCHED__=window.__WWAI_HAS_DISPATCHED__||!1,"interactive"===document.readyState||"complete"===document.readyState?Rn():document.addEventListener("DOMContentLoaded",Rn),window.addEventListener("pageshow",(t=>{t.persisted&&(console.log("üîÑ BFCache restore inside script"),window.__WWAI_HAS_DISPATCHED__=!1,requestAnimationFrame(Rn))}));const Tn=setInterval((()=>{window.__WWAI_HAS_DISPATCHED__?clearInterval(Tn):"interactive"!==document.readyState&&"complete"!==document.readyState||(console.log("‚è±Ô∏è Fallback Dispatch Triggered"),clearInterval(Tn),Rn())}),200)}();
//# sourceMappingURL=bundle.js.map
