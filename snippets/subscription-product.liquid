{% if product.metafields.subscriptions.subscription_id %}
	{% comment %}Subscriptions Powered by ReCharge Payments: Meta Fields -->{% endcomment %}
		{% comment %}Subscription settings{% endcomment %}
		{% assign subscription_product = product.metafields.subscriptions %}
		{% assign subscription_id = subscription_product.subscription_id %}
		{% assign widget_settings = shop.metafields.subscriptions %}
		{% if shop.metafields.subscriptions.subscription_active == 'true' %}
			{% assign subscription_active = true %}
		{% else %}
			{% assign subscription_active = false %}
		{% endif %}
		{% if subscription_product.is_subscription_only == 'true' or product.tags contains 'Subscription Only' or product.tags contains 'subscription only' or product.tags contains 'Subscription only' or product.tags contains 'subscriptiononly' %}
			{% assign subscription_only = true %}
		{% else %}
			{% assign subscription_only = false %}
		{% endif %}
		{% if widget_settings.select_subscription_first == 'true' %}
			{% assign select_subscription_first = true %}
		{% else %}
			{% assign select_subscription_first = false %}
		{% endif %}

		{% if product.metafields.custom.override_subscription_widget_default_selection == 'One-time Purchase' %}
			{% assign select_subscription_first = false %}
		{% elsif product.metafields.custom.override_subscription_widget_default_selection == 'Subscription' %}
			{% assign select_subscription_first = true %}
		{% endif %}

		{% if subscription_only or select_subscription_first %}
			{% assign default_purchase_type = "autodeliver" %}
		{% else %}
			{% assign default_purchase_type = "onetime" %}
		{% endif %}
		{% comment %}Subscription Interval Settings{% endcomment %}
		{% if subscription_product.shipping_interval_unit_type.size > 0 %}
			{% assign shipping_interval_unit_type = subscription_product.shipping_interval_unit_type %}
		{% else %}
			{% assign shipping_interval_unit_type = 'Days' %}
		{% endif %}
		{% if subscription_product.shipping_interval_frequency.size > 0 %}
			{% assign shipping_interval_frequency = subscription_product.shipping_interval_frequency | split: ',' %}
		{% else %}
			{% assign shipping_interval_frequency = '30' %}
		{% endif %}
		{% comment %}Discount settings{% endcomment %}
		{% assign discount_percentage = subscription_product.discount_percentage | round: 2 %}
		{% assign discount_floor = subscription_product.discount_percentage | floor %}
		{% if discount_percentage == discount_floor %}
			{% assign discount_percentage = discount_floor %}
		{% endif %}
		{% comment %}Currency settings{% endcomment %}
		{% assign currency_prefix = widget_settings.currency_prefix | default: "$" %}
		{% assign currency_suffix = widget_settings.currency_suffix | default: "" %}
		{% comment %}Widget translation{% endcomment %}
		{% assign label_onetime = widget_settings.onetime_message | default: "One-time purchase" %}
		{% assign label_autodeliver = widget_settings.subscribe_message | default: "Subscribe &amp; save" %}
		{% unless discount_percentage > 0 %}{% assign label_autodeliver = "Subscribe" %}{% endunless %}
		{% assign label_deliver_every = widget_settings.widget_deliver_every | default: "Deliver every" %}
		{% comment %}Popup settings{% endcomment %}
		{% if widget_settings.show_subscription_details == 'false' %}
			{% assign show_widget = true %}
		{% else %}
			{% assign show_widget = true %}
		{% endif %}
		{% if widget_settings.show_subscription_details_icon == 'false' %}
			{% assign show_widget_icon = false %}
		{% else %}
			{% assign show_widget_icon = true %}
		{% endif %}
		{% if widget_settings.show_learnmore == 'false' %}
			{% assign show_learnmore = false %}
		{% else %}
			{% assign show_learnmore = true %}
		{% endif %}
		{% if widget_settings.show_poweredby == 'false' %}
			{% assign show_poweredby = false %}
		{% else %}
			{% assign show_poweredby = true %}
		{% endif %}
		{% comment %}Custom text{% endcomment %}
		{% assign subscription_details_label = widget_settings.subscription_details_verbiage | default: "Subscription details" %}
		{% assign how_it_works_text = widget_settings.how_it_works | default: "<strong>How subscriptions work</strong><br><br>Products are automatically delivered on your schedule. No obligation, modify or cancel your subscription anytime." %}
		{% assign learnmore_link = widget_settings.learnmore_verbiage | default: "Learn more..." %}
		{% comment %}Custom styling{% endcomment %}
		{% assign widget_label_color = widget_settings.font_color | default: "#000000" %}
		{% assign widget_active_color = widget_settings.active_color | default: "#676767" %}
		{% assign widget_active_bg = widget_settings.background_color | default: "#F8F8F8" %}
		{% assign widget_icon = subscription.widget_icon | default: "black" %}
		{% if widget_icon == "white" %}
			{% assign widget_icon = "//static.rechargecdn.com/static/images/widget/rc_widget__icon__white@2x.png" %}
		{% else %}
			{% assign widget_icon = "//static.rechargecdn.com/static/images/widget/rc_widget__icon__black@2x.png" %}
		{% endif %}
		{% assign popup_zindex = widget_settings.popup_zindex | default: "56" %}
		{% assign popup_background_color = widget_settings.popup_background_color | default: "#474747" %}
		{% assign popup_text_color = widget_settings.popup_text_color | default: "#FFFFFF" %}
		{% assign popup_link_color = widget_settings.popup_link_color | default: "#4DD6B7" %}
		{% assign recharge_custom_css = widget_settings.custom_css | defalut: "" %}
		{% comment %}Custom URLs{% endcomment %}
		{% comment %}Learn more link{% endcomment %}
		{% if widget_settings.learnmore_url %}
			{% if widget_settings.learnmore_url contains "rechargepayments.com/subscribe-with-recharge" %}
				{% capture learnmore_url %}http://rechargepayments.com/subscribe-with-recharge?utm_source=shopify%20store&utm_medium=customer%20link&utm_campaign=Shopify%20store%20back%20link&shop_name={{ shop.name | url_param_escape }}&shop={{ shop.permanent_domain }}{% endcapture %}
			{% else %}
				{% assign learnmore_url = widget_settings.learnmore_url %}
			{% endif %}
		{% else %}
			{% capture learnmore_url %}http://rechargepayments.com/subscribe-with-recharge?utm_source=shopify%20store&utm_medium=customer%20link&utm_campaign=Shopify%20store%20back%20link&shop_name={{ shop.name | url_param_escape }}&shop={{ shop.permanent_domain }}{% endcapture %}
		{% endif %}
		{% comment %}Powered by badge{% endcomment %}
		{% if widget_settings.poweredby_url %}
			{% if widget_settings.poweredby_url contains "rechargepayments.com/subscribe-with-recharge" %}
				{% capture poweredby_url %}http://rechargepayments.com/subscribe-with-recharge?utm_source=shopify%20store&utm_medium=customer%20link&utm_campaign=Shopify%20store%20back%20link&shop_name={{ shop.name | url_param_escape }}&shop={{ shop.permanent_domain }}{% endcapture %}
			{% else %}
				{% assign poweredby_url = widget_settings.poweredby_url %}
			{% endif %}
		{% else %}
			{% capture poweredby_url %}http://rechargepayments.com/subscribe-with-recharge?utm_source=shopify%20store&utm_medium=customer%20link&utm_campaign=Shopify%20store%20back%20link&shop_name={{ shop.name | url_param_escape }}&shop={{ shop.permanent_domain }}{% endcapture %}
		{% endif %}
	<!-- Subscriptions Powered by ReCharge Payments: CSS -->
	<link href="//static.rechargecdn.com/static/css/widget.css" rel="stylesheet" type="text/css">
	<style>
		/* Widget: Purchase options */
		label.rc_label {
			color: {{ widget_label_color }};
		}
		div.rc_block__type--active {
			background-color: {{ widget_active_bg }};
		}
		div.rc_block__type--active label.rc_label {
			color: {{ widget_active_color }};
		}
		/* Widget: Popup */
		div.rc_popup__block {
			z-index: {{ popup_zindex }};
		}
		div.rc_popup__block:before {
			border-bottom-color: {{ popup_background_color }};
		}
		div.rc_popup__block {
			background-color: {{ popup_background_color }} !important;
		}
		div.rc_popup__close,
		div.rc_popup__block__content,
		div.rc_popup__block__content strong {
			color: {{ popup_text_color }} !important;
		}
		div.rc_popup__block__content a {
			color: {{ popup_link_color }} !important;
		}
		/* ReCharge CSS */
		{{ recharge_custom_css }}
		/* Add Custom CSS Below */

	</style>

	{% liquid
		assign price = product.selected_or_first_available_variant.price | default: 1999
		assign compare_at_price = product.selected_or_first_available_variant.compare_at_price
		assign money_price = price | money
		assign money_compare_at_price = compare_at_price | money

		assign onsalePrice = false
		if compare_at_price > 0
		 assign onsalePrice = true
		endif
		  

		if settings.currency_code_enabled
		assign money_price = price | money_with_currency
		assign money_compare_at_price = compare_at_price | money_with_currency
		endif  

		assign subs_variant_id = product.selected_or_first_available_variant.metafields.subscriptions.discount_variant_id
		assign subs_intervals = product.metafields.subscriptions.shipping_interval_frequency | split: ','
		for interval in subs_intervals
		assign num_interval = interval | plus: 0
		endfor
	%}

	<!-- Subscriptions Powered by ReCharge Payments: HTML -->
	<div id="rc_container"{% unless subscription_active %} style="display: none;"{% endunless %} class="product-rc_container {% if subscription_only %} rc_subscription-only{% endif %}">
		<input type="hidden" name="{% if subscription_active and subscription_only or select_subscription_first %}properties[subscription_id]{% endif %}" id="rc_subscription_id" value="{{ subscription_id }}">
		<input type="hidden" name="{% if subscription_active and subscription_only or select_subscription_first %}properties[shipping_interval_unit_type]{% endif %}" id="rc_shipping_interval_unit_type" value="{{ shipping_interval_unit_type }}">
		<select id="rc_duplicate_selector" data-productid="{{ product.id }}" class="styled replaced no-js" style="display: none;">
			{% for variant in product.variants %}
				<option value="{{ variant.metafields.subscriptions.discount_variant_id }}">{{ variant.metafields.subscriptions.discount_variant_id }}</option>
			{% endfor %}
		</select>
		{% unless subscription_only %}
			<div class="rc_block rc_block__type rc_block__type__onetime{% unless select_subscription_first %} rc_block__type--active{% endunless %}">	
              <input type="radio" id="rc_purchase_type_onetime" name="purchase_type" data-productid="{{ product.id }}" value="onetime"{% unless select_subscription_first %} checked{% endunless %} class="rc_radio rc_radio__onetime">
            	
              <label for="rc_purchase_type_onetime" class="rc_label rc_label__onetime">
                {{ label_onetime | replace: "t", "T" | replace: "p", "P" }}{%- if discount_percentage > 0 -%}:{%- endif -%}
					
					{% if product.id == 635389411371 %}
					    <span>:</span> 
						{% comment %}<span class="custom-subscription-pricing custom-regular-pricing">{{ product.selected_or_first_available_variant.price | money_without_trailing_zeros }}</span>{% endcomment %}          
                  	{% elsif product.id == 4845597163563 %}
					    <span>:</span> 
                  		<span class="custom-subscription-pricing custom-subscription-compare-price"> <span style="text-decoration: line-through; color: #ca1212;">$115</span> $75</span>
					{% elsif product.id == 653395984427 or product.id == 4850896076843 %}
                  	{% comment %} <span>: $63</span> {% endcomment %}
					    <span>:</span>
					  	{% comment %}<span class="custom-subscription-pricing custom-regular-pricing">{{ product.price | money }}</span>{% endcomment %}
                    {% elsif product.id == 4845597949995 %}
						<span>:</span>
						<span class="custom-subscription-pricing custom-subscription-compare-price"> <span style="text-decoration: line-through; color: #ca1212;">$65</span> $45</span>
                  
                  {% elsif product.id == 6542787051563 %}
                  		<span class="custom-subscription-pricing custom-subscription-compare-price" style="text-decoration: line-through; color: #ca1212;">$24.00</span>
                  {% elsif product.id == 6615329243179 %}
                  		<span class="custom-subscription-pricing custom-subscription-compare-price" style="text-decoration: line-through; color: #ca1212;">$36.00</span>
				  {% elsif money_compare_at_price %}
				      <span class="custom-subscription-pricing custom-subscription-compare-price custom-sale-price" style="text-decoration: line-through; color: #ca1212;">{{ money_compare_at_price }}</span>
				  {% comment %}
                  {% elsif product.id == 4456271839275 %}
                        <span >$28.00</span> 
                  {% endcomment %}
                 
                                  
					{% endif %}
					{% comment %}
					{% if discount_percentage > 0 %}
						<span id="rc_price_onetime" class="rc_price rc_price__onetime">{{ product.price | money }}</span>
					{% endif %}
					
                    {% if product.id == 4456305819691 %}
                    <span id="rc_price_onetime" class="rc_price rc_price__onetime">{{ product.price | money }}</span>
                    {% endif %}
                    {% if product.id == 4859363786795 %}
                    <span id="rc_price_onetime" class="rc_price rc_price__onetime">{{ product.price | money }}</span>
                    {% endif %}
                    {% if product.id == 6542787051563 or product.id == 4464889298987 or product.id == 4859363786795 or product.id == 4522402873387  %}
                    <span id="rc_price_onetime" class="rc_price rc_price__onetime">{{ product.price | money }}</span>
                    {% endif %}
					{% endcomment %}
					{% if product.id == 6542787051563 or product.id == 4464889298987 or product.id == 4859363786795 or product.id == 4522402873387 or product.id == 4859363786795 or product.id == 4456305819691 %}
                      <span id="rc_price_onetime" class="rc_price rc_price__onetime">{{ product.price | money }}</span>
					{% elsif discount_percentage > 0 %}
					  <span id="rc_price_onetime" class="rc_price rc_price__onetime">{{ product.price | money }}</span>
					{% else %}
					  <span id="rc_price_onetime" class="rc_price rc_price__onetime">{{ product.price | money }}</span>
                    {% endif %}
				</label>
			</div>
		{% endunless %} 
      

		<div class="rc_block rc_block__type rc_block__type__autodeliver{% if select_subscription_first %} rc_block__type--active{% endif %}"{% if subscription_only and shipping_interval_frequency.size == 1 %} style="display: none;"{% endif %}>
			<input type="radio" id="rc_purchase_type_autodeliver" name="purchase_type" data-productid="{{ product.id }}" value="autodeliver"{% if subscription_only or select_subscription_first %} checked{% endif %}{% if subscription_only %} style="display: none;"{% endif %} class="{% if product.id == 1563879505963 %} hh {% endif %}rc_radio rc_radio__autodeliver">
		{% if product.id == 1563879505963 %}
          {% unless subscription_only %}
				<label for="rc_purchase_type_autodeliver" class="rc_label rc_label__autodeliver">
					
                  <span class="custom-subscription-pricing">$70 Today & $18/Quarter (first shipment free)</span>
				  <div class="rc_popup">
					{% if show_widget %}
						<div class="rc_popup__hover">
							{% if show_widget_icon %}
							  {% comment %}
								<img alt="Widget Popup icon" src="{{ widget_icon }}" height="21" width="18" class="rc_popup__icon"> 
							  {% endcomment %}
							  <img src="{{ 'information-icon.svg' | asset_url }}" height="21" width="18" loading="lazy" decoding="async" alt="ReCharge Subscription services icon" class="rc_popup__icon">
							{% endif %}
							<div class="rc_popup__block">
								<div class="rc_popup__block__content">
									<div class="rc_popup__close" style="display: none;">x</div>
									{{ how_it_works_text }}
									{% if show_learnmore %}
										<br><a title="{{ learnmore_link }}" href="{{ learnmore_url }}" target="_blank">{{ learnmore_link }}</a>
									{% endif %}
								</div>
								{% if show_poweredby %}
									<div class="rc_popup__block__footer">
										<a title="Rc Popup Badge" href="{{ poweredby_url }}" target="_blank">
											<img alt="rc_popup__badge" src="//static.rechargecdn.com/static/images/widget/rc_widget__banner@2x.png" height="28" width="153" class="rc_popup__badge">
										</a>
									</div>
								{% endif %}
							</div>
						</div>
					  {% elsif show_widget == "link" %}
						<a title="{{ subscription_details_label }}" href="{{ learnmore_url }}" target="_blank" class="rc_popup__hover">{% if show_widget_icon %}<img alt="{{ subscription_details_label }}" src="{{ widget_icon }}" height="21" width="18" class="rc_popup__icon"> {% endif %}{{ subscription_details_label }}</a>
					  {% endif %}
					</div>
                  </label>
				  
			{% endunless %}
          {% else %} 	{% unless subscription_only %}
				<label for="rc_purchase_type_autodeliver" class="rc_label rc_label__autodeliver">
					{{ label_autodeliver | remove: ':' }}{% unless discount_percentage > 0 %}:{% endunless %}
					{% if discount_percentage > 0 %}
                        {% if product.id != 635389411371 or product.id != 653395984427 %}
						<span class="rc_label__discount">({{ discount_percentage }}% off):</span>
							<span id="rc_price_autodeliver" class="rc_price rc_price__autodeliver">{{ product.selected_or_first_available_variant.metafields.subscriptions.discount_variant_price | times: 100 | money }}</span>
				        {% endif %}	
					{% else %}
						{% if product.id != 635389411371 %}
						  {% unless product.id == 653395984427 %}
						<span id="rc_price_autodeliver" class="rc_price rc_price__autodeliver aab">{{ product.selected_or_first_available_variant.metafields.subscriptions.discount_variant_price | times: 100 | money }}</span>
						  {% endunless %}
						{% endif %}	
                  	{% endif %}
					<div class="rc_popup">
						{% if show_widget %}
							<div class="rc_popup__hover">
								{% if show_widget_icon %}
								  {% comment %}
									<img alt="Widget Popup icon" src="{{ widget_icon }}" height="21" width="18" class="rc_popup__icon"> 
								  {% endcomment %}
								  <img src="{{ 'information-icon.svg' | asset_url }}" height="21" width="18" loading="lazy" decoding="async" alt="ReCharge Subscription services icon" class="rc_popup__icon">
								{% endif %}
								<div class="rc_popup__block">
									<div class="rc_popup__block__content">
										<div class="rc_popup__close" style="display: none;">x</div>
										{{ how_it_works_text }}
										{% if show_learnmore %}
											<br><a title="{{ learnmore_link }}" href="{{ learnmore_url }}" target="_blank">{{ learnmore_link }}</a>
										{% endif %}
									</div>
									{% if show_poweredby %}
										<div class="rc_popup__block__footer">
											<a title="Rc Popup Badge" href="{{ poweredby_url }}" target="_blank">
												<img alt="rc_popup__badge" src="//static.rechargecdn.com/static/images/widget/rc_widget__banner@2x.png" height="28" width="153" class="rc_popup__badge">
											</a>
										</div>
									{% endif %}
								</div>
							</div>
						{% elsif show_widget == "link" %}
							<a title="{{ subscription_details_label }}" href="{{ learnmore_url }}" target="_blank" class="rc_popup__hover">{% if show_widget_icon %}<img alt="{{ subscription_details_label }}" src="{{ widget_icon }}" height="21" width="18" class="rc_popup__icon"> {% endif %}{{ subscription_details_label }}</a>
						{% endif %}
					  </div>
					{% if product.id == 635389411371 or product.id == 4845597163563 %}
						<span class="custom-subscription-pricing"><span class="custom-subscription-price custom-regular-pricing">{{ product.selected_or_first_available_variant.price | money_without_trailing_zeros }}</span> Today, $22.40 Refills</span>
						<span class="custom-subscription-pricing-details" style="font-family: CeraProLight; font-size: 13px; display: block;">(details below)</span>
                  	{% elsif product.id == 4845597163563 %}
					{% elsif product.id == 653395984427 or product.id == 4850896076843  %}
						{% comment %} <span>$63 Today, $11.20 Refills</span> {% endcomment %}
						<span class="custom-subscription-pricing">$65 Today, $8 Refills</span>
						<span class="custom-subscription-pricing-details" style="font-family: CeraProLight; font-size: 13px; display: block;">(details below)</span>
                  {%- comment -%} {% elsif product.id == 4859363786795  %}
						<span class="custom-subscription-pricing">$9.60</span> {%- endcomment -%}
						
                  	{% elsif product.id == 4845597949995 %}
						<span class="custom-subscription-pricing">$45 Today, $9.60 Refills</span>
						<span class="custom-subscription-pricing-pricing" style="font-family: CeraProLight; font-size: 13px; display: block;">(details below)</span>
					{% endif %}
                  
                  {% if product.id == 4456305819691 %}
                  <span id="rc_price_autodeliver" class="rc_price rc_price__autodeliver">{{ product.selected_or_first_available_variant.metafields.subscriptions.discount_variant_price | times: 100 | money }}</span>
                  {% endif %}
                  
                  {% comment %}
                  {% if product.id == 4456271839275 %}
                  <span id="rc_price_autodeliver1" class="rc_price rc_price__autodeliver">(15%): $23.80</span>
                  {% endif %}
                  {% endcomment %}
                  
                  {% comment %}{% if product.id == 6542787051563 %}
                  <span id="rc_price_autodeliver" class="rc_price rc_price__autodeliver">{{ product.selected_or_first_available_variant.metafields.subscriptions.discount_variant_price | times: 100 | money }}</span>
                  {% endif %}{% endcomment %}
				</label>

				{% if product.metafields.heyday.subscription_additional_text %}
				<div class="rc_additional_text">{{ product.metafields.heyday.subscription_additional_text }}</div>
				{% endif %}
			{% endunless %}
			<div id="rc_autodeliver_options" class="rc_block rc_block__type__options">
				{% if shipping_interval_frequency.size == 1 %}
					<label for="rc_shipping_interval_frequency" class="rc_label rc_label__deliver_every">
						<span class="rc_label__delivery">{{ label_deliver_every }}</span>
						<span class="rc_label__frequency">
							{{ shipping_interval_frequency[0] }}
							{% if shipping_interval_frequency[0] == "1" %}
                      
								{% if shipping_interval_unit_type == 'Months' %}Month{% elsif shipping_interval_unit_type == 'Weeks' %}Week{% else %}Day{% endif %}
							{% else %}
								{{ shipping_interval_unit_type }}
							{% endif %}
						</span>
					  <input type="hidden" id="custom_delivery_frequency" name="properties[Delivery Frequency]" value="{{ shipping_interval_frequency }} {{ shipping_interval_unit_type }}" />
					</label>
					<input type="hidden" name="{% if subscription_active and subscription_only %}properties[shipping_interval_frequency]{% endif %}" id="rc_shipping_interval_frequency" data-productid="{{ product.id }}" value="{{ shipping_interval_frequency }}">
				{% elsif shipping_interval_frequency.size > 1 %}
					<label for="rc_shipping_interval_frequency" class="rc_label rc_label__deliver_every testt">
						<span class="rc_label__delivery">{{ label_deliver_every }}</span>
						<select name="{% if subscription_active and subscription_only %}properties[shipping_interval_frequency]{% endif %}" id="rc_shipping_interval_frequency" data-productid="{{ product.id }}" class="rc_select rc_select__frequency" data-recharge-interval>
							{% for frequency in shipping_interval_frequency %}
								<option value="{{ frequency }}" {% if frequency == '3' %}selected{% endif %}>
									{{ frequency }}
									{% if frequency == "1" %}
                                    {% if shipping_interval_unit_type == 'Months' %}Month{% elsif shipping_interval_unit_type == 'month' %}Month{% elsif shipping_interval_unit_type == 'Weeks' %}Week{% else %}Day{% endif %}
                                    {% else if frequency == "2" or frequency == "3" %}
										{% if shipping_interval_unit_type == 'Months' %}Months{% elsif shipping_interval_unit_type == 'month' %}Months{% elsif shipping_interval_unit_type == 'Weeks' %}Week{% else %}Day{% endif %}
									{% else %}
										{{ shipping_interval_unit_type }}
									{% endif %}
								</option>
							{% endfor %}
						</select>
						<input type="hidden" id="custom_delivery_frequency" name="properties[Delivery Frequency]" value="{{ shipping_interval_frequency }} {{ shipping_interval_unit_type }}" />
					</label>
				{% endif %}
			</div>
		</div>
		{% endif %}
	</div>
	<!-- Subscriptions Powered by ReCharge Payments: JS -->
	<script src="//static.rechargecdn.com/static/js/widget.js"></script>
	<script>
		(function() {
			var myProduct = {
				id: {{ product.id }},
				active: {{ subscription_active }},
				subscription_id: {{ subscription_id }},
				shop_currency: "{{ shop.currency }}",
				currency_prefix: "{{ currency_prefix }}",
				currency_suffix: "{{ currency_suffix }}",
				subscription_only: {{ subscription_only }},
				select_subscription_first: {{ select_subscription_first }},
				shipping_interval_unit_type: "{{ shipping_interval_unit_type }}",
				shipping_interval_frequency: [{% for interval in shipping_interval_frequency %}{{ interval }}, {% endfor %}],
				discount_percentage: {{ discount_percentage }},
				variant_to_duplicate: { {% for variant in product.variants %}{{ variant.id }}:'{{ variant.metafields.subscriptions.discount_variant_id }}', {% endfor %} },
				variant_to_price: { {% for variant in product.variants %}{{ variant.id }}:'{{ variant.price }}', {% endfor %} },
				duplicate_to_price: { {% for variant in product.variants %}{{ variant.metafields.subscriptions.discount_variant_id }}: '{{ variant.metafields.subscriptions.discount_variant_price | replace: ".", "" }}', {% endfor %} },
			};
			document.addEventListener("DOMContentLoaded", function() {
				if (!window.ReCharge) { window.ReCharge = new rcWidget; }
				ReCharge.addProduct(myProduct);
			});
		})();

		const price_varies = {{ product.price_varies }};
		const compare_price_varies = {{ onsalePrice }};
		var variant_prices = new Array();
		var variant_compare_prices = new Array();
		var variant_subscription_prices = new Array();
		{% for variant in product.variants %}
			variant_prices[{{ variant.id }}] = '{{ variant.price | money }}';
			variant_compare_prices[{{ variant.id }}] = '{{ variant.compare_at_price | money_without_trailing_zeros }}'; 
			variant_subscription_prices[{{ variant.id }}] = '{{ variant.metafields.subscriptions.discount_variant_price | replace: ".", "" | money }}';
		{% endfor %}

		{% if product.metafields.subscriptions.has_subscription == 'True' %}
		const variant_subs_disabled = new Array();
		{%- for variant in product.variants %}
		variant_subs_disabled[{{ variant.id }}] = {% if variant.metafields.heyday.disable_subscription %}true{% else %}false{% endif %};
		{%- endfor %}
		{% endif %}
	</script>
	
	<script>
		document.addEventListener('click', function() {
		  document.querySelectorAll('.product-rc_container').forEach(function(widget) {
			var selectedOption = widget.querySelector('.rc_block__type--active input[type="radio"]');
			var frequencySelect = widget.querySelector('#rc_autodeliver_options .rc_select__frequency');
			var deliveryFrequency = widget.querySelector('#custom_delivery_frequency');
			if (selectedOption != null && frequencySelect != null && deliveryFrequency != null) {
				if( selectedOption.value == 'autodeliver' ) {
					deliveryFrequency.value = `${ frequencySelect.options[frequencySelect.selectedIndex].text }`;

					frequencySelect.addEventListener('change', function() {
						var deliveryFrequency = widget.querySelector('#custom_delivery_frequency');
						var frequencySelect = widget.querySelector('#rc_autodeliver_options .rc_select__frequency');
						
						deliveryFrequency.value = `${ frequencySelect.options[frequencySelect.selectedIndex].text }`;
					});
				} else {
					deliveryFrequency.value = '';
				}
			}
		  });
		});

	document.querySelectorAll('.product-rc_container').forEach(function(widget) {
      if(widget.closest('.quick-add-modal__content') != null) {
		/*document.querySelectorAll('.quick-add-modal__content .rc_select__frequency').forEach(function(quickFrequency) {
			document.querySelector('.quick-add-modal__content #rc_subscription_id').value = this.value;
			quickFrequency.addEventListener('change', function() {
				document.querySelector('.quick-add-modal__content #rc_subscription_id').value = this.value;
			});
		});*/

		var quickPurchaseType = Array.from(widget.querySelectorAll('.rc_block__type'));
		var currentvariant = "{{ product.selected_or_first_available_variant.id }}";
		var input = widget.querySelector('.rc_block__type__autodeliver').closest('product-form').querySelector('input[data-name="id"]');
		var customRechargevariant = widget.querySelector('#rc_duplicate_selector'); 
		const product_variants = [{% for variant in product.variants %}"{{ variant.id }}", {% endfor %}];
		var subscriptionId = {{ subscription_id }};
		var subscriptionFrequencyLabel = '{{ shipping_interval_unit_type }}';

		var handleClick = (e) => {
		e.preventDefault();
		quickPurchaseType.forEach(node => {
			node.classList.remove('rc_block__type--active');
			node.querySelectorAll('input[type="radio"]').forEach(o => {o.removeAttribute('checked')});
		});
		e.currentTarget.classList.add('rc_block__type--active');
		e.currentTarget.querySelector('input[type="radio"]').setAttribute('checked', true);

			if (e.currentTarget.classList.contains('rc_block__type__autodeliver')) {
				widget.querySelector('#rc_subscription_id').setAttribute('name', 'properties[subscription_id]');
				widget.querySelector('#rc_shipping_interval_frequency').setAttribute('name', 'properties[shipping_interval_frequency]');
				widget.querySelector('#rc_shipping_interval_unit_type').setAttribute('name', 'properties[shipping_interval_unit_type]');
			  //document.querySelectorAll('.quick-add-modal__content .rc_select__frequency').forEach(e => {document.querySelector('.quick-add-modal__content #rc_subscription_id').value = subscriptionId;});
			  widget.querySelectorAll('.rc_label__frequency').forEach(e => {widget.querySelector('#rc_shipping_interval_unit_type').value = e.textContent;});
			  
			  /*for (let i = 0; i < product_variants.length; i++) {
				if (currentvariant === product_variants[i]) {
					input.value = customRechargevariant.options[i].value;
				}
			  }*/
			  if (customRechargevariant) {
				customRechargevariant.setAttribute('name', 'id');
				input.removeAttribute('name');
			  }

			} else {
				//input.value = currentvariant;
				console.log('lol');
				widget.querySelector('#rc_subscription_id').setAttribute('name', '');
				widget.querySelector('#rc_shipping_interval_unit_type').setAttribute('name', ''); 
				if (customRechargevariant.hasAttribute('name')) {
					customRechargevariant.removeAttribute('name');
				}
				widget.closest('.quick-add-modal__content').querySelector('[data-name="id"]').setAttribute('name', 'id');
				widget.querySelector('#rc_shipping_interval_frequency').setAttribute('name', '');
			   for (let i = 0; i < customRechargevariant.length; i++) {
				if (customRechargevariant.value === customRechargevariant.options[i].value) {
					input.value = product_variants[i];
				}
			  }
			}
		}

		quickPurchaseType.forEach(node => {
		node.addEventListener('click', handleClick)
		});

		if (widget.querySelector('.rc_block__type__autodeliver').classList.contains('rc_block__type--active')) {
			widget.querySelector('#rc_shipping_interval_frequency').setAttribute('name', 'properties[shipping_interval_frequency]');
			for (let i = 0; i < product_variants.length; i++) {
				if (currentvariant === product_variants[i]) {
					input.value = customRechargevariant.options[i].textContent;
				}
			}
			
		}
	  }
	});

	setTimeout(function() {
		if (document.querySelector('[data-recharge-interval]') != null) {
			for (var x = 0 ; x < document.querySelector('[data-recharge-interval]').length ; x++ ) {
				if (document.querySelector('[data-recharge-interval]')[x].value == '{% if product.metafields.heyday.override_default_subscription_interval != blank %}{{ product.metafields.heyday.override_default_subscription_interval }}{% else %}3{% endif %}') {
					document.querySelector('[data-recharge-interval]')[x].selected = true;
				}
			}
		}
	}, 200);

	{% if product.selected_or_first_available_variant.metafields.heyday.disable_subscription %}
	setTimeout(function () {
		if (document.querySelector('label.rc_label__onetime') != null) document.querySelector('label.rc_label__onetime').click();
		if (document.querySelector('.rc_block__type__autodeliver') != null) document.querySelector('.rc_block__type__autodeliver').classList.add('hidden');
	}, 1000);
	{% endif %}
	</script>
{% endif %}
<!-- Subscriptions Powered by ReCharge Payments: End Liquid Code -->
